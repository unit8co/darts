
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Quickstart &#8212; darts  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/docs-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Guide" href="../userguide.html" />
    <link rel="prev" title="Time Series Made Easy in Python" href="../README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/darts-logo-trim.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../README.html">
  Home
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Quickstart
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../userguide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../generated_api/darts.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../release_notes/RELEASE_NOTES.html">
  Release Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/unit8co/darts" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/unit8co" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Quickstart
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Installing-Darts">
   Installing Darts
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Building-and-manipulating-TimeSeries">
   Building and manipulating
   <code class="docutils literal notranslate">
    <span class="pre">
     TimeSeries
    </span>
   </code>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Read-data-and-build-a-TimeSeries">
     Read data and build a
     <code class="docutils literal notranslate">
      <span class="pre">
       TimeSeries
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Load-one-of-our-existing-datasets">
     Load one of our existing datasets
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Export-a-TimeSeries">
     Export a
     <code class="docutils literal notranslate">
      <span class="pre">
       TimeSeries
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Some-TimeSeries-Operations">
     Some
     <code class="docutils literal notranslate">
      <span class="pre">
       TimeSeries
      </span>
     </code>
     Operations
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Creating-a-training-and-validation-series">
     Creating a training and validation series
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Training-forecasting-models-and-making-predictions">
   Training forecasting models and making predictions
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Playing-with-toy-models">
     Playing with toy models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Inspect-Seasonality">
       Inspect Seasonality
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#A-less-naive-model">
       A less naive model
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Computing-error-metrics">
     Computing error metrics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Quickly-try-out-several-models">
     Quickly try out several models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Searching-for-hyper-parameters-with-the-Theta-method">
       Searching for hyper-parameters with the Theta method
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Backtesting:-simulate-historical-forecasting">
   Backtesting: simulate historical forecasting
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Machine-learning-and-global-models">
   Machine learning and global models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#A-toy-example-with-two-series">
     A toy example with two series
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Using-deep-learning:-example-with-N-BEATS">
     Using deep learning: example with N-BEATS
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Covariates:-using-external-data">
   Covariates: using external data
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Encoders:-using-covariates-for-free">
     Encoders: using covariates for free
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Regression-forecasting-models">
   Regression forecasting models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Sample-Weights">
   Sample Weights
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Forecast-Start-Shifting">
   Forecast Start Shifting
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Probabilistic-forecasts">
   Probabilistic forecasts
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#With-Local-Models">
     With Local Models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#With-Neural-Network-Models-(TorchForecastingModel)">
     With Neural Network Models (TorchForecastingModel)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Probabilistic-Sample-Predictions">
       Probabilistic Sample Predictions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Direct-Parameter-Predicitons">
       Direct Parameter Predicitons
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Types-of-distributions">
       Types of distributions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Evaluating-Probabilistic-Forecasts">
       Evaluating Probabilistic Forecasts
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Using-Quantile-Loss">
       Using Quantile Loss
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#With-Regression-Models">
     With Regression Models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Ensembling-models">
   Ensembling models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Naive-Ensembling">
     Naive Ensembling
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Learned-Ensembling">
     Learned Ensembling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Filtering-models">
   Filtering models
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Fitting-a-Kalman-Filter">
     Fitting a Kalman Filter
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Inferring-missing-values-with-Gaussian-Processes">
     Inferring missing values with Gaussian Processes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#A-Word-of-Caution">
   A Word of Caution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Anomaly-Detection">
   Anomaly Detection
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Quickstart">
<h1>Quickstart<a class="headerlink" href="#Quickstart" title="Permalink to this heading">¶</a></h1>
<p>In this notebook, we go over the main functionalities of the library:</p>
<ul class="simple">
<li><p><a class="reference external" href="#Installing-Darts">Installing Darts</a></p></li>
<li><p><a class="reference external" href="#Building-and-manipulating-TimeSeries">Building and manipulating TimeSeries</a></p></li>
<li><p><a class="reference external" href="#Training-forecasting-models-and-making-predictions">Training forecasting models and making predictions</a></p></li>
<li><p><a class="reference external" href="#Backtesting:-simulate-historical-forecasting">Backtesting</a></p></li>
<li><p><a class="reference external" href="#Machine-learning-and-global-models">Machine learning and global models</a></p></li>
<li><p><a class="reference external" href="#Covariates:-using-external-data">Covariates: using external data</a></p></li>
<li><p><a class="reference external" href="#Regression-forecasting-models">Regression forecasting models</a></p></li>
<li><p><a class="reference external" href="#Sample-Weights">Sample weights for training</a></p></li>
<li><p><a class="reference external" href="#Forecast-Start-Shifting">Forecast Start Shifting</a></p></li>
<li><p><a class="reference external" href="#Probabilistic-forecasts">Probabilistic forecasts</a></p></li>
<li><p><a class="reference external" href="#Ensembling-models">Ensembling models</a></p></li>
<li><p><a class="reference external" href="#Filtering-models">Filtering models</a></p></li>
<li><p><a class="reference external" href="#Anomaly-Detection">Anomaly Detection</a></p></li>
</ul>
<p>We will only show some minimal “get started” examples here. For more in depth information, you can refer to our <a class="reference external" href="https://unit8co.github.io/darts/userguide.html">user guide</a> and <a class="reference external" href="https://unit8co.github.io/darts/examples.html">example notebooks</a>.</p>
</section>
<section id="Installing-Darts">
<h1>Installing Darts<a class="headerlink" href="#Installing-Darts" title="Permalink to this heading">¶</a></h1>
<p>We recommend using some virtual environment. Then there are mainly two ways.</p>
<p>With pip:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install darts
</pre></div>
</div>
<p>With conda</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda install -c conda-forge -c pytorch u8darts-all
</pre></div>
</div>
<p>Consult the <a class="reference external" href="https://github.com/unit8co/darts/blob/master/INSTALL.md">detailed install guide</a> if you run into issues or want to install a different flavour (avoiding certain dependencies).</p>
<p>First, let’s import a few things:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># fix python path if working locally</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">fix_pythonpath_if_working_locally</span>

<span class="n">fix_pythonpath_if_working_locally</span><span class="p">()</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</section>
<section id="Building-and-manipulating-TimeSeries">
<h1>Building and manipulating <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code><a class="headerlink" href="#Building-and-manipulating-TimeSeries" title="Permalink to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> is the main data class in Darts. A <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> represents a univariate or multivariate time series, with a proper time index. The time index can either be of type <code class="docutils literal notranslate"><span class="pre">pandas.DatetimeIndex</span></code> (containing datetimes), or of type <code class="docutils literal notranslate"><span class="pre">pandas.RangeIndex</span></code> (containing integers useful for representing sequential data without specific timestamps). In some cases, <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> can even represent <em>probabilistic</em> series, in order for instance to obtain confidence intervals. All models in Darts
consume <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> and produce <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>.</p>
<section id="Read-data-and-build-a-TimeSeries">
<h2>Read data and build a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code><a class="headerlink" href="#Read-data-and-build-a-TimeSeries" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> can be built easily using a few factory methods:</p>
<ul class="simple">
<li><p>From a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_dataframe()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_dataframe">docs</a>). We support multiple frame backends such as <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, <code class="docutils literal notranslate"><span class="pre">polars.DataFrame</span></code>, <code class="docutils literal notranslate"><span class="pre">pyarrow.table</span></code> and more (see <strong>(a)</strong>).</p></li>
<li><p>From a time index and an array of corresponding values, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_times_and_values()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_times_and_values">docs</a>).</p></li>
<li><p>From a NumPy array of values, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_values()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_values">docs</a>).</p></li>
<li><p>From a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_series()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_series">docs</a>). Also here we support multiple series backends such as <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code>, <code class="docutils literal notranslate"><span class="pre">polars.Series</span></code>, and more (see <strong>(a)</strong>).</p></li>
<li><p>Extract multiple <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> by groups from a Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_group_dataframe()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_group_dataframe">docs</a>).</p></li>
<li><p>From an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_xarray()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_xarray">docs</a>).</p></li>
<li><p>From a CSV file, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_csv()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_csv">docs</a>).</p></li>
<li><p>From a JSON file, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.from_json()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.from_json">docs</a>).</p></li>
<li><p>Or use one of our built-in <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> generation functions (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.timeseries_generation.html">docs</a>).</p></li>
</ul>
<p><strong>(a)</strong> <em>We leverage narwhals as the compatibility layer between DataFrame and Series libraries. See the</em> <a class="reference external" href="https://narwhals-dev.github.io/narwhals/">narwhals documentation</a> <em>for all supported backends.</em></p>
<p>Let’s create a multivariate (two-column) <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> from a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. The frame contains a sine and cosine series, and has a time index of daily frequency.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_index</span>

<span class="c1"># generate a sine and cosine wave</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">sine_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">cosine_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># generate a DatetimeIndex with daily frequency</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">generate_index</span><span class="p">(</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>

<span class="c1"># create a DataFrame; here we use pandas but you can use any other backend (e.g. polars, pyarrow, ...).</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;sine&quot;</span><span class="p">:</span> <span class="n">sine_vals</span><span class="p">,</span> <span class="s2">&quot;cosine&quot;</span><span class="p">:</span> <span class="n">cosine_vals</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">dates</span><span class="p">})</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">time_col</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_6_0.png" src="../_images/quickstart_00-quickstart_6_0.png" />
</div>
</div>
</section>
<section id="Load-one-of-our-existing-datasets">
<h2>Load one of our existing datasets<a class="headerlink" href="#Load-one-of-our-existing-datasets" title="Permalink to this heading">¶</a></h2>
<p>Alternatively, you can load one of our existing datasets (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.datasets.html">docs</a>).</p>
<p>Below, we get a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> by directly loading the air passengers series dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_8_0.png" src="../_images/quickstart_00-quickstart_8_0.png" />
</div>
</div>
</section>
<section id="Export-a-TimeSeries">
<h2>Export a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code><a class="headerlink" href="#Export-a-TimeSeries" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> can be exported in many different ways:</p>
<ul class="simple">
<li><p>To a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.to_dataframe()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.to_dataframe">docs</a>). We support multiple frame backends such as <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">polars</span></code>, <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> and more (see <strong>(a)</strong> from above).</p></li>
<li><p>To a NumPy array of values, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.values()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.values">docs</a>) or <code class="docutils literal notranslate"><span class="pre">TimeSeries.all_values()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.all_values">docs</a>).</p></li>
<li><p>To a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.to_series()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.to_series">docs</a>). Also here we support multiple series backends (see <strong>(a)</strong> from above).</p></li>
<li><p>To a <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.data_array()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.data_array">docs</a>).</p></li>
<li><p>To a CSV file, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.to_csv()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.to_csv">docs</a>).</p></li>
<li><p>To a JSON file, using <code class="docutils literal notranslate"><span class="pre">TimeSeries.to_json()</span></code> (<a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.timeseries.html#darts.timeseries.TimeSeries.to_json">docs</a>).</p></li>
<li><p>And more!</p></li>
</ul>
<p>Here an example of how to export to a <code class="docutils literal notranslate"><span class="pre">polars.DataFrame</span></code>. Polars is an optional dependency, so make sure to install it first (see the installation guide <a class="reference external" href="https://docs.pola.rs/user-guide/installation/">here</a>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;polars&quot;</span><span class="p">,</span> <span class="n">time_as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (5, 2)</small><table border="1" class="dataframe"><thead><tr><th>Month</th><th>#Passengers</th></tr><tr><td>datetime[ns]</td><td>f64</td></tr></thead><tbody><tr><td>1960-08-01 00:00:00</td><td>606.0</td></tr><tr><td>1960-09-01 00:00:00</td><td>508.0</td></tr><tr><td>1960-10-01 00:00:00</td><td>461.0</td></tr><tr><td>1960-11-01 00:00:00</td><td>390.0</td></tr><tr><td>1960-12-01 00:00:00</td><td>432.0</td></tr></tbody></table></div></div>
</div>
</section>
<section id="Some-TimeSeries-Operations">
<h2>Some <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> Operations<a class="headerlink" href="#Some-TimeSeries-Operations" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> support different kinds of operations - here are a few examples.</p>
<p><strong>Splitting</strong></p>
<p>We can also split at a fraction of the series, at a pandas <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> or at an integer index value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">split_after</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">series1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">series2</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_12_0.png" src="../_images/quickstart_00-quickstart_12_0.png" />
</div>
</div>
<p><strong>Slicing:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span> <span class="o">=</span> <span class="n">series</span><span class="p">[:</span><span class="o">-</span><span class="mi">36</span><span class="p">],</span> <span class="n">series</span><span class="p">[</span><span class="o">-</span><span class="mi">36</span><span class="p">:]</span>
<span class="n">series1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">series2</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_14_0.png" src="../_images/quickstart_00-quickstart_14_0.png" />
</div>
</div>
<p><strong>Arithmetic operations:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series_noise</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_times_and_values</span><span class="p">(</span>
    <span class="n">series</span><span class="o">.</span><span class="n">time_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">))</span>
<span class="p">)</span>
<span class="p">(</span><span class="n">series</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">series_noise</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_16_0.png" src="../_images/quickstart_00-quickstart_16_0.png" />
</div>
</div>
<p><strong>Stacking</strong></p>
<p>Concatenating a new dimension to produce a new single multivariate series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">series</span> <span class="o">/</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">series_noise</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_18_0.png" src="../_images/quickstart_00-quickstart_18_0.png" />
</div>
</div>
<p><strong>Mapping:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_20_0.png" src="../_images/quickstart_00-quickstart_20_0.png" />
</div>
</div>
<p><strong>Mapping on both timestamps and values:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">ts</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">ts</span><span class="o">.</span><span class="n">days_in_month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_22_0.png" src="../_images/quickstart_00-quickstart_22_0.png" />
</div>
</div>
<p><strong>Adding some datetime attribute as an extra dimension (yielding a multivariate series):</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">series</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">add_datetime_attribute</span><span class="p">(</span><span class="s2">&quot;month&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_24_0.png" src="../_images/quickstart_00-quickstart_24_0.png" />
</div>
</div>
<p><strong>Adding some binary holidays component:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="p">(</span><span class="n">series</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">add_holidays</span><span class="p">(</span><span class="s2">&quot;US&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_26_0.png" src="../_images/quickstart_00-quickstart_26_0.png" />
</div>
</div>
<p><strong>Differencing:</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">series</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_28_0.png" src="../_images/quickstart_00-quickstart_28_0.png" />
</div>
</div>
<p><strong>Filling missing values (using a ``utils`` function).</strong></p>
<p>Missing values are represented by <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.missing_values</span><span class="w"> </span><span class="kn">import</span> <span class="n">fill_missing_values</span>

<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">values</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">values</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">95</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">series_</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<span class="p">(</span><span class="n">series_</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;with missing values (shifted below)&quot;</span><span class="p">)</span>
<span class="n">fill_missing_values</span><span class="p">(</span><span class="n">series_</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;without missing values&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_30_0.png" src="../_images/quickstart_00-quickstart_30_0.png" />
</div>
</div>
</section>
<section id="Creating-a-training-and-validation-series">
<h2>Creating a training and validation series<a class="headerlink" href="#Creating-a-training-and-validation-series" title="Permalink to this heading">¶</a></h2>
<p>For what follows, we will split our <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> into a training and a validation series. Note: in general, it is also a good practice to keep a test series aside and never touch it until the end of the process. Here, we just build a training and a validation series for simplicity.</p>
<p>The training series will be a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> containing values until January 1958 (excluded), and the validation series a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> containing the rest:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">split_before</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;19580101&quot;</span><span class="p">))</span>
<span class="n">train</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;training&quot;</span><span class="p">)</span>
<span class="n">val</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_32_0.png" src="../_images/quickstart_00-quickstart_32_0.png" />
</div>
</div>
</section>
</section>
<section id="Training-forecasting-models-and-making-predictions">
<h1>Training forecasting models and making predictions<a class="headerlink" href="#Training-forecasting-models-and-making-predictions" title="Permalink to this heading">¶</a></h1>
<section id="Playing-with-toy-models">
<h2>Playing with toy models<a class="headerlink" href="#Playing-with-toy-models" title="Permalink to this heading">¶</a></h2>
<p>There is a collection of “naive” baseline models in Darts, which can be very useful to get an idea of the bare minimum accuracy that one could expect. For example, the <code class="docutils literal notranslate"><span class="pre">NaiveSeasonal(K)</span></code> model always “repeats” the value that occured <code class="docutils literal notranslate"><span class="pre">K</span></code> time steps ago.</p>
<p>In its most naive form, when <code class="docutils literal notranslate"><span class="pre">K=1</span></code>, this model simply always repeats the last value of the training series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveSeasonal</span>

<span class="n">naive_model</span> <span class="o">=</span> <span class="n">NaiveSeasonal</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">naive_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">naive_forecast</span> <span class="o">=</span> <span class="n">naive_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
<span class="n">naive_forecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;naive forecast (K=1)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_34_0.png" src="../_images/quickstart_00-quickstart_34_0.png" />
</div>
</div>
<p>It’s very easy to fit models and produce predictions on <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>. All the models have a <code class="docutils literal notranslate"><span class="pre">fit()</span></code> and a <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function. This is similar to <a class="reference external" href="https://scikit-learn.org/">Scikit-learn</a>, except that it is specific to time series. The <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function takes as argument the training time series on which to fit the model, and the <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function takes as argument the number of time steps (after the end of the training series) over which to forecast.</p>
<section id="Inspect-Seasonality">
<h3>Inspect Seasonality<a class="headerlink" href="#Inspect-Seasonality" title="Permalink to this heading">¶</a></h3>
<p>Our model above is perhaps a bit too naive. We can already improve by exploiting the seasonality in the data. It seems quite obvious that the data has a yearly seasonality, which we can confirm by looking at the auto-correlation function (ACF), and highlighting the lag <code class="docutils literal notranslate"><span class="pre">m=12</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_seasonality</span><span class="p">,</span> <span class="n">plot_acf</span>

<span class="n">plot_acf</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">max_lag</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_36_0.png" src="../_images/quickstart_00-quickstart_36_0.png" />
</div>
</div>
<p>The ACF presents a spike at x = 12, which suggests a yearly seasonality trend (highlighted in red). The blue zone determines the significance of the statistics for a confidence level of <span class="math notranslate nohighlight">\(\alpha = 5\%\)</span>. We can also run a statistical check of seasonality for each candidate period <code class="docutils literal notranslate"><span class="pre">m</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
    <span class="n">is_seasonal</span><span class="p">,</span> <span class="n">period</span> <span class="o">=</span> <span class="n">check_seasonality</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_seasonal</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is seasonality of order </span><span class="si">{</span><span class="n">period</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
There is seasonality of order 12.
</pre></div></div>
</div>
</section>
<section id="A-less-naive-model">
<h3>A less naive model<a class="headerlink" href="#A-less-naive-model" title="Permalink to this heading">¶</a></h3>
<p>Let’s try the <code class="docutils literal notranslate"><span class="pre">NaiveSeasonal</span></code> model again with a seasonality of 12:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">seasonal_model</span> <span class="o">=</span> <span class="n">NaiveSeasonal</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">seasonal_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">seasonal_forecast</span> <span class="o">=</span> <span class="n">seasonal_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
<span class="n">seasonal_forecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;naive forecast (K=12)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_40_0.png" src="../_images/quickstart_00-quickstart_40_0.png" />
</div>
</div>
<p>This is better, but we are still missing the trend. Fortunately, there is also another naive baseline model capturing the trend, which is called <code class="docutils literal notranslate"><span class="pre">NaiveDrift</span></code>. This model simply produces linear predictions, with a slope that is determined by the first and last values of the training set:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveDrift</span>

<span class="n">drift_model</span> <span class="o">=</span> <span class="n">NaiveDrift</span><span class="p">()</span>
<span class="n">drift_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">drift_forecast</span> <span class="o">=</span> <span class="n">drift_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>

<span class="n">combined_forecast</span> <span class="o">=</span> <span class="n">drift_forecast</span> <span class="o">+</span> <span class="n">seasonal_forecast</span> <span class="o">-</span> <span class="n">train</span><span class="o">.</span><span class="n">last_value</span><span class="p">()</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">combined_forecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;combined&quot;</span><span class="p">)</span>
<span class="n">drift_forecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;drift&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_42_0.png" src="../_images/quickstart_00-quickstart_42_0.png" />
</div>
</div>
<p>What happened there? We simply fit a naive drift model, and add its forecast to the seasonal forecast we had previously. We also subtract the last value of the training set from the result, so that the resulting combined forecast starts off with the right offset.</p>
</section>
</section>
<section id="Computing-error-metrics">
<h2>Computing error metrics<a class="headerlink" href="#Computing-error-metrics" title="Permalink to this heading">¶</a></h2>
<p>This looks already like a fairly decent forecast, and we did not use any non-naive model yet. In fact - any model should be able to beat this.</p>
<p>So what’s the error we will have to beat? We will use the <a class="reference external" href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error">Mean Absolute Percentage Error (MAPE)</a> (note that in practice there are often good reasons <em>not</em> to use the MAPE - we use it here as it is quite convenient and scale independent). In Darts it is a simple function call:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mape</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Mean absolute percentage error for the combined naive drift + seasonal: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series</span><span class="p">,</span><span class="w"> </span><span class="n">combined_forecast</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean absolute percentage error for the combined naive drift + seasonal: 5.66%.
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">darts.metrics</span></code> contains many more metrics to compare time series. The metrics will compare only common slices of series when the two series are not aligned, and parallelize computation over a large number of series pairs - but let’s not get ahead of ourselves.</p>
</section>
<section id="Quickly-try-out-several-models">
<h2>Quickly try out several models<a class="headerlink" href="#Quickly-try-out-several-models" title="Permalink to this heading">¶</a></h2>
<p>Darts is built to make it easy to train and validate several models in a unified way. Let’s train a few more and compute their respective MAPE on the validation set:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoARIMA</span><span class="p">,</span> <span class="n">ExponentialSmoothing</span><span class="p">,</span> <span class="n">Theta</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
    <span class="n">forecast</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> obtains MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">forecast</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>


<span class="n">eval_model</span><span class="p">(</span><span class="n">ExponentialSmoothing</span><span class="p">())</span>
<span class="n">eval_model</span><span class="p">(</span><span class="n">AutoARIMA</span><span class="p">())</span>
<span class="n">eval_model</span><span class="p">(</span><span class="n">Theta</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
model ExponentialSmoothing() obtains MAPE: 5.11%
model AutoARIMA() obtains MAPE: 12.70%
model Theta() obtains MAPE: 8.15%
</pre></div></div>
</div>
<p>Here, we only created these models with their default parameters. We can probably do better if we fine-tune to our problem. Let’s try with the Theta method.</p>
<section id="Searching-for-hyper-parameters-with-the-Theta-method">
<h3>Searching for hyper-parameters with the Theta method<a class="headerlink" href="#Searching-for-hyper-parameters-with-the-Theta-method" title="Permalink to this heading">¶</a></h3>
<p>The model <code class="docutils literal notranslate"><span class="pre">Theta</span></code> contains an implementation of Assimakopoulos and Nikolopoulos’ Theta method. This method has had some success, particularly in the M3-competition.</p>
<p>Though the value of the Theta parameter is often set to 0 in applications, our implementation supports a variable value for parameter tuning purposes. Let’s try to find a good value for Theta:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Search for the best theta parameter, by trying 50 different values</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">best_mape</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<span class="n">best_theta</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Theta</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
    <span class="n">pred_theta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">mape</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pred_theta</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">res</span> <span class="o">&lt;</span> <span class="n">best_mape</span><span class="p">:</span>
        <span class="n">best_mape</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">best_theta</span> <span class="o">=</span> <span class="n">theta</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_theta_model</span> <span class="o">=</span> <span class="n">Theta</span><span class="p">(</span><span class="n">best_theta</span><span class="p">)</span>
<span class="n">best_theta_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">pred_best_theta</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lowest MAPE is: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">pred_best_theta</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, with theta = </span><span class="si">{</span><span class="n">best_theta</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Lowest MAPE is: 4.40, with theta = -3.5102040816326543.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">val</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">)</span>
<span class="n">pred_best_theta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_53_0.png" src="../_images/quickstart_00-quickstart_53_0.png" />
</div>
</div>
<p>We can observe that the model with <code class="docutils literal notranslate"><span class="pre">best_theta</span></code> is so far the best we have, in terms of MAPE.</p>
</section>
</section>
</section>
<section id="Backtesting:-simulate-historical-forecasting">
<h1>Backtesting: simulate historical forecasting<a class="headerlink" href="#Backtesting:-simulate-historical-forecasting" title="Permalink to this heading">¶</a></h1>
<p>So at this point we have a model that performs well on our validation set, and that’s good. But, how can we know the performance we <em>would have obtained</em> if we <em>had been using this model</em> historically?</p>
<p>Backtesting simulates predictions that would have been obtained historically with a given model. It can take a while to produce, since the model is (by default) re-trained every time the simulated prediction time advances.</p>
<p>Such simulated forecasts are always defined with respect to a <em>forecast horizon</em>, which is the number of time steps that separate the prediction time from the forecast time. In the example below, we simulate forecasts done for 3 months into the future (compared to prediction time). The result of calling <code class="docutils literal notranslate"><span class="pre">historical_forecasts()</span></code> is (by default) a <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> which contains only the last predicted value of each of those 3-months ahead forecasts:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hfc_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;series&quot;</span><span class="p">:</span> <span class="n">series</span><span class="p">,</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span>
        <span class="s2">&quot;1956-01-01&quot;</span>
    <span class="p">),</span>  <span class="c1"># can also be a float for the fraction of the series to start at</span>
    <span class="s2">&quot;forecast_horizon&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">historical_fcast_theta</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">hfc_params</span>
<span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">historical_fcast_theta</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;backtest 3-months ahead forecast (Theta)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series</span><span class="p">,</span><span class="w"> </span><span class="n">historical_fcast_theta</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ac5035021164205b14935cc4a8b8cc3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 7.99%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_56_2.png" src="../_images/quickstart_00-quickstart_56_2.png" />
</div>
</div>
<p>We can also retrieve all predicted values from each historical forecast, by setting <code class="docutils literal notranslate"><span class="pre">last_points_only=False</span></code>. With the <code class="docutils literal notranslate"><span class="pre">stride</span></code> parameter we define how many steps to move between two consecutative forecasts. We set it to 3 months, so that we can then concatenate the forecasts into a single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">historical_fcast_theta_all</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">hfc_params</span>
<span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">hfc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">historical_fcast_theta_all</span><span class="p">):</span>
    <span class="n">hfc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;forecast </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">darts</span><span class="w"> </span><span class="kn">import</span> <span class="n">concatenate</span>

<span class="n">historical_fcast_theta_all</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span><span class="n">historical_fcast_theta_all</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series</span><span class="p">,</span><span class="w"> </span><span class="n">historical_fcast_theta_all</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "66a795239dee494e976c17b620d67e4c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 5.61%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_58_2.png" src="../_images/quickstart_00-quickstart_58_2.png" />
</div>
</div>
<p>So it seems that our best model on validation set is not doing so great anymore when we backtest it (did I hear overfitting :D)</p>
<p>To have a closer look at the errors, we can also use the <code class="docutils literal notranslate"><span class="pre">backtest()</span></code> method to obtain all the raw errors (say, MAPE errors) that would have been obtained by our model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_theta_model</span> <span class="o">=</span> <span class="n">Theta</span><span class="p">(</span><span class="n">best_theta</span><span class="p">)</span>

<span class="n">raw_errors</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">backtest</span><span class="p">(</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">hfc_params</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_hist</span>

<span class="n">plot_hist</span><span class="p">(</span>
    <span class="n">raw_errors</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">raw_errors</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Individual backtest error scores (histogram)&quot;</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5b2657cb3b8e438fb1a7adfa8a157439", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_60_1.png" src="../_images/quickstart_00-quickstart_60_1.png" />
</div>
</div>
<p>Finally, using <code class="docutils literal notranslate"><span class="pre">backtest()</span></code> we can also get a simpler view of the average error over the historical forecasts:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">average_error</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">backtest</span><span class="p">(</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span>
    <span class="n">reduction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="c1"># this is actually the default</span>
    <span class="o">**</span><span class="n">hfc_params</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average error (MAPE) over all historical forecasts: </span><span class="si">{</span><span class="n">average_error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c78c411fe311455a9f6aa5cc58b50fa6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average error (MAPE) over all historical forecasts: 6.30
</pre></div></div>
</div>
<p>We could also for instance have specified the argument <code class="docutils literal notranslate"><span class="pre">reduction=np.median</span></code> to get the median MAPE instead.</p>
<p>Above, <code class="docutils literal notranslate"><span class="pre">backtest()</span></code> re-computed the historical forecasts every time we called it. We can also use some pre-computed forecasts to get the results much faster!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hfc_precomputed</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">hfc_params</span>
<span class="p">)</span>
<span class="n">new_error</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">backtest</span><span class="p">(</span>
    <span class="n">historical_forecasts</span><span class="o">=</span><span class="n">hfc_precomputed</span><span class="p">,</span> <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">hfc_params</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average error (MAPE) over all historical forecasts: </span><span class="si">{</span><span class="n">new_error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "441dc14524f0464bba31e536d5e7f99e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Average error (MAPE) over all historical forecasts: 6.30
</pre></div></div>
</div>
<p>Let’s look at the fitted value residuals of our current <code class="docutils literal notranslate"><span class="pre">Theta</span></code> model, i.e. the difference between the 1-step forecasts at every point in time obtained by fitting the model on all previous points, and the actual observed values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_residuals_analysis</span>

<span class="n">plot_residuals_analysis</span><span class="p">(</span><span class="n">best_theta_model</span><span class="o">.</span><span class="n">residuals</span><span class="p">(</span><span class="n">series</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_66_0.png" src="../_images/quickstart_00-quickstart_66_0.png" />
</div>
</div>
<p>We can see that the distribution is not centered at 0, which means that our <code class="docutils literal notranslate"><span class="pre">Theta</span></code> model is biased. We can also make out a large ACF value at lag equal to 12, which indicates that the residuals contain information that was not used by the model.</p>
<p>Our <code class="docutils literal notranslate"><span class="pre">residuals</span></code> method is actually much more powerful! It can be used to compute any <em>per-time step metric</em> from Darts (see a list <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>) even for multi-step forecasts. It also supports pre-computed historical forecasts similar to backtest.</p>
<p>Now let’s check the distribution of absolute errors we get for each step in the 3 months forecasts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ae</span>

<span class="n">residuals</span> <span class="o">=</span> <span class="n">best_theta_model</span><span class="o">.</span><span class="n">residuals</span><span class="p">(</span>
    <span class="n">historical_forecasts</span><span class="o">=</span><span class="n">hfc_precomputed</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">ae</span><span class="p">,</span>  <span class="c1"># the absolute error per time step</span>
    <span class="n">last_points_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">values_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># return a list of numpy arrays</span>
    <span class="o">**</span><span class="n">hfc_params</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">forecast_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuals</span><span class="p">[</span><span class="n">forecast_step</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;step </span><span class="si">{</span><span class="n">forecast_step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Absolute errors per forecast step&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_68_0.png" src="../_images/quickstart_00-quickstart_68_0.png" />
</div>
</div>
<p>We can clearly see that the errors increase the further ahead into the future we predict.</p>
<p>Could we maybe do better with a simple <code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code> model?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_es</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">historical_fcast_es</span> <span class="o">=</span> <span class="n">model_es</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span><span class="o">**</span><span class="n">hfc_params</span><span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">historical_fcast_es</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;backtest 3-months ahead forecast (Exp. Smoothing)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">historical_fcast_es</span><span class="p">,</span><span class="w"> </span><span class="n">series</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e5bd892913f7438a8dd6c02524739933", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 4.42%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_71_2.png" src="../_images/quickstart_00-quickstart_71_2.png" />
</div>
</div>
<p>This is much better! We get a mean absolute percentage error of about 4-5% when backtesting with a 3-months forecast horizon in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_residuals_analysis</span><span class="p">(</span><span class="n">model_es</span><span class="o">.</span><span class="n">residuals</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3d93fe561d1403cbfc2f4fb28c9718a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_73_1.png" src="../_images/quickstart_00-quickstart_73_1.png" />
</div>
</div>
<p>The residual analysis also reflects an improved performance in that we now have a distribution of the residuals centred at value 0, and the ACF values, although not insignificant, have lower magnitudes.</p>
</section>
<section id="Machine-learning-and-global-models">
<h1>Machine learning and global models<a class="headerlink" href="#Machine-learning-and-global-models" title="Permalink to this heading">¶</a></h1>
<p>Darts has a rich support for machine learning and deep learning forecasting models; for instance:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.sklearn_model.html">SKLearnModel</a> can wrap around any sklearn-compatible regression model to produce forecasts (it has its own <a class="reference external" href="#Regression-forecasting-models">section below</a>).</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.rnn_model.html">RNNModel</a> is a flexible RNN implementation, which can be used like DeepAR.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.nbeats.html">NBEATSModel</a> implements the N-BEATS model.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.tft_model.html">TFTModel</a> implements the Temporal Fusion Transformer model.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.tcn_model.html">TCNModel</a> implements temporal convolutional networks.</p></li>
<li><p>…</p></li>
</ul>
<p>In addition to supporting the same basic <code class="docutils literal notranslate"><span class="pre">fit()</span></code>/<code class="docutils literal notranslate"><span class="pre">predict()</span></code> interface as the other models, these models are also <em>global models</em>, as they support being trained on multiple time series (sometimes referred to as <em>meta learning</em>).</p>
<p>This is a key point of using ML-based models for forecasting: more often than not, ML models (especially deep learning models) need to be trained on large amounts of data, which often means a large amount of separate yet related time series.</p>
<p>In Darts, the basic way to specify multiple <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> is using a <code class="docutils literal notranslate"><span class="pre">Sequence</span></code> of <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for example, a simple list of <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>).</p>
<section id="A-toy-example-with-two-series">
<h2>A toy example with two series<a class="headerlink" href="#A-toy-example-with-two-series" title="Permalink to this heading">¶</a></h2>
<p>These models can be trained on thousands of series. Here, for the sake of illustration, we will load two distinct series - the air traffic passenger count and another series with the number of pounds of milk produced per cow monthly. We also cast our series to <code class="docutils literal notranslate"><span class="pre">np.float32</span></code> as that will slightly speedup the training:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span><span class="p">,</span> <span class="n">MonthlyMilkDataset</span>

<span class="n">series_air</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">series_milk</span> <span class="o">=</span> <span class="n">MonthlyMilkDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># set aside last 36 months of each series as validation set:</span>
<span class="n">train_air</span><span class="p">,</span> <span class="n">val_air</span> <span class="o">=</span> <span class="n">series_air</span><span class="p">[:</span><span class="o">-</span><span class="mi">36</span><span class="p">],</span> <span class="n">series_air</span><span class="p">[</span><span class="o">-</span><span class="mi">36</span><span class="p">:]</span>
<span class="n">train_milk</span><span class="p">,</span> <span class="n">val_milk</span> <span class="o">=</span> <span class="n">series_milk</span><span class="p">[:</span><span class="o">-</span><span class="mi">36</span><span class="p">],</span> <span class="n">series_milk</span><span class="p">[</span><span class="o">-</span><span class="mi">36</span><span class="p">:]</span>

<span class="n">train_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">val_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">train_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">val_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_76_0.png" src="../_images/quickstart_00-quickstart_76_0.png" />
</div>
</div>
<p>First, let’s scale these two series between 0 and 1, as that will benefit most ML models. We will use a <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.dataprocessing.transformers.scaler.html">Scaler</a> for this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.dataprocessing.transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span>
<span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">train_air</span><span class="p">,</span> <span class="n">train_milk</span><span class="p">])</span>

<span class="n">train_air_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">train_milk_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_78_0.png" src="../_images/quickstart_00-quickstart_78_0.png" />
</div>
</div>
<p>Note how we can scale several series in one go. We can also parallelize this sort of operations over multiple processors by specifying <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code>.</p>
</section>
<section id="Using-deep-learning:-example-with-N-BEATS">
<h2>Using deep learning: example with N-BEATS<a class="headerlink" href="#Using-deep-learning:-example-with-N-BEATS" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>Note: You can find a detailed user guide for our Neural Network Models (TorchForecastingModels) <a class="reference external" href="https://unit8co.github.io/darts/userguide/torch_forecasting_models.html">here</a>.</p>
</div></blockquote>
<p>Next, we will build an <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.nbeats.html">N-BEATS model</a>. This model can be tuned with many hyper-parameters (such as number of stacks, layers, etc). Here, for simplicity, we will use it with default hyper-parameters. The only two hyper-parameters that we have to provide are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input_chunk_length</span></code>: this is the “lookback window” of the model - i.e., how many time steps of history the neural network takes as input to produce its output in a forward pass.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_chunk_length</span></code>: this is the “forward window” of the model - i.e., how many time steps of future values the neural network outputs in a forward pass.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">random_state</span></code> parameter is just here to get reproducible results.</p>
<p>Most neural networks in Darts require these two parameters. Here, we will use multiples of the seasonality. We are now ready to fit our model on our two series (by giving a list containing the two series to <code class="docutils literal notranslate"><span class="pre">fit()</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">NBEATSModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | stacks          | ModuleList       | 6.2 M  | train
-------------------------------------------------------------
6.2 M     Trainable params
1.4 K     Non-trainable params
6.2 M     Total params
24.787    Total estimated model params size (MB)
396       Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ef3ba746c7c422695cc97a6e33138df", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`Trainer.fit` stopped: `max_epochs=50` reached.
</pre></div></div>
</div>
<p>Let’s now get some forecasts 36 months ahead, for our two series. We can just use the <code class="docutils literal notranslate"><span class="pre">series</span></code> argument of the <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function to tell the model which series to forecast. Importantly, the <code class="docutils literal notranslate"><span class="pre">output_chunk_length</span></code> does not directly constrain the forecast horizon <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">predict()</span></code>. Here, we trained the model with <code class="docutils literal notranslate"><span class="pre">output_chunk_length=12</span></code> and produce forecasts for <code class="docutils literal notranslate"><span class="pre">n=36</span></code> months ahead; this is simply done in an auto-regressive way behind the scenes (where the network recursively
consumes its previous outputs).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (air)&quot;</span><span class="p">)</span>
<span class="n">series_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (milk)&quot;</span><span class="p">)</span>
<span class="n">pred_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (air)&quot;</span><span class="p">)</span>
<span class="n">pred_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (milk)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "226627f1e4164e0382b034052945fb88", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_83_2.png" src="../_images/quickstart_00-quickstart_83_2.png" />
</div>
</div>
<p>Our forecasts are actually not so terrible, considering that we use <strong>one model</strong> with default hyper-parameters to capture both air passengers and milk production!</p>
<p>The model seems quite OK at capturing the yearly seasonality, but misses the trend for the air series. In the next section, we will try to solve this issue using external data (covariates).</p>
</section>
</section>
<section id="Covariates:-using-external-data">
<h1>Covariates: using external data<a class="headerlink" href="#Covariates:-using-external-data" title="Permalink to this heading">¶</a></h1>
<p>In addition to the <strong>target</strong> series (the series we are interested to forecast), many models in Darts also accept <strong>covariates</strong> series in input. Covariates are series that we do not want to forecast, but which can provide helpful additional information to the models. Both the targets and covariates can be multivariate or univariate.</p>
<p>There are two kinds of covariate time series in Darts:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> are series not necessarily known ahead of the forecast time. They can for instance represent things that have to be measured and are not known upfront. Models do not use future values of <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> when making forecasts (only for global models when predicting with <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">output_chunk_length</span></code> due to auto-regression). For more info on past/future covariates, check out this <a class="reference external" href="https://unit8co.github.io/darts/userguide/covariates.html">user guide</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> are series which are known in advance, up to the forecast horizon. They can represent things such as calendar information, holidays, weather forecasts, etc. Models that accept <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> will look at the future values (up to the forecast horizon) when making forecasts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">static_covariates</span></code> are characteristics of the target series which do not change over time. They are embedded directly into the target series. They can represent things such as the category of product, country information, etc. For more info on static covariates, check out this <a class="reference external" href="https://unit8co.github.io/darts/examples/15-static-covariates.html">user guide</a>.</p></li>
</ul>
<img alt="covariates" src="../_images/covariates-highlevel.png" />
<p>Each covariate can potentially be multivariate. If you have several covariate series (such as month and year values), you should <code class="docutils literal notranslate"><span class="pre">stack()</span></code> or <code class="docutils literal notranslate"><span class="pre">concatenate()</span></code> them to obtain a multivariate series.</p>
<p>The covariates you provide can be longer than necessary. <strong>Darts’s model will automatically handle the extraction of relevant time frames for you!</strong> You will receive an error if your covariates do not have a sufficient time span, though.</p>
<p>Not all models support every covariate type. You can find a model list <a class="reference external" href="https://unit8co.github.io/darts/index.html#forecasting-models">here</a> stating which types they support.</p>
<p>Let’s now build some external covariates containing both monthly and yearly values for our air and milk series. In the cell below, we use the <code class="docutils literal notranslate"><span class="pre">darts.utils.timeseries_generation.datetime_attribute_timeseries()</span></code> function to generate series containing the month and year values, and we <code class="docutils literal notranslate"><span class="pre">concatenate()</span></code> these series along the <code class="docutils literal notranslate"><span class="pre">&quot;component&quot;</span></code> axis (same as <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>) in order to obtain one covariate series with two components (month and year), per target series. For simplicity, we directly scale
the month and year values to have them between 0 and 1:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts</span><span class="w"> </span><span class="kn">import</span> <span class="n">concatenate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.timeseries_generation</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime_attribute_timeseries</span> <span class="k">as</span> <span class="n">dt_attr</span>

<span class="n">air_covs</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">dt_attr</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">dt_attr</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;component&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">milk_covs</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">dt_attr</span><span class="p">(</span><span class="n">series_milk</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
        <span class="n">dt_attr</span><span class="p">(</span><span class="n">series_milk</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;component&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span> <span class="o">=</span> <span class="n">Scaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="n">air_covs</span><span class="p">,</span> <span class="n">milk_covs</span><span class="p">])</span>
<span class="n">air_covs_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">milk_covs_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
    <span class="s2">&quot;one multivariate time series of 2 dimensions, containing covariates for the air series:&quot;</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_86_0.png" src="../_images/quickstart_00-quickstart_86_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NBEATSModel</span></code> supports only <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code>. Therefore, even though our covariates represent calendar information and are known in advance, we will use them as <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> with N-BEATS. To train, all we have to do is give them as <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> to the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function, in the same order as the targets:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span>
    <span class="n">past_covariates</span><span class="o">=</span><span class="p">[</span><span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span><span class="p">],</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | stacks          | ModuleList       | 6.6 M  | train
-------------------------------------------------------------
6.6 M     Trainable params
1.7 K     Non-trainable params
6.6 M     Total params
26.314    Total estimated model params size (MB)
396       Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "89aad5d49a1045f1bba0237f7fe47eb3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`Trainer.fit` stopped: `max_epochs=50` reached.
</pre></div></div>
</div>
<p>Then to produce forecasts, we again have to provide our covariates as <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> to the <code class="docutils literal notranslate"><span class="pre">predict()</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span>
    <span class="n">past_covariates</span><span class="o">=</span><span class="p">[</span><span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span><span class="p">],</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (air)&quot;</span><span class="p">)</span>
<span class="n">series_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (milk)&quot;</span><span class="p">)</span>
<span class="n">pred_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (air)&quot;</span><span class="p">)</span>
<span class="n">pred_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (milk)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`predict()` was called with `n &gt; output_chunk_length`: using auto-regression to forecast the values after `output_chunk_length` points. The model will access `(n - output_chunk_length)` future values of your `past_covariates` (relative to the first predicted time step). To hide this warning, set `show_warnings=False`.
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e47e88ad7daf45e5968b1f52f5a1f261", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_90_2.png" src="../_images/quickstart_00-quickstart_90_2.png" />
</div>
</div>
<p>It seems that now the model captures the trend of the air series better (which also perturbs a bit the forecasts of the milk series).</p>
<p>The model warning is pretty important. It tells us that future values of our <code class="docutils literal notranslate"><span class="pre">past_covariates</span></code> were used for prediction because we picked a hoizon <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&gt;</span> <span class="pre">output_chunk_length</span></code> which activates auto-regression. The model will then cosume it’s own predictions as input for the next prediction. Since the prediction point moves ahead, the model requires new values from the past covariates. These will however only be extracted from the past relative to the prediciton point (never from the forecast
horizon itself)!</p>
<p>In our case it’s fine to do this since we only use calendar information that we know in advance. If instead we used some features that we only know in the past, then we should only forecast with <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">&lt;=</span> <span class="pre">output_chunk_length</span></code>.</p>
<section id="Encoders:-using-covariates-for-free">
<h2>Encoders: using covariates for free<a class="headerlink" href="#Encoders:-using-covariates-for-free" title="Permalink to this heading">¶</a></h2>
<p>Using covariates related to the calendar or time axis (such as months and years as in our example above) is so frequent that all of Darts’ models with covariates support have a built-in functionality to generate them out of the box.</p>
<p>To easily integrate such covariates to your model, you can simply specify the <code class="docutils literal notranslate"><span class="pre">add_encoders</span></code> parameter at model creation. This parameter has to be a dictionary containing informations about what should be encoded as extra covariates. Here is an example of what such a dictionary could look like, for a model supporting both past and future covariates:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_year</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract the year each time index entry and normalized it.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="mi">1950</span><span class="p">)</span> <span class="o">/</span> <span class="mi">50</span>


<span class="n">encoders</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;cyclic&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">]},</span>
    <span class="s2">&quot;datetime_attribute&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hour&quot;</span><span class="p">,</span> <span class="s2">&quot;dayofweek&quot;</span><span class="p">]},</span>
    <span class="s2">&quot;position&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;past&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;absolute&quot;</span><span class="p">],</span> <span class="s2">&quot;future&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;relative&quot;</span><span class="p">]},</span>
    <span class="s2">&quot;custom&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;past&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">extract_year</span><span class="p">]},</span>
    <span class="s2">&quot;transformer&quot;</span><span class="p">:</span> <span class="n">Scaler</span><span class="p">(),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>In the above dictionary, the following things are specified:</p>
<ul class="simple">
<li><p>The month should be used as a future covariate, with a cyclic (sin/cos) encoding.</p></li>
<li><p>The hour and day-of-the-week should be used as future covariates.</p></li>
<li><p>The absolute position (time step in the series) should be used as past covariates.</p></li>
<li><p>The relative position (w.r.t the forecasting time) should be used as future covariates.</p></li>
<li><p>An additional custom function of the year should be used as past covariates.</p></li>
<li><p>All the above covariates should be scaled using a <code class="docutils literal notranslate"><span class="pre">Scaler</span></code>, which will be fit upon calling the model <code class="docutils literal notranslate"><span class="pre">fit()</span></code> function and used afterwards to transform the covariates.</p></li>
</ul>
<p>We refer to <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.dataprocessing.encoders.encoders.html#sequentialencoder">the API doc</a> for more informations about how to use encoders. Note that lambda functions cannot be used as they are not pickable.</p>
<p>To replicate our example with month and year used as past covariates with N-BEATS, we can use some encoders as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">encoders</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;datetime_attribute&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;past&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">]},</span> <span class="s2">&quot;transformer&quot;</span><span class="p">:</span> <span class="n">Scaler</span><span class="p">()}</span>
</pre></div>
</div>
</div>
<p>Now, the whole training of the N-BEATS model with these covariates looks as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">add_encoders</span><span class="o">=</span><span class="n">encoders</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | stacks          | ModuleList       | 6.6 M  | train
-------------------------------------------------------------
6.6 M     Trainable params
1.7 K     Non-trainable params
6.6 M     Total params
26.314    Total estimated model params size (MB)
396       Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a7020f8aed94382a9c9ef6c8b27bd5c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`Trainer.fit` stopped: `max_epochs=50` reached.
</pre></div></div>
</div>
<p>And get some forecasts for the air passengers series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">show_warnings</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (air)&quot;</span><span class="p">)</span>
<span class="n">series_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (milk)&quot;</span><span class="p">)</span>
<span class="n">pred_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (air)&quot;</span><span class="p">)</span>
<span class="n">pred_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (milk)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "14adc40441224eed8d3ec599e44decf6", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_99_2.png" src="../_images/quickstart_00-quickstart_99_2.png" />
</div>
</div>
</section>
</section>
<section id="Regression-forecasting-models">
<h1>Regression forecasting models<a class="headerlink" href="#Regression-forecasting-models" title="Permalink to this heading">¶</a></h1>
<blockquote>
<div><p>Note: You can find a detailed example notebook for our SKLearnModel <a class="reference external" href="https://unit8co.github.io/darts/examples/20-SKLearnModel-examples.html">here</a>.</p>
</div></blockquote>
<p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.sklearn_model.html">SKLearnModel</a> are forecasting models which wrap around sklearn-compatible regression models. The inner regression model is used to predict future values of the target series, as a function of certain lags of the target, past and future covariates. Behind the scenes, the time series are tabularized in order to build a training dataset in the right format.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">SKLearnModel</span></code> will do a linear regression. It is very easy to use any desired sklearn-compatible regression model by specifying the <code class="docutils literal notranslate"><span class="pre">model</span></code> parameter, but for convenience Darts also provides a couple of ready-made models out of the box:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.linear_regression_model.html">LinearRegressionModel</a> wraps around <code class="docutils literal notranslate"><span class="pre">sklearn.linear_model.LinearRegression</span></code> (accepting the same kwargs).</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.random_forest.html">RandomForestModel</a> wraps around <code class="docutils literal notranslate"><span class="pre">sklearn.ensemble.RandomForestRegressor</span></code>.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.lgbm.html">LightGBMModel</a> wraps around <code class="docutils literal notranslate"><span class="pre">lightbm</span></code>.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.xgboost.html">XGBModel</a> wraps around <code class="docutils literal notranslate"><span class="pre">xgboost</span></code>.</p></li>
<li><p><a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.catboost_model.html">CatBoostModel</a> wraps around <code class="docutils literal notranslate"><span class="pre">catboost</span></code>.</p></li>
</ul>
<p>For example, this is what fitting a Bayesian ridge regression to our toy two-series problem looks like:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">BayesianRidge</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">SKLearnModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SKLearnModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">BayesianRidge</span><span class="p">())</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span>
    <span class="n">future_covariates</span><span class="o">=</span><span class="p">[</span><span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span><span class="p">],</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>Several things happened above:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lags=72</span></code> is telling the <code class="docutils literal notranslate"><span class="pre">SKLearnModel</span></code> to look at the past 72 lags / months of the target.</p></li>
<li><p>In addition, <code class="docutils literal notranslate"><span class="pre">lags_future_covariates=[-6,</span> <span class="pre">0]</span></code> means that the model will also look at lags of the <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> we provide. Here we specify the exact lags we want the models to take into account; the “-6th” and the “0th” lag. The “0th” lag means the “current” lag (i.e., at the time step being forecasted); obviously, knowning this lag requires knowing the data in advance (hence the fact we are using <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code>). Similarly, <code class="docutils literal notranslate"><span class="pre">-6</span></code> means we also look at the value of the
covariates 6 months before the forecasted time step (which also requires to know the covariates in advance if we are forecasting at a horizon more than 6 steps ahead).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">model=BayesianRidge()</span></code> provides the actual inner regression model.</p></li>
</ul>
<p>Now let’s get some forecasts:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">train_milk_scaled</span><span class="p">],</span>
    <span class="n">future_covariates</span><span class="o">=</span><span class="p">[</span><span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span><span class="p">],</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (air)&quot;</span><span class="p">)</span>
<span class="n">series_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual (milk)&quot;</span><span class="p">)</span>
<span class="n">pred_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (air)&quot;</span><span class="p">)</span>
<span class="n">pred_milk</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;forecast (milk)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_103_0.png" src="../_images/quickstart_00-quickstart_103_0.png" />
</div>
</div>
<p>Note how we obtained the forecasts for the two time series at once above. Similarly, we can also get some metrics over sequences of series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mape</span><span class="p">([</span><span class="n">series_air</span><span class="p">,</span> <span class="n">series_milk</span><span class="p">],</span> <span class="p">[</span><span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[3.435389, 5.129032]
</pre></div></div>
</div>
<p>or the average metric over “all” series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mape</span><span class="p">([</span><span class="n">series_air</span><span class="p">,</span> <span class="n">series_milk</span><span class="p">],</span> <span class="p">[</span><span class="n">pred_air</span><span class="p">,</span> <span class="n">pred_milk</span><span class="p">],</span> <span class="n">series_reduction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.2822104
</pre></div></div>
</div>
<p>It seems that this model performs well on the Air traffic series, how does it do when we backtest it on this one series?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bayes_ridge_model</span> <span class="o">=</span> <span class="n">SKLearnModel</span><span class="p">(</span>
    <span class="n">lags</span><span class="o">=</span><span class="mi">72</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">BayesianRidge</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">backtest</span> <span class="o">=</span> <span class="n">bayes_ridge_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">future_covariates</span><span class="o">=</span><span class="p">[</span><span class="n">air_covs_scaled</span><span class="p">,</span> <span class="n">milk_covs_scaled</span><span class="p">],</span>
    <span class="o">**</span><span class="n">hfc_params</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">backtest</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">backtest</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`enable_optimization=True` is ignored because `retrain` is not `False` or `0`. To hide this warning, set `show_warnings=False` or `enable_optimization=False`.
`enable_optimization=True` is ignored because `forecast_horizon &gt; model.output_chunk_length`. To hide this warning, set `show_warnings=False` or `enable_optimization=False`.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d51e0ce82c6849a5ab8e7dda063eb6f4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 3.76%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_109_3.png" src="../_images/quickstart_00-quickstart_109_3.png" />
</div>
</div>
<p>Our best model so far!</p>
<p>To avoid data-leakage through the target and future covariate scaler, we will pass it to <code class="docutils literal notranslate"><span class="pre">historical_forecasts</span></code> so that the scaler is fitted and applied to both the target and the future covariates at each iteration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">backtest_auto_scaling</span> <span class="o">=</span> <span class="n">bayes_ridge_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">future_covariates</span><span class="o">=</span><span class="n">air_covs</span><span class="p">,</span>
    <span class="n">data_transformers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;series&quot;</span><span class="p">:</span> <span class="n">Scaler</span><span class="p">(),</span> <span class="s2">&quot;future_covariates&quot;</span><span class="p">:</span> <span class="n">Scaler</span><span class="p">()},</span>
    <span class="n">retrain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># ensure that the scalers are fitted at each iterations</span>
    <span class="o">**</span><span class="n">hfc_params</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">backtest_auto_scaling</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">backtest_auto_scaling</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`enable_optimization=True` is ignored because `retrain` is not `False` or `0`. To hide this warning, set `show_warnings=False` or `enable_optimization=False`.
`enable_optimization=True` is ignored because `forecast_horizon &gt; model.output_chunk_length`. To hide this warning, set `show_warnings=False` or `enable_optimization=False`.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3fc0c9a401c840a9b0f5d1d115248dd7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 3.92%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_111_3.png" src="../_images/quickstart_00-quickstart_111_3.png" />
</div>
</div>
<p>The MAPE score is slightly worse, which is expected since information cannot leak from the future anymore but the backtesting conditions are more reliable.</p>
</section>
<section id="Sample-Weights">
<h1>Sample Weights<a class="headerlink" href="#Sample-Weights" title="Permalink to this heading">¶</a></h1>
<p>All our global models (regression-, ensemble-, and neural network models) support sample weights for training. They are applied per observation, label (each step in <code class="docutils literal notranslate"><span class="pre">output_chunk_length</span></code>), and component. This can be very useful to:</p>
<ul class="simple">
<li><p>weigh certain time frames more than others (e.g. decaying weights the further the points in the past, higher weights for times with more business value, …)</p></li>
<li><p>reduce / remove the effect of outliers or missing values on the model</p></li>
</ul>
<p>Let’s just introduce some outliers to the air passengers series and see how a linear regression model with a 12 months lookback window (<code class="docutils literal notranslate"><span class="pre">lags=12</span></code>) performs on this data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># convert to pandas DataFrame and add some outliers</span>
<span class="n">air_df</span> <span class="o">=</span> <span class="n">series_air</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">outlier_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">air_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">1950</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">air_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">1951</span><span class="p">)</span>
<span class="n">air_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">outlier_mask</span><span class="p">]</span> <span class="o">=</span> <span class="mf">600.0</span>
<span class="n">air_outlier</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">air_df</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegressionModel</span>

<span class="n">model_lin</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">hist_fc_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;series&quot;</span><span class="p">:</span> <span class="n">air_outlier</span><span class="p">,</span>
    <span class="s2">&quot;future_covariates&quot;</span><span class="p">:</span> <span class="n">air_covs_scaled</span><span class="p">,</span>
    <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="s2">&quot;forecast_horizon&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;show_warnings&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">backtest</span> <span class="o">=</span> <span class="n">model_lin</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span><span class="o">**</span><span class="n">hist_fc_kwargs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">air_outlier</span><span class="p">,</span><span class="w"> </span><span class="n">backtest</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">air_outlier</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;air series with outliers&quot;</span><span class="p">)</span>
<span class="n">backtest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;non-weighted predictions&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8ea826a5e36c4efeb062d2a4ccca4661", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 26.40%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_114_2.png" src="../_images/quickstart_00-quickstart_114_2.png" />
</div>
</div>
<p>This doesn’t look very good. It would be great if we could ignore the outliers somehow. And this is where sample weights come in!</p>
<p>In Darts, sample weights are treated like covariates - they are defined as <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> themselves. Thanks to that our models can automatically extract the relevant time frames for us!</p>
<p>Let’s create a weights series in which we set all outlier times to <code class="docutils literal notranslate"><span class="pre">0.</span></code> and the remaining times to <code class="docutils literal notranslate"><span class="pre">1.</span></code>. We also set the 12 months after the last outlier to <code class="docutils literal notranslate"><span class="pre">0.</span></code>, since these times fall into the lookback window of our model. Otherwise we would still have some outliers in the model input.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">weight_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">air_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="mi">1950</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">air_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">1952</span><span class="p">)</span>
<span class="n">sample_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">air_df</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">sample_weight</span><span class="p">[</span><span class="n">weight_mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">sample_weight</span> <span class="o">=</span> <span class="n">air_outlier</span><span class="o">.</span><span class="n">with_values</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>

<span class="c1"># and plot the results</span>
<span class="n">air_outlier</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;air series with outliers&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">sample_weight</span> <span class="o">*</span> <span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;sample weight * 300&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_116_0.png" src="../_images/quickstart_00-quickstart_116_0.png" />
</div>
</div>
<p>Now we can train the models with the sample weights using methods <code class="docutils literal notranslate"><span class="pre">fit()</span></code>, <code class="docutils literal notranslate"><span class="pre">historical_forecasts</span></code>, <code class="docutils literal notranslate"><span class="pre">backtest()</span></code>, …</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_lin</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">backtest_weighted</span> <span class="o">=</span> <span class="n">model_lin</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span>
    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span> <span class="o">**</span><span class="n">hist_fc_kwargs</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">backtest_weighted</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">air_outlier</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;air series with outliers&quot;</span><span class="p">)</span>
<span class="n">backtest_weighted</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;weighted predictions&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cee8f39a41324c8484a27f1b7d128aae", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 5.19%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_118_2.png" src="../_images/quickstart_00-quickstart_118_2.png" />
</div>
</div>
<p>Wow, this looks great! We managed to completely remove the negative impact of the outliers on our model!</p>
<p><strong>Note:</strong> our sample weights also support multi-horizon forecasts, multiple time series, multivariate series, and weights for evaluation sets (if the model support it)</p>
</section>
<section id="Forecast-Start-Shifting">
<h1>Forecast Start Shifting<a class="headerlink" href="#Forecast-Start-Shifting" title="Permalink to this heading">¶</a></h1>
<p>We might also be interested in forecasts starting with an offset after the end of our target series. This can be useful for example:</p>
<ul class="simple">
<li><p>In (Day-) Ahead Markets, where (each day) we need to make some biddings for a future point in time (next day) - we are not really interested in what happens between now and that future point in time. We can reduce model complexity by only focusing on times of interest.</p></li>
<li><p>When are covariates (or target series) are reported with a delay</p></li>
</ul>
<p>All our global models support such predictions with an offset through model creation parameter <code class="docutils literal notranslate"><span class="pre">output_chunk_shift</span></code> - the number of steps to shift the first predicted step into the future.</p>
<p>With an output shift, the model cannot perform auto-regression anymore. So let’s create a linear model that directly predicts the next 12 months with an offset of 12 months.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_shifted</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span>
    <span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">output_chunk_shift</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model_shifted</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series_air</span><span class="p">[:</span><span class="o">-</span><span class="mi">24</span><span class="p">],</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">air_covs</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">model_shifted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">series_air</span><span class="p">[:</span><span class="o">-</span><span class="mi">24</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;train series&quot;</span><span class="p">)</span>
<span class="n">series_air</span><span class="p">[</span><span class="o">-</span><span class="mi">24</span><span class="p">:]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;val_series&quot;</span><span class="p">)</span>
<span class="n">preds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;shifted prediction&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_121_0.png" src="../_images/quickstart_00-quickstart_121_0.png" />
</div>
</div>
<p>We see that the prediction starts 12 months after the end of the training series.</p>
</section>
<section id="Probabilistic-forecasts">
<h1>Probabilistic forecasts<a class="headerlink" href="#Probabilistic-forecasts" title="Permalink to this heading">¶</a></h1>
<p>Most models in Darts support probabilistic forecasts (some local models and all regression-, ensemble- and neural network models). The full support list is <a class="reference external" href="https://github.com/unit8co/darts#forecasting-models">available on the Darts README page</a>.</p>
<section id="With-Local-Models">
<h2>With Local Models<a class="headerlink" href="#With-Local-Models" title="Permalink to this heading">¶</a></h2>
<p>For local models (<code class="docutils literal notranslate"><span class="pre">ARIMA</span></code>, <code class="docutils literal notranslate"><span class="pre">ExponentialSmoothing</span></code>, …), we can simply specify a <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> parameter when calling <code class="docutils literal notranslate"><span class="pre">predict()</span></code>. The returned <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> will then contain <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> Monte Carlo samples describing the distribution of the time series’ values. The advantage of relying on Monte Carlo samples (in contrast to, say, explicit confidence intervals) is that they can be used to describe any parametric or non-parametric joint distribution over components, and compute
arbitrary quantiles.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model_es</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">()</span>
<span class="n">model_es</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">probabilistic_forecast</span> <span class="o">=</span> <span class="n">model_es</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
<span class="n">probabilistic_forecast</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;probabilistic forecast&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_124_0.png" src="../_images/quickstart_00-quickstart_124_0.png" />
</div>
</div>
</section>
<section id="With-Neural-Network-Models-(TorchForecastingModel)">
<h2>With Neural Network Models (TorchForecastingModel)<a class="headerlink" href="#With-Neural-Network-Models-(TorchForecastingModel)" title="Permalink to this heading">¶</a></h2>
<p>With neural networks, we have to use a <code class="docutils literal notranslate"><span class="pre">Likelihood</span></code> object at model creation. The likelihoods specify which distribution the model will try to fit, along with potential prior values for the distributions’ parameters. The full list of available likelihoods is <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.likelihood_models.torch.html">available in the docs</a>.</p>
<p>Next to the distributions, we also support <code class="docutils literal notranslate"><span class="pre">QuantileRegression</span></code> as likelihood, which estimates future quantile values of the target series.</p>
<p>Using likelihoods is easy. For instance, here is what training an <code class="docutils literal notranslate"><span class="pre">TCNModel</span></code> to fit a Laplace likelihood looks like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">TCNModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.likelihood_models.torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">LaplaceLikelihood</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">TCNModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="n">LaplaceLikelihood</span><span class="p">(),</span>
    <span class="n">pl_trainer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;accelerator&quot;</span><span class="p">:</span> <span class="s2">&quot;cpu&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/Users/dennisbader/miniconda3/envs/darts/lib/python3.10/site-packages/pytorch_lightning/trainer/setup.py:177: GPU available but not used. You can set it by doing `Trainer(accelerator=&#39;gpu&#39;)`.

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | res_blocks      | ModuleList       | 166    | train
-------------------------------------------------------------
166       Trainable params
0         Non-trainable params
166       Total params
0.001     Total estimated model params size (MB)
23        Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1a65ec75f0184b159e839857423f978c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
IOPub message rate exceeded.
The Jupyter server will temporarily stop sending output
to the client in order to avoid crashing it.
To change this limit, set the config variable
`--ServerApp.iopub_msg_rate_limit`.

Current values:
ServerApp.iopub_msg_rate_limit=1000.0 (msgs/sec)
ServerApp.rate_limit_window=3.0 (secs)

</pre></div></div>
</div>
<section id="Probabilistic-Sample-Predictions">
<h3>Probabilistic Sample Predictions<a class="headerlink" href="#Probabilistic-Sample-Predictions" title="Permalink to this heading">¶</a></h3>
<p>Then to get probabilistic forecasts, we again only need to specify some <code class="docutils literal notranslate"><span class="pre">num_samples</span> <span class="pre">&gt;&gt;</span> <span class="pre">1</span></code>. This will sample from predicted distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">series_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "35931612a9314c43ab178450c2fddd83", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_128_2.png" src="../_images/quickstart_00-quickstart_128_2.png" />
</div>
</div>
</section>
<section id="Direct-Parameter-Predicitons">
<h3>Direct Parameter Predicitons<a class="headerlink" href="#Direct-Parameter-Predicitons" title="Permalink to this heading">¶</a></h3>
<p>The great thing about our likelihoods is that instead of sampling from the distribution/quantiles, we can directly predict the distribution/quantile parameters. For this, we only have to set <code class="docutils literal notranslate"><span class="pre">predict_likelihood_parameters=True</span></code>.</p>
<p>Below we get the predicted location (mu) and scale (b) of the laplace distribution (in the scaled space between 0 and 1).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">predict_likelihood_parameters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_air_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;laplace_dist&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/Users/dennisbader/miniconda3/envs/darts/lib/python3.10/site-packages/pytorch_lightning/trainer/setup.py:177: GPU available but not used. You can set it by doing `Trainer(accelerator=&#39;gpu&#39;)`.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "55dd72c2d708488997439aa7fd11ce3b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_130_2.png" src="../_images/quickstart_00-quickstart_130_2.png" />
</div>
</div>
<p>Furthermore, we could also for instance specify that we have some prior belief that the scale of the distribution is about <span class="math notranslate nohighlight">\(0.1\)</span> (in the transformed domain), while still capturing some time dependency of the distribution, by specifying <code class="docutils literal notranslate"><span class="pre">prior_b=.1</span></code>.</p>
<p>Behind the scenes this will regularize the training loss with a Kullback-Leibler divergence term.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">TCNModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="n">LaplaceLikelihood</span><span class="p">(</span><span class="n">prior_b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">pl_trainer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;accelerator&quot;</span><span class="p">:</span> <span class="s2">&quot;cpu&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/Users/dennisbader/miniconda3/envs/darts/lib/python3.10/site-packages/pytorch_lightning/trainer/setup.py:177: GPU available but not used. You can set it by doing `Trainer(accelerator=&#39;gpu&#39;)`.

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | res_blocks      | ModuleList       | 166    | train
-------------------------------------------------------------
166       Trainable params
0         Non-trainable params
166       Total params
0.001     Total estimated model params size (MB)
23        Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "19e013d7552a46d094f4f9d8aafbf78c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`Trainer.fit` stopped: `max_epochs=400` reached.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">series_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "64cee5bf0c01475794e0ee0d5dd53ef1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_133_2.png" src="../_images/quickstart_00-quickstart_133_2.png" />
</div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">TimeSeries.plot()</span></code> shows the median as well as the 5th and 95th percentiles (of the marginal distributions, if the <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> is multivariate). It is possible to control this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">low_quantile</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1-99th percentiles&quot;</span><span class="p">)</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">low_quantile</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">high_quantile</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;20-80th percentiles&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_135_0.png" src="../_images/quickstart_00-quickstart_135_0.png" />
</div>
</div>
</section>
<section id="Types-of-distributions">
<h3>Types of distributions<a class="headerlink" href="#Types-of-distributions" title="Permalink to this heading">¶</a></h3>
<p>The likelihood has to be compatible with the domain of your time series’ values. For instance <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.likelihood_models.torch.html#darts.utils.likelihood_models.torch.PoissonLikelihood">PoissonLikelihood</a> can be used on discrete positive values, <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.likelihood_models.torch.html#darts.utils.likelihood_models.torch.ExponentialLikelihood">ExponentialLikelihood</a> can be used on real
positive values, and <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.likelihood_models.torch.html#darts.utils.likelihood_models.torch.BetaLikelihood">BetaLikelihood</a> on real values in <span class="math notranslate nohighlight">\((0,1)\)</span>.</p>
<p>It is also possible to use <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.utils.likelihood_models.torch.html#darts.utils.likelihood_models.torch.QuantileRegression">QuantileRegression</a> to apply a quantile loss and fit some desired quantiles directly.</p>
</section>
<section id="Evaluating-Probabilistic-Forecasts">
<h3>Evaluating Probabilistic Forecasts<a class="headerlink" href="#Evaluating-Probabilistic-Forecasts" title="Permalink to this heading">¶</a></h3>
<p>How can we evaluate the quality of probabilistic forecasts? By default, most metrics functions (such as <code class="docutils literal notranslate"><span class="pre">mape()</span></code>) will keep working but look only at the median forecast. It is also possible to use the Mean Quantile Loss metric <code class="docutils literal notranslate"><span class="pre">mql()</span></code>, which quantifies the error for each predicted quantiles. For quantile=0.5 (the median), it is identical to the Mean Absolute Error (MAE):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mql</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE of median forecast: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE of median forecast: </span><span class="si">{</span><span class="n">mae</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
    <span class="n">q_loss</span> <span class="o">=</span> <span class="n">mql</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;quantile loss at quantile </span><span class="si">{</span><span class="n">q</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">q_loss</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE of median forecast: 12.14
MAE of median forecast: 51.64
quantile loss at quantile 0.05: 5.33
quantile loss at quantile 0.10: 13.14
quantile loss at quantile 0.50: 51.64
quantile loss at quantile 0.90: 20.74
quantile loss at quantile 0.95: 12.20
</pre></div></div>
</div>
</section>
<section id="Using-Quantile-Loss">
<h3>Using Quantile Loss<a class="headerlink" href="#Using-Quantile-Loss" title="Permalink to this heading">¶</a></h3>
<p>Could we do better by fitting these quantiles directly? We can just use a <code class="docutils literal notranslate"><span class="pre">QuantileRegression</span></code> likelihood:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.utils.likelihood_models.torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantileRegression</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">TCNModel</span><span class="p">(</span>
    <span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
    <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="n">QuantileRegression</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]),</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs

  | Name            | Type             | Params | Mode
-------------------------------------------------------------
0 | criterion       | MSELoss          | 0      | train
1 | train_criterion | MSELoss          | 0      | train
2 | val_criterion   | MSELoss          | 0      | train
3 | train_metrics   | MetricCollection | 0      | train
4 | val_metrics     | MetricCollection | 0      | train
5 | res_blocks      | ModuleList       | 208    | train
-------------------------------------------------------------
208       Trainable params
0         Non-trainable params
208       Total params
0.001     Total estimated model params size (MB)
23        Modules in train mode
0         Modules in eval mode
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4dc4a12c3348413cb581a1648833f7ab", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
`Trainer.fit` stopped: `max_epochs=400` reached.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="c1"># scale back:</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">series_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE of median forecast: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
    <span class="n">q_loss</span> <span class="o">=</span> <span class="n">mql</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;quantile loss at quantile </span><span class="si">{</span><span class="n">q</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">q_loss</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
GPU available: True (mps), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "96baa52d87924e6f8528a51e6229c1c7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE of median forecast: 4.91
quantile loss at quantile 0.05: 9.05
quantile loss at quantile 0.10: 13.50
quantile loss at quantile 0.50: 20.07
quantile loss at quantile 0.90: 11.99
quantile loss at quantile 0.95: 7.39
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_140_3.png" src="../_images/quickstart_00-quickstart_140_3.png" />
</div>
</div>
</section>
</section>
<section id="With-Regression-Models">
<h2>With Regression Models<a class="headerlink" href="#With-Regression-Models" title="Permalink to this heading">¶</a></h2>
<p>Probailistic support for our <code class="docutils literal notranslate"><span class="pre">SKLearnModels</span></code> is similiar to that of the neural networks. We have to specify a <code class="docutils literal notranslate"><span class="pre">likelihood</span></code> at model creation. Instead of giving a likelihood object, we can simply pick one of <code class="docutils literal notranslate"><span class="pre">&quot;quantile&quot;</span></code> (with some <code class="docutils literal notranslate"><span class="pre">quantiles</span></code>) and <code class="docutils literal notranslate"><span class="pre">&quot;poisson&quot;</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span>
    <span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
    <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">likelihood</span><span class="o">=</span><span class="s2">&quot;quantile&quot;</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_air</span><span class="p">,</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">air_covs</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>

<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">pred</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE of median forecast: </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span><span class="w"> </span><span class="n">pred</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]:</span>
    <span class="n">q_loss</span> <span class="o">=</span> <span class="n">mql</span><span class="p">(</span><span class="n">series_air</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;quantile loss at quantile </span><span class="si">{</span><span class="n">q</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">q_loss</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE of median forecast: 8.52
quantile loss at quantile 0.05: 20.76
quantile loss at quantile 0.10: 25.44
quantile loss at quantile 0.50: 35.33
quantile loss at quantile 0.90: 11.15
quantile loss at quantile 0.95: 6.19
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_142_1.png" src="../_images/quickstart_00-quickstart_142_1.png" />
</div>
</div>
</section>
</section>
<section id="Ensembling-models">
<h1>Ensembling models<a class="headerlink" href="#Ensembling-models" title="Permalink to this heading">¶</a></h1>
<p><em>Ensembling</em> is about combining the forecasts produced by several models, in order to obtain a final - and hopefully better forecast.</p>
<p>For instance, in our example of a <a class="reference external" href="#A-less-naive-model">less naive model above</a>, we manually combined a naive seasonal model with a naive drift model. Here, we will show how model forecasts can be automatically combined - naively using a <code class="docutils literal notranslate"><span class="pre">NaiveEnsembleModel</span></code>, or learned using <code class="docutils literal notranslate"><span class="pre">RegressionEnsembleModel</span></code>.</p>
<p>It is of course also possible to use <code class="docutils literal notranslate"><span class="pre">past</span></code> and/or <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code> with ensemble model but they will be passed only to the forecasting models supporting them.</p>
<section id="Naive-Ensembling">
<h2>Naive Ensembling<a class="headerlink" href="#Naive-Ensembling" title="Permalink to this heading">¶</a></h2>
<p>Naive ensembling just takes the average of the forecasts from several models. Darts <code class="docutils literal notranslate"><span class="pre">NaiveEnsembleModel</span></code> does exactly that and all through the same API as the forecasting models (fit, predict, historical forecasts, backtesting, …).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">NaiveEnsembleModel</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">NaiveDrift</span><span class="p">(),</span> <span class="n">NaiveSeasonal</span><span class="p">(</span><span class="mi">12</span><span class="p">)]</span>

<span class="n">ensemble_model</span> <span class="o">=</span> <span class="n">NaiveEnsembleModel</span><span class="p">(</span><span class="n">forecasting_models</span><span class="o">=</span><span class="n">models</span><span class="p">)</span>

<span class="n">backtest</span> <span class="o">=</span> <span class="n">ensemble_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span><span class="o">**</span><span class="n">hfc_params</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">backtest</span><span class="p">,</span><span class="w"> </span><span class="n">series_air</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">backtest</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7a16da145e944050b22bee4d562e970e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 11.93%
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_145_2.png" src="../_images/quickstart_00-quickstart_145_2.png" />
</div>
</div>
</section>
<section id="Learned-Ensembling">
<h2>Learned Ensembling<a class="headerlink" href="#Learned-Ensembling" title="Permalink to this heading">¶</a></h2>
<p>As expected in this case, the naive ensemble doesn’t give great results (although in some cases it could!)</p>
<p>We can sometimes do better if we see the ensembling as a supervised regression problem: given a set of forecasts (features), find a model that combines them in order to minimise errors on the target. This is what the <code class="docutils literal notranslate"><span class="pre">RegressionEnsembleModel</span></code> does. It accepts parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forecasting_models</span></code> is a list of forecasting models whose predictions we want to ensemble.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regression_train_n_points</span></code> is the number of time steps to use for fitting the “ensemble regression” model (i.e., the inner model that combines the forecasts).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regression_model</span></code> is, optionally, a sklearn-compatible regression model or a Darts <code class="docutils literal notranslate"><span class="pre">SKLearnModel</span></code> to be used for the ensemble regression. If not specified, a linear regression is used. Using a sklearn model is easy out-of-the-box, but using a <code class="docutils literal notranslate"><span class="pre">SKLearnModel</span></code> allows to potentially take arbitrary lags of the individual forecasts as inputs of the regression model.</p></li>
<li><p>and for more, read our this <a class="reference external" href="https://unit8co.github.io/darts/examples/19-EnsembleModel-examples.html">user guide on ensembling models</a>.</p></li>
</ul>
<p>Once these elements are in place, a <code class="docutils literal notranslate"><span class="pre">RegressionEnsembleModel</span></code> can be used like a regular forecasting model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">RegressionEnsembleModel</span>

<span class="n">ensemble_model</span> <span class="o">=</span> <span class="n">RegressionEnsembleModel</span><span class="p">(</span>
    <span class="n">forecasting_models</span><span class="o">=</span><span class="n">models</span><span class="p">,</span> <span class="n">regression_train_n_points</span><span class="o">=</span><span class="mi">12</span>
<span class="p">)</span>

<span class="n">backtest</span> <span class="o">=</span> <span class="n">ensemble_model</span><span class="o">.</span><span class="n">historical_forecasts</span><span class="p">(</span><span class="o">**</span><span class="n">hfc_params</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE = </span><span class="si">{</span><span class="n">mape</span><span class="p">(</span><span class="n">backtest</span><span class="p">,</span><span class="w"> </span><span class="n">series_air</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">series_air</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">backtest</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2fa4d43107ed45e8861ee24244d5c761", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MAPE = 4.77
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_147_2.png" src="../_images/quickstart_00-quickstart_147_2.png" />
</div>
</div>
<p>We can also inspect the coefficients used to weigh the two inner models in the linear combination:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ensemble_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series_air</span><span class="p">)</span>
<span class="n">ensemble_model</span><span class="o">.</span><span class="n">regression_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0.01368814, 1.0980107 ], dtype=float32)
</pre></div></div>
</div>
<p>Ensemble models can also be probabilistic themselves! You can read about it in <a class="reference external" href="https://unit8co.github.io/darts/examples/19-EnsembleModel-examples.html#">our guide on ensembling models</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">RegressionEnsembleModel</span></code> uses the <em>stacking</em> technique to train and combine the <code class="docutils literal notranslate"><span class="pre">forecasting_models</span></code>: each one of them is trained independently and the <code class="docutils literal notranslate"><span class="pre">regression_model</span></code> is then trained using their predictions as <code class="docutils literal notranslate"><span class="pre">future_covariates</span></code>.</p>
</section>
</section>
<section id="Filtering-models">
<h1>Filtering models<a class="headerlink" href="#Filtering-models" title="Permalink to this heading">¶</a></h1>
<p>In addition to <em>forecasting</em> models, which are able to predict future values of series, Darts also contains a couple of helpful <em>filtering</em> models, which can model “in sample” series’ values distributions.</p>
<section id="Fitting-a-Kalman-Filter">
<h2>Fitting a Kalman Filter<a class="headerlink" href="#Fitting-a-Kalman-Filter" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">KalmanFilter</span></code> implements a <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.models.filtering.kalman_filter.html">Kalman Filter</a>. The implementation relies on <a class="reference external" href="https://nfoursid.readthedocs.io/en/latest/source/kalman.html">nfoursid</a>, so it is for instance possible to provide a <code class="docutils literal notranslate"><span class="pre">nfoursid.kalman.Kalman</span></code> object containing a transition matrix, process noise covariance, observation noise covariance etc.</p>
<p>It is also possible to do system identification by calling <code class="docutils literal notranslate"><span class="pre">fit()</span></code> to “train” the Kalman Filter using the N4SID system identification algorithm:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">KalmanFilter</span>

<span class="n">kf</span> <span class="o">=</span> <span class="n">KalmanFilter</span><span class="p">(</span><span class="n">dim_x</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">kf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="p">)</span>
<span class="n">filtered_series</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">train_air_scaled</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">filtered_series</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_153_0.png" src="../_images/quickstart_00-quickstart_153_0.png" />
</div>
</div>
</section>
<section id="Inferring-missing-values-with-Gaussian-Processes">
<h2>Inferring missing values with Gaussian Processes<a class="headerlink" href="#Inferring-missing-values-with-Gaussian-Processes" title="Permalink to this heading">¶</a></h2>
<p>Darts also contains a <code class="docutils literal notranslate"><span class="pre">GaussianProcessFilter</span></code> which can be used for probabilistic modeling of series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.gaussian_process.kernels</span><span class="w"> </span><span class="kn">import</span> <span class="n">RBF</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianProcessFilter</span>

<span class="c1"># create a series with holes:</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">train_air_scaled</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">values</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">values</span><span class="p">[</span><span class="mi">28</span><span class="p">:</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">values</span><span class="p">[</span><span class="mi">55</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">values</span><span class="p">[</span><span class="mi">72</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">series_holes</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">from_times_and_values</span><span class="p">(</span><span class="n">train_air_scaled</span><span class="o">.</span><span class="n">time_index</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="n">series_holes</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">()</span>

<span class="n">gpf</span> <span class="o">=</span> <span class="n">GaussianProcessFilter</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">normalize_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">filtered_series</span> <span class="o">=</span> <span class="n">gpf</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">series_holes</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">filtered_series</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/quickstart_00-quickstart_155_0.png" src="../_images/quickstart_00-quickstart_155_0.png" />
</div>
</div>
</section>
</section>
<section id="A-Word-of-Caution">
<h1>A Word of Caution<a class="headerlink" href="#A-Word-of-Caution" title="Permalink to this heading">¶</a></h1>
<p>So is N-BEATS, exponential smoothing, or a Bayesian ridge regression trained on milk production the best approach for predicting the future number of airline passengers? Well, at this point it’s actually hard to say exactly which one is best. Our time series is small, and our validation set is even smaller. In such cases, it’s very easy to overfit the whole forecasting exercise to such a small validation set. That’s especially true if the number of available models and their degrees of freedom
is high (such as for deep learning models), or if we played with many models on a single test set (as done in this notebook).</p>
<p>As data scientists, it is our responsibility to understand the extent to which our models can be trusted. So always take results with a grain of salt, especially on small datasets, and apply the scientific method before making any kind of forecast :) Happy modeling!</p>
</section>
<section id="Anomaly-Detection">
<h1>Anomaly Detection<a class="headerlink" href="#Anomaly-Detection" title="Permalink to this heading">¶</a></h1>
<p>Darts also has an entire module on Time Series Anomaly Detection. For more info, read our <a class="reference external" href="https://unit8co.github.io/darts/examples/22-anomaly-detection-examples.html">user guide on anomaly detection</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"0061d5e970174e1f8fcb470236367337": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "01e79ddde9764c6b8306c410ff5a3cd5": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "02327fab635140bfa8d886209b22b4fb": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "0304abb0a7904d4b8a9cfa23ee7017b8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_81375dfa20a442339427c8ea75d1d022", "style": "IPY_MODEL_66dd9d78e11e4e6e87d6ada039bde44c", "value": "historical\u2007forecasts:\u2007100%"}}, "04ac842b80f44fadbd869efa32a70991": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "061f5f4dc98d44958a9b16b34ed12d9e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_a463f95309ca44dea4ac3e034569623e", "max": 3, "style": "IPY_MODEL_cd13306973b14c0895d6bab21330bb1a", "value": 3}}, "06d65facbafe432b92305692b60e431a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "072a01292dfe4b1fa4c314b4941cdc9e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "090fa9646bf24af883dfd3e4b8e0053d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "0a021480f77641d898c7b09ae547a2ee": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "0b2099c04cd4443488d6a0e3bcaf6fc4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "0b818000720248fb95af060837d53963": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "0c16aefbfe974e618e9121a9670c4aff": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "0c5ca47c2b35400790fafd87a6d66ead": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "0dc036aa8a5741b8a30fe77f18cd6451": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "0dd89e4232954cabb616535b1be5b0cd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_e815d89687c7448ca987290fa7f21ce0", "max": 20, "style": "IPY_MODEL_5827ffbc6510419cbe712c1c4922f4d2", "value": 20}}, "0f409e49927446d095eb7a5a656cec54": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_624f3c5582df4d2fa7f819b33f96d65b", "style": "IPY_MODEL_b63a60d21d6e4b91abdb87579dafcb9b", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007213.58it/s]"}}, "0f95f6b95da64ec88798eb840f9037e8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_f3f36d8fe1de435084e168febfe4af2b", "style": "IPY_MODEL_8405ee47c9564b398786c136b103b98f", "value": "historical\u2007forecasts:\u2007100%"}}, "11e5186608e24ee69916f66f696017cb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "14adc40441224eed8d3ec599e44decf6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_e8b6b2bc225f47bdb75f60133d29887c", "IPY_MODEL_8a8c5de3380449e4b1eb4b699b2cbcbd", "IPY_MODEL_3acfeabe6f8a4b918727555dc72ab989"], "layout": "IPY_MODEL_a966c107d0254881a5d62b14f1112b3a"}}, "15607b0ac7ab4431831ea3d5a63af66c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "15ea1edfb688405e8edbfcc1c0a04705": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_22e2979242fe4891b03496e799ca2c9b", "style": "IPY_MODEL_b9a304284ffb4dcb9e439abe3f91b161", "value": "Epoch\u200749:\u2007100%"}}, "160bfdc6a11b46f9a0f11610d1bb2d01": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "167e6883cf1b469db5ed5adacf92edba": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "16ce308e80c145219ba41f22b0bfd51a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "17d260833b6840cabf4ec8ac9a77a295": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_06d65facbafe432b92305692b60e431a", "max": 58, "style": "IPY_MODEL_749879293f314f799ac04a08a7a5249d", "value": 58}}, "19e013d7552a46d094f4f9d8aafbf78c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_8f27c72c33bf4ad3b617e42a9785ec2a", "IPY_MODEL_bf9d1b24cf8342ca8c461d7af5c4a57c", "IPY_MODEL_900fbf9b68c342a1b8b54175f917bc54"], "layout": "IPY_MODEL_db00e5e6a0da4a87b47c4401d900a917"}}, "1a65ec75f0184b159e839857423f978c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_c462a4d1a83341d5a94f6df1ee28a1df", "IPY_MODEL_75ed189d8994486eb0f7b9ebac3bc063", "IPY_MODEL_9d409ba35b7d4441960f046ef5b3a2c2"], "layout": "IPY_MODEL_3a46086fe46146e2acfdfb7374d1ab87"}}, "1a7020f8aed94382a9c9ef6c8b27bd5c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_b976232ddf10472a934dc062591c9260", "IPY_MODEL_6e0926e6e8574b78a247581e3a6bc9dd", "IPY_MODEL_2cb6e903a44141d8841750ba0d37f9f3"], "layout": "IPY_MODEL_090fa9646bf24af883dfd3e4b8e0053d"}}, "1b6cfdb89e7e45d785c1d904993d073b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "1bcec89a92754522af71c3e35c1159bf": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "1dbaab64bb14490fb3b0fa86e3f694c6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_59e8e87d1fd648b29747cb40a1b591d7", "style": "IPY_MODEL_e5cc976c3cf74f139b8be15ba6d2b865", "value": "historical\u2007forecasts:\u2007100%"}}, "2003c730f6df41dabefe0688538515f7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "20c409dd4e574247843caf1aebeb4730": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_a8bc3f92dd744356b0b07ff5b65ab3dc", "style": "IPY_MODEL_5c6bb66fe90246dbaa46e02f95974f50", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "226627f1e4164e0382b034052945fb88": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_3ba923a3968c4866b104e327785e80b9", "IPY_MODEL_d79a8b63b1524858aaf63c07c21dee3a", "IPY_MODEL_c66d955c4c0b47cebb6ffa7fa0961d15"], "layout": "IPY_MODEL_9d241a88c39a4f50a9a888349184d5fa"}}, "22e2979242fe4891b03496e799ca2c9b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "232a5cc757ac4962abb403ca0ce912d1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "235d1de5a1074ba0bb29a1e9ef632a5a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "24bdd805b33e4307a8527b0374654229": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "24fb0b81e65a4bc5a45766ba03f49098": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "270fb84f9ff04228ba2919146cbf35ef": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "27d4d11907bf44c3b50ae8a86152235c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "29c9b2fa1f5d43fbb5b920636c33ce8f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "2adce9478dbd420db8a7346aa72ae5ce": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_80526a32883b4f3cb523dea0ddf903da", "style": "IPY_MODEL_e75e2584e88c45b9811971fe36d06b85", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "2afa903f40af4800b69463661b89ab35": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "2c9b2d69d01f4bb282178176e7ae83bd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "2cb6e903a44141d8841750ba0d37f9f3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_c5a0361910d2474b98554d1108919125", "style": "IPY_MODEL_072a01292dfe4b1fa4c314b4941cdc9e", "value": "\u20077/7\u2007[00:00&lt;00:00,\u2007\u20077.63it/s,\u2007train_loss=0.000928]"}}, "2eb6167de5064703812c2675dfd8a492": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "2fa4d43107ed45e8861ee24244d5c761": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_ab8e1774ffc742a2a0d007724c381048", "IPY_MODEL_660c9f214b0f4d26b45b7613d54faf20", "IPY_MODEL_369d27606a76446d807b8a6d8a8de398"], "layout": "IPY_MODEL_35c41af547ce4fb49c72f75e0fc69254"}}, "34fddc863d15476b856a9081c7db037f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_f076db1bf30c4a0899ae1a01119535d7", "style": "IPY_MODEL_70c49e9ecaf74be482b2f94fb794b7c5", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007197.04it/s]"}}, "354ab301f49d4db887a5b3be17ba9acb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "35931612a9314c43ab178450c2fddd83": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_4aeddee4e6334d41b58f1d551486b4ba", "IPY_MODEL_8d4185dec51d445f8ddde4d296f8d78f", "IPY_MODEL_65998ac11cb34e2380930c11ffb30a77"], "layout": "IPY_MODEL_3a366c9f226c49aaac7872f8f4c52152"}}, "35c41af547ce4fb49c72f75e0fc69254": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "368c029bb28f442b9722b68a91038e4b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "369d27606a76446d807b8a6d8a8de398": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_270fb84f9ff04228ba2919146cbf35ef", "style": "IPY_MODEL_d3bad4dfd71346ffb7012f02a8772725", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007137.11it/s]"}}, "383c351d2e2b4897942fba80078e771b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "386878851cf0465784fb0584df42a27a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_85fc0bbb6d29461a8c04104432ca54bc", "style": "IPY_MODEL_efd0d671e1cf49a4b8d878d4355bf7e4", "value": "historical\u2007forecasts:\u2007100%"}}, "3875bbf6e65e44e8927661d09c1ed22e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_3a4a6ce50fb44a3cb83ad3fcacc50476", "style": "IPY_MODEL_7672ce4d50a1472b9e64484b1bbe3084", "value": "\u20071/1\u2007[00:00&lt;00:00,\u200712.68it/s]"}}, "39582f9d5ed64adc9a4c43a268ecb865": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "3a366c9f226c49aaac7872f8f4c52152": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "3a46086fe46146e2acfdfb7374d1ab87": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "3a4a6ce50fb44a3cb83ad3fcacc50476": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "3acfeabe6f8a4b918727555dc72ab989": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_ea91271eeebe4917a5ed3039bebfb517", "style": "IPY_MODEL_458447f34326451b884a9283e723c8ec", "value": "\u20071/1\u2007[00:00&lt;00:00,\u200721.27it/s]"}}, "3b0e80e6c3f04209aaad78e4774ed249": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "3ba923a3968c4866b104e327785e80b9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_8e5b57e84e154c8f845b83275e92a3c2", "style": "IPY_MODEL_5e2158ea721046968e8ca23899d06f90", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "3c0aedb50b294149bb1ba45c97b24862": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "3d8b30bbcecb45ff8dad0cbcfe962a49": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_85adfe5ca5264087a93534fe679cab40", "style": "IPY_MODEL_b20da59b23c548918328a031471ae48d", "value": "historical\u2007forecasts:\u2007100%"}}, "3fc0c9a401c840a9b0f5d1d115248dd7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_672e70f8cb564b899fb916e1c92ad480", "IPY_MODEL_4d39dd4809e24290bb719d55618e0039", "IPY_MODEL_67361ef399bc42d6aede1d972987d280"], "layout": "IPY_MODEL_232a5cc757ac4962abb403ca0ce912d1"}}, "4000bc6954f848f0aac4fb5b39c1ab02": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "40140930bff94b8a8d3e9b7b897b7898": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_87c2e518c78143418f3fb5b60d7c4621", "style": "IPY_MODEL_9c13e014330841dbbab1647ade6ad916", "value": "\u200757/57\u2007[00:00&lt;00:00,\u2007233.79it/s]"}}, "417a3a8d0b834ab8914c76c58fc04a3d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "42f09ee0b9544b21b2af3924f8562c97": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "439d17fe390e4a658a58b5d7c257b017": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "441dc14524f0464bba31e536d5e7f99e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_386878851cf0465784fb0584df42a27a", "IPY_MODEL_595058da29224f6fb839a7a036e633f3", "IPY_MODEL_0f409e49927446d095eb7a5a656cec54"], "layout": "IPY_MODEL_4c8b568fe5dd4fcdbe27ed9f8a3d9709"}}, "458447f34326451b884a9283e723c8ec": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "45b847ad15e64f1ab36cbd6df6c6a1e5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_e1acd79f26074c7f9b5d16d3399ab4da", "style": "IPY_MODEL_1bcec89a92754522af71c3e35c1159bf", "value": "\u20077/7\u2007[00:00&lt;00:00,\u2007\u20077.81it/s,\u2007train_loss=0.00179]"}}, "463ad7d18ba1434a9a46f2e5514060d7": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "49cb7099a2d1431b8d69d95588a9ec72": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_d81aace6fe2a48cc94bcb76b619a2896", "style": "IPY_MODEL_c70a0c9bdf8e48caae6e214b4bacc2a6", "value": "\u200758/58\u2007[00:01&lt;00:00,\u200731.05it/s]"}}, "4a8c6ccd41d1485692813cab6dc7449a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_de89f48b21854eedbb2dc243a55a4577", "style": "IPY_MODEL_5ef56e932045417f95162cc9e6ff8c21", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007194.96it/s]"}}, "4ac5035021164205b14935cc4a8b8cc3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_87527a156e794973b130f8be9e5b4963", "IPY_MODEL_84e07787c45e4a8db131bbe8caebfa2d", "IPY_MODEL_4ba6b851d2d246d1bd5d226c046af8de"], "layout": "IPY_MODEL_0a021480f77641d898c7b09ae547a2ee"}}, "4aeddee4e6334d41b58f1d551486b4ba": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_a889ef13a7c348f28a1f233c1aedad40", "style": "IPY_MODEL_92cb3d6b24254a96afb3287604d21004", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "4ba6b851d2d246d1bd5d226c046af8de": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_5fafbfac515949c1a75ee96bdea1f1fa", "style": "IPY_MODEL_f9be659a6d9744b8b214fedc266ad867", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007194.38it/s]"}}, "4bcc4637bdbd4834830a0769c31770ff": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "4c8b568fe5dd4fcdbe27ed9f8a3d9709": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "4cd74319044445d9847aaf3f12312be5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_7a02e9dbac0a4398bf7eb48c03d83abb", "style": "IPY_MODEL_a505590b7f7b476293ce4053d8d1bea5", "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007171.41it/s]"}}, "4d39dd4809e24290bb719d55618e0039": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_922b731903094a2ebafed50f25830320", "max": 58, "style": "IPY_MODEL_c2356d6688254b3594018260379539f2", "value": 58}}, "4d550d0da3714651a2d8a1ab3b77fd34": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "4dc4a12c3348413cb581a1648833f7ab": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_71f9d52df3034b4c9977a492e0fcd3c8", "IPY_MODEL_061f5f4dc98d44958a9b16b34ed12d9e", "IPY_MODEL_520668ab8e1a4212ba7c3dcd95794b0b"], "layout": "IPY_MODEL_439d17fe390e4a658a58b5d7c257b017"}}, "4ef3ba746c7c422695cc97a6e33138df": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_eaee047be51e4c96989a0a461ad3b0a9", "IPY_MODEL_d7d864a39dd744b5913fd2bc8d6b2f39", "IPY_MODEL_45b847ad15e64f1ab36cbd6df6c6a1e5"], "layout": "IPY_MODEL_578b73f8e53845418bdd9022d0defdca"}}, "520668ab8e1a4212ba7c3dcd95794b0b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_63c7b06d73364da6924a829d3f140f8e", "style": "IPY_MODEL_4d550d0da3714651a2d8a1ab3b77fd34", "value": "\u20073/3\u2007[00:00&lt;00:00,\u2007102.18it/s,\u2007train_loss=0.0563]"}}, "520bd8a6073e4c78a67d3e1efd537e78": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "52d5834612f344a18c382edb5cc44717": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "52d7cd18cc7b4add9a7d30339821f49a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_5e898ab06c2c4e0d8e70c8a1b34da383", "style": "IPY_MODEL_69cebdb64f174768b92cba9d9fa1ab7b", "value": "\u20077/7\u2007[00:00&lt;00:00,\u2007\u20077.67it/s,\u2007train_loss=0.00264]"}}, "544a73e968b64bd1b2e5e636c2580517": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "55dd72c2d708488997439aa7fd11ce3b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_cdce19e64968422daf8bedbb9aa8079a", "IPY_MODEL_5ce2e13a95ff46bf85c6cbad8bb33ee5", "IPY_MODEL_4cd74319044445d9847aaf3f12312be5"], "layout": "IPY_MODEL_2eb6167de5064703812c2675dfd8a492"}}, "560384e469fb496e8b276f246113430a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "578b73f8e53845418bdd9022d0defdca": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "5827ffbc6510419cbe712c1c4922f4d2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "595058da29224f6fb839a7a036e633f3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_167e6883cf1b469db5ed5adacf92edba", "max": 58, "style": "IPY_MODEL_354ab301f49d4db887a5b3be17ba9acb", "value": 58}}, "59c099b1e9334fda836aaf669d5c6d25": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "59e8e87d1fd648b29747cb40a1b591d7": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "5b2657cb3b8e438fb1a7adfa8a157439": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_935ca8a55b1846e09a39090693ae83c2", "IPY_MODEL_17d260833b6840cabf4ec8ac9a77a295", "IPY_MODEL_eeb59393134e4197849dca8ff0b345d1"], "layout": "IPY_MODEL_a829880efaf144bda39f8012423701f4"}}, "5c6bb66fe90246dbaa46e02f95974f50": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "5ce2e13a95ff46bf85c6cbad8bb33ee5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_ff411f16382342bfa8451f24f56d8901", "max": 1, "style": "IPY_MODEL_aa5df0775d954de58a6c1e4de601c512", "value": 1}}, "5cffdb4955e749bbb4d40c804ed2204a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "5ddc51e8590c467a978fda811f9ba1e3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "5e2158ea721046968e8ca23899d06f90": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "5e898ab06c2c4e0d8e70c8a1b34da383": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "5ef56e932045417f95162cc9e6ff8c21": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "5fafbfac515949c1a75ee96bdea1f1fa": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "61c79779c5364a91bf61030a20e0aa90": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_6229134a8b894116973580e87d7f436e", "style": "IPY_MODEL_11e5186608e24ee69916f66f696017cb", "value": "\u20071/1\u2007[00:00&lt;00:00,\u200719.90it/s]"}}, "6214cd8a03bf48c88adb7a100ba9480d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_81aed886e7774dacbf321d1f69e15d13", "max": 1, "style": "IPY_MODEL_15607b0ac7ab4431831ea3d5a63af66c", "value": 1}}, "6229134a8b894116973580e87d7f436e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "624f3c5582df4d2fa7f819b33f96d65b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "63c7b06d73364da6924a829d3f140f8e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "64cee5bf0c01475794e0ee0d5dd53ef1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_2adce9478dbd420db8a7346aa72ae5ce", "IPY_MODEL_6214cd8a03bf48c88adb7a100ba9480d", "IPY_MODEL_3875bbf6e65e44e8927661d09c1ed22e"], "layout": "IPY_MODEL_24bdd805b33e4307a8527b0374654229"}}, "65998ac11cb34e2380930c11ffb30a77": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_8ad9a91db97a4fc79b2ccbab1f9c1b0f", "style": "IPY_MODEL_917a656b92d04e41a15d88c63bb77b19", "value": "\u20071/1\u2007[00:00&lt;00:00,\u200712.61it/s]"}}, "660c9f214b0f4d26b45b7613d54faf20": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_02327fab635140bfa8d886209b22b4fb", "max": 58, "style": "IPY_MODEL_842468c8db8d48eda4a2abb72df10bb9", "value": 58}}, "663d8240b7b1491e86b7fe10c623bc62": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "66a795239dee494e976c17b620d67e4c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_0f95f6b95da64ec88798eb840f9037e8", "IPY_MODEL_0dd89e4232954cabb616535b1be5b0cd", "IPY_MODEL_a0be6e01ec6f4c6fa60efae80839e914"], "layout": "IPY_MODEL_4bcc4637bdbd4834830a0769c31770ff"}}, "66dd9d78e11e4e6e87d6ada039bde44c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "672e70f8cb564b899fb916e1c92ad480": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_29c9b2fa1f5d43fbb5b920636c33ce8f", "style": "IPY_MODEL_c11ed5c0426147b28c007b589308c0d2", "value": "historical\u2007forecasts:\u2007100%"}}, "67361ef399bc42d6aede1d972987d280": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_27d4d11907bf44c3b50ae8a86152235c", "style": "IPY_MODEL_0b2099c04cd4443488d6a0e3bcaf6fc4", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007114.27it/s]"}}, "69a53ec5dfac45b3b661a01c46ec389b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "69cebdb64f174768b92cba9d9fa1ab7b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "6be6ddf1dd1041178f9a8840cbb56fd0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "6ce4185ff9b546e4b87fd2b7353db041": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "6e0926e6e8574b78a247581e3a6bc9dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_de76ea110cdd4451b2536b6890e85352", "max": 7, "style": "IPY_MODEL_560384e469fb496e8b276f246113430a", "value": 7}}, "70c49e9ecaf74be482b2f94fb794b7c5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "71f9d52df3034b4c9977a492e0fcd3c8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_8cde5e68bb5f4362a57c22aa9a2a961a", "style": "IPY_MODEL_3b0e80e6c3f04209aaad78e4774ed249", "value": "Epoch\u2007399:\u2007100%"}}, "721c32d641564b34b3f96195d601cd1b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "72bc45cf8398419ca3a12ed6f367f36c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "72d185425dd84816b2e9038ab3bbf3b9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "72e706a2aad14bb2af49eee728bd2123": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_16ce308e80c145219ba41f22b0bfd51a", "style": "IPY_MODEL_2c9b2d69d01f4bb282178176e7ae83bd", "value": "\u200757/57\u2007[00:00&lt;00:00,\u2007321.96it/s]"}}, "748e56975b16434183cc1855586e9b5e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "749879293f314f799ac04a08a7a5249d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "74d90974df294649ba02085481c15c33": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "74f586ceecd741309929b7ccc2de332f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "753148a2adb846feb13daf6aa15aa03a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "75b30595ae0b4ad1a12e2ed81ca8f56b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "75ed189d8994486eb0f7b9ebac3bc063": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_0dc036aa8a5741b8a30fe77f18cd6451", "max": 3, "style": "IPY_MODEL_bb7c9614c3f64fae8e183e511b1df0b1", "value": 3}}, "7672ce4d50a1472b9e64484b1bbe3084": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "77a3e1bc1e7d47a8ac3345198997bf61": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "7847367ba0d947d09d0e29d4c8eaf550": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "7a02e9dbac0a4398bf7eb48c03d83abb": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "7a16da145e944050b22bee4d562e970e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_1dbaab64bb14490fb3b0fa86e3f694c6", "IPY_MODEL_bad357dfb1af4b73b5a28d9d50a7af37", "IPY_MODEL_4a8c6ccd41d1485692813cab6dc7449a"], "layout": "IPY_MODEL_80c289145b0742cd8befe5d9bfb8722c"}}, "7b4bc2e9241d4f4ead69dbddf609e3d8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "7ba39321516d4e8e88abf75657a22ba1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "7d665e3655d24f55b9418d10d7ea2518": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "7da797e8115943d697255b6fdb27349f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "7f957eca4f8d430f94ecf31f203ad844": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "80526a32883b4f3cb523dea0ddf903da": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "80c289145b0742cd8befe5d9bfb8722c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "81375dfa20a442339427c8ea75d1d022": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "815dc47ae4284acd903fc43af575d80b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "81aed886e7774dacbf321d1f69e15d13": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "831bf56fae314d3b8f85fc7f929f025d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_77a3e1bc1e7d47a8ac3345198997bf61", "max": 57, "style": "IPY_MODEL_c3f904f23715463f9b831e0ddfeaac74", "value": 57}}, "8405ee47c9564b398786c136b103b98f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "842468c8db8d48eda4a2abb72df10bb9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "84e07787c45e4a8db131bbe8caebfa2d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_383c351d2e2b4897942fba80078e771b", "max": 58, "style": "IPY_MODEL_1b6cfdb89e7e45d785c1d904993d073b", "value": 58}}, "857857d6c9074b169a065d236973342c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "85adfe5ca5264087a93534fe679cab40": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "85fc0bbb6d29461a8c04104432ca54bc": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "8608493e387548ea8bc94eb84675d29c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_59c099b1e9334fda836aaf669d5c6d25", "max": 1, "style": "IPY_MODEL_74f586ceecd741309929b7ccc2de332f", "value": 1}}, "871d4eee94034fc8a68b311bf356d031": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "873d7e075d5747b09b79ad9b26e4afb4": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "87527a156e794973b130f8be9e5b4963": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_69a53ec5dfac45b3b661a01c46ec389b", "style": "IPY_MODEL_f55f58fab197446b87bbf368ff7c0a91", "value": "historical\u2007forecasts:\u2007100%"}}, "87c2e518c78143418f3fb5b60d7c4621": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "88aa07c5282a4b29a769e62a51697961": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_e91bb0bd1ec64e06915e4386a4223c62", "max": 57, "style": "IPY_MODEL_90088f336af0408e924394dae0496abb", "value": 57}}, "89aad5d49a1045f1bba0237f7fe47eb3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_15ea1edfb688405e8edbfcc1c0a04705", "IPY_MODEL_a472b309f7284ff286101a253144ee6a", "IPY_MODEL_52d7cd18cc7b4add9a7d30339821f49a"], "layout": "IPY_MODEL_42f09ee0b9544b21b2af3924f8562c97"}}, "89eb5f920df34caab2b44d4b8df6f703": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "8a4c4e63b64f40edbabd944e6080f0b8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "8a55854680e8415abd7b794ff3c15ad7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "8a8c5de3380449e4b1eb4b699b2cbcbd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_ee91906e3b4640c697a25e982661160f", "max": 1, "style": "IPY_MODEL_bfd58b95542c4bc29bfcd383c7a61bee", "value": 1}}, "8ad9a91db97a4fc79b2ccbab1f9c1b0f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "8afb594eef434fb6979dea729079d942": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_c3330ebe0bd743c4b1da2bad314215c0", "style": "IPY_MODEL_721c32d641564b34b3f96195d601cd1b", "value": "\u20071/1\u2007[00:00&lt;00:00,\u2007\u20073.28it/s]"}}, "8cde5e68bb5f4362a57c22aa9a2a961a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "8d4185dec51d445f8ddde4d296f8d78f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_663d8240b7b1491e86b7fe10c623bc62", "max": 1, "style": "IPY_MODEL_fa23ea19511b40bbad73c136fb1942ef", "value": 1}}, "8e5b57e84e154c8f845b83275e92a3c2": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "8ea826a5e36c4efeb062d2a4ccca4661": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_b7ebc89610fa47e3a268204ae42ca8d7", "IPY_MODEL_831bf56fae314d3b8f85fc7f929f025d", "IPY_MODEL_40140930bff94b8a8d3e9b7b897b7898"], "layout": "IPY_MODEL_01e79ddde9764c6b8306c410ff5a3cd5"}}, "8ebdee3c802b48d484b77b681e359929": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "8f2404be93ff4d598587d4bf5889ad8b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_873d7e075d5747b09b79ad9b26e4afb4", "max": 58, "style": "IPY_MODEL_2003c730f6df41dabefe0688538515f7", "value": 58}}, "8f27c72c33bf4ad3b617e42a9785ec2a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_368c029bb28f442b9722b68a91038e4b", "style": "IPY_MODEL_5cffdb4955e749bbb4d40c804ed2204a", "value": "Epoch\u2007399:\u2007100%"}}, "90088f336af0408e924394dae0496abb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "900fbf9b68c342a1b8b54175f917bc54": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_bbbae6141c9f4a5487458595187c042f", "style": "IPY_MODEL_8a55854680e8415abd7b794ff3c15ad7", "value": "\u20073/3\u2007[00:00&lt;00:00,\u2007167.12it/s,\u2007train_loss=-1.38]"}}, "9159e548025f44a7a21a7c23935c8b2f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "917a656b92d04e41a15d88c63bb77b19": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "91abb45a801541128f8a7f93925dee88": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "922b731903094a2ebafed50f25830320": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "92cb3d6b24254a96afb3287604d21004": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "933955434d7b4b3b942d78e5c6e913c1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "935ca8a55b1846e09a39090693ae83c2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_d0f1ad75960d4be9bbdfe76f57f7b918", "style": "IPY_MODEL_0b818000720248fb95af060837d53963", "value": "historical\u2007forecasts:\u2007100%"}}, "96baa52d87924e6f8528a51e6229c1c7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_dacebc4c69ca4b25aaa7591a3030450f", "IPY_MODEL_8608493e387548ea8bc94eb84675d29c", "IPY_MODEL_8afb594eef434fb6979dea729079d942"], "layout": "IPY_MODEL_39582f9d5ed64adc9a4c43a268ecb865"}}, "9c13e014330841dbbab1647ade6ad916": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "9d241a88c39a4f50a9a888349184d5fa": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "9d409ba35b7d4441960f046ef5b3a2c2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_5ddc51e8590c467a978fda811f9ba1e3", "style": "IPY_MODEL_815dc47ae4284acd903fc43af575d80b", "value": "\u20073/3\u2007[00:00&lt;00:00,\u2007188.73it/s,\u2007train_loss=-1.71]"}}, "9d644b8896fc4217b84a82c33ff72775": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "a0be6e01ec6f4c6fa60efae80839e914": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_b264dde0b2a04e5f8909a5a0728e46f8", "style": "IPY_MODEL_7b4bc2e9241d4f4ead69dbddf609e3d8", "value": "\u200720/20\u2007[00:00&lt;00:00,\u200797.92it/s]"}}, "a33c823cf4aa45aeb16f8362de8a70a8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "a463f95309ca44dea4ac3e034569623e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "a472b309f7284ff286101a253144ee6a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_544a73e968b64bd1b2e5e636c2580517", "max": 7, "style": "IPY_MODEL_e59509c1bf5143f8b034c323a5b838c1", "value": 7}}, "a505590b7f7b476293ce4053d8d1bea5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "a7584ba9c6ed4bb884ddbe5ce77a6b35": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "a829880efaf144bda39f8012423701f4": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "a889ef13a7c348f28a1f233c1aedad40": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "a8bc3f92dd744356b0b07ff5b65ab3dc": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "a966c107d0254881a5d62b14f1112b3a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "aa5df0775d954de58a6c1e4de601c512": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "ab8e1774ffc742a2a0d007724c381048": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_75b30595ae0b4ad1a12e2ed81ca8f56b", "style": "IPY_MODEL_72bc45cf8398419ca3a12ed6f367f36c", "value": "historical\u2007forecasts:\u2007100%"}}, "af7489a0bef24c64a796fc6c09454c0c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_520bd8a6073e4c78a67d3e1efd537e78", "max": 58, "style": "IPY_MODEL_7d665e3655d24f55b9418d10d7ea2518", "value": 58}}, "b20da59b23c548918328a031471ae48d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "b264dde0b2a04e5f8909a5a0728e46f8": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "b63a60d21d6e4b91abdb87579dafcb9b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "b6ad6f2851ac49e1a4943e3e9c5c9c99": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_4000bc6954f848f0aac4fb5b39c1ab02", "max": 120, "style": "IPY_MODEL_52d5834612f344a18c382edb5cc44717", "value": 120}}, "b7ebc89610fa47e3a268204ae42ca8d7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_871d4eee94034fc8a68b311bf356d031", "style": "IPY_MODEL_2afa903f40af4800b69463661b89ab35", "value": "historical\u2007forecasts:\u2007100%"}}, "b976232ddf10472a934dc062591c9260": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_eff31acc587145538449008bcb528a18", "style": "IPY_MODEL_c471dd55f7b448dcb671956119c3f05c", "value": "Epoch\u200749:\u2007100%"}}, "b9a304284ffb4dcb9e439abe3f91b161": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "bad357dfb1af4b73b5a28d9d50a7af37": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_f86d59297b724fcb9809a201f1d8f93c", "max": 58, "style": "IPY_MODEL_0c5ca47c2b35400790fafd87a6d66ead", "value": 58}}, "bb7c9614c3f64fae8e183e511b1df0b1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "bbbae6141c9f4a5487458595187c042f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "bbdc29b324ea4cbb97e922ff64f843d6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_a33c823cf4aa45aeb16f8362de8a70a8", "style": "IPY_MODEL_753148a2adb846feb13daf6aa15aa03a", "value": "\u2007120/120\u2007[00:03&lt;00:00,\u200731.33it/s]"}}, "bf9d1b24cf8342ca8c461d7af5c4a57c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_7ba39321516d4e8e88abf75657a22ba1", "max": 3, "style": "IPY_MODEL_04ac842b80f44fadbd869efa32a70991", "value": 3}}, "bfd58b95542c4bc29bfcd383c7a61bee": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "bff7aa0828374bdc9c0e16162d04a196": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "c09a743106a04ef1bc190962e3811b8f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_235d1de5a1074ba0bb29a1e9ef632a5a", "max": 58, "style": "IPY_MODEL_c22cd78380654c7895866f8289152b99", "value": 58}}, "c11ed5c0426147b28c007b589308c0d2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "c22cd78380654c7895866f8289152b99": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "c2356d6688254b3594018260379539f2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "c29691ff75674e14b5846d8b1eedf484": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "c3330ebe0bd743c4b1da2bad314215c0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "c3f904f23715463f9b831e0ddfeaac74": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "c462a4d1a83341d5a94f6df1ee28a1df": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_463ad7d18ba1434a9a46f2e5514060d7", "style": "IPY_MODEL_8a4c4e63b64f40edbabd944e6080f0b8", "value": "Epoch\u2007399:\u2007100%"}}, "c471dd55f7b448dcb671956119c3f05c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "c5a0361910d2474b98554d1108919125": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "c66d955c4c0b47cebb6ffa7fa0961d15": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_e6d027df0da640c784dbb988b803ad19", "style": "IPY_MODEL_cc5e6b95fda64b0593f52447b8e7bea2", "value": "\u20071/1\u2007[00:00&lt;00:00,\u200716.92it/s]"}}, "c70a0c9bdf8e48caae6e214b4bacc2a6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "c78c411fe311455a9f6aa5cc58b50fa6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_e52302d27f5348daad1d3acead49e383", "IPY_MODEL_af7489a0bef24c64a796fc6c09454c0c", "IPY_MODEL_34fddc863d15476b856a9081c7db037f"], "layout": "IPY_MODEL_a7584ba9c6ed4bb884ddbe5ce77a6b35"}}, "cacc98e617314948b328f3670dc48a8d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "cc5e6b95fda64b0593f52447b8e7bea2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "cd13306973b14c0895d6bab21330bb1a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "cdce19e64968422daf8bedbb9aa8079a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_748e56975b16434183cc1855586e9b5e", "style": "IPY_MODEL_72d185425dd84816b2e9038ab3bbf3b9", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "cee8f39a41324c8484a27f1b7d128aae": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_3d8b30bbcecb45ff8dad0cbcfe962a49", "IPY_MODEL_88aa07c5282a4b29a769e62a51697961", "IPY_MODEL_72e706a2aad14bb2af49eee728bd2123"], "layout": "IPY_MODEL_160bfdc6a11b46f9a0f11610d1bb2d01"}}, "d0f1ad75960d4be9bbdfe76f57f7b918": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "d34ce34508f64e84b2decf896ca0ef5d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "d3bad4dfd71346ffb7012f02a8772725": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "d51e0ce82c6849a5ab8e7dda063eb6f4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_efa33e2590d94b87b4eb2474a4de866a", "IPY_MODEL_c09a743106a04ef1bc190962e3811b8f", "IPY_MODEL_f6f628539f8f45f9889cef6bc2dbac21"], "layout": "IPY_MODEL_6be6ddf1dd1041178f9a8840cbb56fd0"}}, "d79a8b63b1524858aaf63c07c21dee3a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_9d644b8896fc4217b84a82c33ff72775", "max": 1, "style": "IPY_MODEL_0c16aefbfe974e618e9121a9670c4aff", "value": 1}}, "d7d864a39dd744b5913fd2bc8d6b2f39": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_417a3a8d0b834ab8914c76c58fc04a3d", "max": 7, "style": "IPY_MODEL_cacc98e617314948b328f3670dc48a8d", "value": 7}}, "d81aace6fe2a48cc94bcb76b619a2896": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "d8ad8496b4ac4410a320ed804ff75245": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_74d90974df294649ba02085481c15c33", "style": "IPY_MODEL_0061d5e970174e1f8fcb470236367337", "value": "historical\u2007forecasts:\u2007100%"}}, "dacebc4c69ca4b25aaa7591a3030450f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_df57e30fef144930ba5d04bd7980716f", "style": "IPY_MODEL_89eb5f920df34caab2b44d4b8df6f703", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "db00e5e6a0da4a87b47c4401d900a917": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "dd5357fd07ee407ba6e8372053df411c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"bar_style": "success", "layout": "IPY_MODEL_24fb0b81e65a4bc5a45766ba03f49098", "max": 1, "style": "IPY_MODEL_7da797e8115943d697255b6fdb27349f", "value": 1}}, "de76ea110cdd4451b2536b6890e85352": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "de89f48b21854eedbb2dc243a55a4577": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "df4f1ae520434611a1c8758f020de302": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "df57e30fef144930ba5d04bd7980716f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e1acd79f26074c7f9b5d16d3399ab4da": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e459258de0124bbb99e91a0e423edec3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e47e88ad7daf45e5968b1f52f5a1f261": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_20c409dd4e574247843caf1aebeb4730", "IPY_MODEL_dd5357fd07ee407ba6e8372053df411c", "IPY_MODEL_61c79779c5364a91bf61030a20e0aa90"], "layout": "IPY_MODEL_f07833b8bdd649b6badd8a45fb2bc723"}}, "e52302d27f5348daad1d3acead49e383": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_3c0aedb50b294149bb1ba45c97b24862", "style": "IPY_MODEL_df4f1ae520434611a1c8758f020de302", "value": "historical\u2007forecasts:\u2007100%"}}, "e59509c1bf5143f8b034c323a5b838c1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "e5bd892913f7438a8dd6c02524739933": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_d8ad8496b4ac4410a320ed804ff75245", "IPY_MODEL_8f2404be93ff4d598587d4bf5889ad8b", "IPY_MODEL_49cb7099a2d1431b8d69d95588a9ec72"], "layout": "IPY_MODEL_7847367ba0d947d09d0e29d4c8eaf550"}}, "e5cc976c3cf74f139b8be15ba6d2b865": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "e6d027df0da640c784dbb988b803ad19": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e75e2584e88c45b9811971fe36d06b85": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "e815d89687c7448ca987290fa7f21ce0": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e8b6b2bc225f47bdb75f60133d29887c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_9159e548025f44a7a21a7c23935c8b2f", "style": "IPY_MODEL_d34ce34508f64e84b2decf896ca0ef5d", "value": "Predicting\u2007DataLoader\u20070:\u2007100%"}}, "e91bb0bd1ec64e06915e4386a4223c62": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "ea91271eeebe4917a5ed3039bebfb517": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "eaee047be51e4c96989a0a461ad3b0a9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_857857d6c9074b169a065d236973342c", "style": "IPY_MODEL_7f957eca4f8d430f94ecf31f203ad844", "value": "Epoch\u200749:\u2007100%"}}, "ee91906e3b4640c697a25e982661160f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}, "eeb59393134e4197849dca8ff0b345d1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_c29691ff75674e14b5846d8b1eedf484", "style": "IPY_MODEL_bff7aa0828374bdc9c0e16162d04a196", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007202.54it/s]"}}, "efa33e2590d94b87b4eb2474a4de866a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_e459258de0124bbb99e91a0e423edec3", "style": "IPY_MODEL_8ebdee3c802b48d484b77b681e359929", "value": "historical\u2007forecasts:\u2007100%"}}, "efd0d671e1cf49a4b8d878d4355bf7e4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "eff31acc587145538449008bcb528a18": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f076db1bf30c4a0899ae1a01119535d7": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f07833b8bdd649b6badd8a45fb2bc723": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"display": "inline-flex", "flex_flow": "row wrap", "width": "100%"}}, "f3d93fe561d1403cbfc2f4fb28c9718a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"children": ["IPY_MODEL_0304abb0a7904d4b8a9cfa23ee7017b8", "IPY_MODEL_b6ad6f2851ac49e1a4943e3e9c5c9c99", "IPY_MODEL_bbdc29b324ea4cbb97e922ff64f843d6"], "layout": "IPY_MODEL_933955434d7b4b3b942d78e5c6e913c1"}}, "f3f36d8fe1de435084e168febfe4af2b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f55f58fab197446b87bbf368ff7c0a91": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "f6f628539f8f45f9889cef6bc2dbac21": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"layout": "IPY_MODEL_91abb45a801541128f8a7f93925dee88", "style": "IPY_MODEL_6ce4185ff9b546e4b87fd2b7353db041", "value": "\u200758/58\u2007[00:00&lt;00:00,\u2007210.78it/s]"}}, "f86d59297b724fcb9809a201f1d8f93c": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f9be659a6d9744b8b214fedc266ad867": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"description_width": "", "font_size": null, "text_color": null}}, "fa23ea19511b40bbad73c136fb1942ef": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"description_width": ""}}, "ff411f16382342bfa8451f24f56d8901": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"flex": "2"}}}, "version_major": 2, "version_minor": 0}
</script></section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../README.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Time Series Made Easy in Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../userguide.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2025, Unit8 SA (Apache 2.0 License).<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>