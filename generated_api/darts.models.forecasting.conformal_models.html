
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Conformal Models &#8212; darts  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="shortcut icon" href="../_static/docs-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="D-Linear" href="darts.models.forecasting.dlinear.html" />
    <link rel="prev" title="CatBoost Models" href="darts.models.forecasting.catboost_model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/darts-logo-trim.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../README.html">
  Home
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart/00-quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../userguide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="darts.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../release_notes/RELEASE_NOTES.html">
  Release Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/unit8co/darts" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/unit8co" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.ad.html">
   Anomaly Detection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.aggregators.html">
     Anomaly Aggregators
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.and_aggregator.html">
       AND Aggregator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.ensemble_sklearn_aggregator.html">
       Ensemble scikit-learn aggregator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.or_aggregator.html">
       OR Aggregator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.anomaly_model.html">
     Anomaly Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.anomaly_model.filtering_am.html">
       Filtering Anomaly Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.anomaly_model.forecasting_am.html">
       Forecasting Anomaly Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.detectors.html">
     Anomaly Detectors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.iqr_detector.html">
       Interquartile Range (IQR) Detector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.quantile_detector.html">
       Quantile Detector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.threshold_detector.html">
       Threshold Detector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.scorers.html">
     Anomaly Scorers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.difference_scorer.html">
       Difference Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.kmeans_scorer.html">
       k-means Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_cauchy_scorer.html">
       NLL Cauchy Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_exponential_scorer.html">
       NLL Exponential Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_gamma_scorer.html">
       NLL Gamma Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_gaussian_scorer.html">
       NLL Gaussian Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_laplace_scorer.html">
       NLL Laplace Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_poisson_scorer.html">
       NLL Poisson Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.norm_scorer.html">
       Norm Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.pyod_scorer.html">
       PyOD Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.wasserstein_scorer.html">
       Wasserstein Scorer
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.ad.utils.html">
     Utils for Anomaly Detection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.dataprocessing.html">
   Data Processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.dtw.html">
     Dynamic Time Warping (DTW)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.dtw.dtw.html">
       Dynamic Time Warping (DTW)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.dtw.window.html">
       DTW Windows
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.encoders.html">
     Time Axis Encoders
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.encoders.encoder_base.html">
       Encoder Base Classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.encoders.encoders.html">
       Time Axes Encoders
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.transformers.html">
     Data Transformers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html">
       Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.boxcox.html">
       Box-Cox Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.diff.html">
       Differencing Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.fittable_data_transformer.html">
       Fittable Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.invertible_data_transformer.html">
       Invertible Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.mappers.html">
       Mapper and InvertibleMapper
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.midas.html">
       Mixed-data sampling (MIDAS) Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.missing_values_filler.html">
       Missing Values Filler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.reconciliation.html">
       Hierarchical Reconciliation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.scaler.html">
       Scaler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.static_covariates_transformer.html">
       Static Covariates Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.window_transformer.html">
       Window Transformer
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.dataprocessing.pipeline.html">
     Pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.datasets.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.explainability.html">
   Explainability
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.explainability.explainability_result.html">
     Explainability Result
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.explainability.shap_explainer.html">
     Shap Explainer for SKLearnModels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.explainability.tft_explainer.html">
     TFT Explainer for Temporal Fusion Transformer (TFTModel)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.metrics.html">
   Metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.metrics.metrics.html">
     Metrics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="darts.models.html">
   Models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.models.filtering.html">
     Filtering Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.gaussian_process_filter.html">
       Gaussian Processes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.kalman_filter.html">
       Kalman Filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.moving_average_filter.html">
       Moving Average
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="darts.models.forecasting.html">
     Forecasting Models
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.arima.html">
       ARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.baselines.html">
       Baseline Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.block_rnn_model.html">
       Block Recurrent Neural Networks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.catboost_model.html">
       CatBoost Models
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Conformal Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.dlinear.html">
       D-Linear
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.exponential_smoothing.html">
       Exponential Smoothing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.fft.html">
       Fast Fourier Transform
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.global_baseline_models.html">
       Global Baseline Models (Naive)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.kalman_forecaster.html">
       Kalman Filter Forecaster
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.lgbm.html">
       LightGBM Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.linear_regression_model.html">
       Linear Regression Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nbeats.html">
       N-BEATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nhits.html">
       N-HiTS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nlinear.html">
       N-Linear
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.prophet_model.html">
       Facebook Prophet
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.random_forest.html">
       Random Forest
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.regression_ensemble_model.html">
       Regression Ensemble Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.rnn_model.html">
       Recurrent Neural Networks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_arima.html">
       AutoARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_ces.html">
       AutoCES
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_ets.html">
       AutoETS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_mfles.html">
       AutoMFLES
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_tbats.html">
       AutoTBATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_theta.html">
       AutoTheta
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_croston.html">
       Croston Method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_model.html">
       StatsForecastModel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_tbats.html">
       TBATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sklearn_model.html">
       SKLearn-Like Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tcn_model.html">
       Temporal Convolutional Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tft_model.html">
       Temporal Fusion Transformer (TFT)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.theta.html">
       Theta Method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tide_model.html">
       Time-series Dense Encoder (TiDE)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.transformer_model.html">
       Transformer Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tsmixer_model.html">
       Time-Series Mixer (TSMixer)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.varima.html">
       VARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.xgboost.html">
       XGBoost Models
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.utils.html">
   Utils
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.utils.data.html">
     TimeSeries Datasets
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.dataset.html">
       Dataset Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.inference_dataset.html">
       Inference Datasets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.training_dataset.html">
       Training Datasets
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.utils.likelihood_models.html">
     Likelihood Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.sklearn.html">
       Likelihoods for
       <cite>
        SKLearnModel
       </cite>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.statsforecast.html">
       Likelihoods for
       <cite>
        StatsForecast
       </cite>
       Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.torch.html">
       Likelihoods for
       <cite>
        TorchForecastingModel
       </cite>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.losses.html">
     PyTorch Loss Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.missing_values.html">
     Utils for filling missing values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.model_selection.html">
     Model selection utilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.statistics.html">
     Time Series Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.timeseries_generation.html">
     Utils for time series generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.torch.html">
     Utils for Pytorch and its usage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.ts_utils.html">
     Additional util functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.utils.html">
     Additional util functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="darts.timeseries.html">
   Timeseries
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <span class="target" id="module-darts.models.forecasting.conformal_models"></span><section id="conformal-models">
<h1>Conformal Models<a class="headerlink" href="#conformal-models" title="Permalink to this heading">¶</a></h1>
<p>A collection of conformal prediction models for pre-trained global forecasting models.</p>
<dl class="py class">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">darts.models.forecasting.conformal_models.</span></span><span class="sig-name descname"><span class="pre">ConformalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalForecastingModel</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base Conformal Prediction Model.</p>
<p>Base class for any conformal prediction model. A conformal model calibrates the predictions from any
pre-trained global forecasting model. It does not have to be trained, and can generate calibrated forecasts
directly using the underlying trained forecasting model. Since it is a probabilistic model, you can generate
forecasts in two ways (when calling <cite>predict()</cite>, <cite>historical_forecasts()</cite>, …):</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Conformal models can be applied to any of Darts’ global forecasting model, as long as the model has been
fitted before. In general the workflow of the models to produce one calibrated forecast/prediction is as
follows:</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation with
parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since the
calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts on the calibration set (using the forecasting model) with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (specific to each conformal model) on these historical forecasts</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, add calibrated intervals to (or adjust the
existing intervals of) the forecasting model’s predictions.</p></li>
</ul>
<p>Some notes:</p>
<ul class="simple">
<li><p>When computing <cite>historical_forecasts()</cite>, <cite>backtest()</cite>, <cite>residuals()</cite>, … the above is applied for each
forecast (the forecasting model’s historical forecasts are only generated once for efficiency).</p></li>
<li><p>For multi-horizon forecasts, the above is applied for each step in the horizon separately.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalForecastingModel</span></code>) – A pre-trained global forecasting model. See the list of models
<a class="reference external" href="https://unit8co.github.io/darts/#forecasting-models">here</a>.</p></li>
<li><p><strong>quantiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A list of quantiles centered around the median <cite>q=0.5</cite> to use. For example quantiles
[0.1, 0.2, 0.5, 0.8 0.9] correspond to two intervals with (0.9 - 0.1) = 80%, and (0.8 - 0.2) 60% coverage
around the median (model forecast).</p></li>
<li><p><strong>symmetric</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use symmetric non-conformity scores. If <cite>False</cite>, uses asymmetric scores (individual scores
for lower- and upper quantile interval bounds).</p></li>
<li><p><strong>cal_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number of past forecast errors / non-conformity scores to use as calibration for each conformal
forecast (and each step in the horizon). If <cite>None</cite>, considers all scores.</p></li>
<li><p><strong>cal_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The stride to apply when computing the historical forecasts and non-conformity scores on the calibration
set. The actual conformal forecasts can have a different stride given with parameter <cite>stride</cite> in downstream
tasks (e.g. historical forecasts, backtest, …)</p></li>
<li><p><strong>cal_num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of samples to generate for each calibration forecast (if <cite>model</cite> is a probabilistic forecasting
model). The non-conformity scores are computed on the quantile values of these forecasts (using quantiles
<cite>quantiles</cite>). Uses <cite>1</cite> for deterministic models. The actual conformal forecasts can have a different number
of samples given with parameter <cite>num_samples</cite> in downstream tasks (e.g. predict, historical forecasts, …).</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness for reproducible forecasting.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.considers_static_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.considers_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">considers_static_covariates</span></code></a></p></td>
<td><p>Whether the model considers static covariates, if there are any.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.extreme_lags" title="darts.models.forecasting.conformal_models.ConformalModel.extreme_lags"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extreme_lags</span></code></a></p></td>
<td><p>A 8-tuple containing in order: (min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate lag, max future covariate lag, output shift, max target lag train (only for RNNModel)).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.likelihood" title="darts.models.forecasting.conformal_models.ConformalModel.likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">likelihood</span></code></a></p></td>
<td><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.min_train_samples" title="darts.models.forecasting.conformal_models.ConformalModel.min_train_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">min_train_samples</span></code></a></p></td>
<td><p>The minimum number of samples for training the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.output_chunk_length" title="darts.models.forecasting.conformal_models.ConformalModel.output_chunk_length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_length</span></code></a></p></td>
<td><p>Number of time steps predicted at once by the model, not defined for statistical models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.output_chunk_shift" title="darts.models.forecasting.conformal_models.ConformalModel.output_chunk_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_shift</span></code></a></p></td>
<td><p>Number of time steps that the output/prediction starts after the end of the input.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_future_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.supports_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_future_covariates</span></code></a></p></td>
<td><p>Whether model supports future covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_likelihood_parameter_prediction" title="darts.models.forecasting.conformal_models.ConformalModel.supports_likelihood_parameter_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_likelihood_parameter_prediction</span></code></a></p></td>
<td><p>Whether model instance supports direct prediction of likelihood parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_multivariate" title="darts.models.forecasting.conformal_models.ConformalModel.supports_multivariate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_multivariate</span></code></a></p></td>
<td><p>Whether the model considers more than one variate in the time series.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_optimized_historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.supports_optimized_historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_optimized_historical_forecasts</span></code></a></p></td>
<td><p>Whether the model supports optimized historical forecasts</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_past_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.supports_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_past_covariates</span></code></a></p></td>
<td><p>Whether model supports past covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_probabilistic_prediction" title="darts.models.forecasting.conformal_models.ConformalModel.supports_probabilistic_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_probabilistic_prediction</span></code></a></p></td>
<td><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_sample_weight" title="darts.models.forecasting.conformal_models.ConformalModel.supports_sample_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_sample_weight</span></code></a></p></td>
<td><p>Whether model supports sample weight for training.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_static_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.supports_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_static_covariates</span></code></a></p></td>
<td><p>Whether model supports static covariates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_transferable_series_prediction" title="darts.models.forecasting.conformal_models.ConformalModel.supports_transferable_series_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_transferable_series_prediction</span></code></a></p></td>
<td><p>Whether the model supports prediction for any input <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_future_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.uses_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_future_covariates</span></code></a></p></td>
<td><p>Whether the model uses future covariates, once fitted.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_past_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.uses_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_past_covariates</span></code></a></p></td>
<td><p>Whether the model uses past covariates, once fitted.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_static_covariates" title="darts.models.forecasting.conformal_models.ConformalModel.uses_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_static_covariates</span></code></a></p></td>
<td><p>Whether the model uses static covariates, once fitted.</p></td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>model_params</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="darts.models.forecasting.conformal_models.ConformalModel.backtest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backtest</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.fit" title="darts.models.forecasting.conformal_models.ConformalModel.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(series[, past_covariates, future_covariates])</p></td>
<td><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_fit_encodings" title="darts.models.forecasting.conformal_models.ConformalModel.generate_fit_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_encodings</span></code></a>(series[, ...])</p></td>
<td><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_fit_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalModel.generate_fit_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalModel.generate_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.gridsearch" title="darts.models.forecasting.conformal_models.ConformalModel.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(parameters, series[, ...])</p></td>
<td><p>Find the best hyper-parameters among a given set using a grid search.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">historical_forecasts</span></code></a>(series[, ...])</p></td>
<td><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the history of the provided (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.load" title="darts.models.forecasting.conformal_models.ConformalModel.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path[, pl_trainer_kwargs])</p></td>
<td><p>Loads a model from a given path or file handle.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.predict" title="darts.models.forecasting.conformal_models.ConformalModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(n[, series, past_covariates, ...])</p></td>
<td><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the end of the <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.residuals" title="darts.models.forecasting.conformal_models.ConformalModel.residuals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residuals</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.save" title="darts.models.forecasting.conformal_models.ConformalModel.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>([path, clean])</p></td>
<td><p>Saves the conformal model under a given path or file handle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.untrained_model" title="darts.models.forecasting.conformal_models.ConformalModel.untrained_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">untrained_model</span></code></a>()</p></td>
<td><p>Returns a new (untrained) model instance created with the same parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.backtest">
<span class="sig-name descname"><span class="pre">backtest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.backtest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>If <cite>historical_forecasts</cite> are provided, the metric(s) (given by the <cite>metric</cite> function) is evaluated directly on
all forecasts and actual values. The same <cite>series</cite> and <cite>last_points_only</cite> value must be passed that were used
to generate the historical forecasts. Finally, the method returns an optional <cite>reduction</cite> (the mean by default)
of all these metric scores.</p>
<p>If <cite>historical_forecasts</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, it first generates the historical forecasts with the parameters given
below (see <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConformalModel.historical_forecasts()</span></code></a> for more info) and then
evaluates as described above.</p>
<p>The metric(s) can be further customized <cite>metric_kwargs</cite> (e.g. control the aggregation over components, time
steps, multiple series, other required arguments such as <cite>q</cite> for quantile metrics, …).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>).
You can specify which intervals to evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check
all intervals used by your conformal model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]]]) – <p>A metric function or a list of metric functions. Each metric must either be a Darts metric (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ metrics, uses decorators <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>, and returns the metric score.</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A function used to combine the individual error scores obtained when <cite>last_points_only</cite> is set to <cite>False</cite>.
When providing several metric functions, the function will receive the argument <cite>axis = 1</cite> to obtain single
value for each metric function.
If explicitly set to <cite>None</cite>, the method will return a list of the individual error scores instead.
Set to <code class="docutils literal notranslate"><span class="pre">np.mean</span></code> by default.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘component_reduction’</cite>
for reducing the component wise metrics, seasonality <cite>‘m’</cite> for scaled metrics, etc. Will pass arguments to
each metric separately and only if they are present in the corresponding metric signature. Parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …) is ignored, as it is handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>float</em> – A single backtest score for single uni/multivariate series, a single <cite>metric</cite> function and:</p>
<ul>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=True</cite></p></li>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite> and using a backtest <cite>reduction</cite></p></li>
</ul>
</li>
<li><p><em>np.ndarray</em> – An numpy array of backtest scores. For single series and one of:</p>
<ul>
<li><p>a single <cite>metric</cite> function, <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>
and backtest <cite>reduction=None</cite>. The output has shape (n forecasts, <a href="#id3"><span class="problematic" id="id4">*</span></a>).</p></li>
<li><p>multiple <cite>metric</cite> functions and <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>.
The output has shape (<a href="#id5"><span class="problematic" id="id6">*</span></a>, n metrics) when using a backtest <cite>reduction</cite>, and (n forecasts, <a href="#id7"><span class="problematic" id="id8">*</span></a>, n metrics)
when <cite>reduction=None</cite></p></li>
<li><p>multiple uni/multivariate series including <cite>series_reduction</cite> and at least one of
<cite>component_reduction=None</cite> or <cite>time_reduction=None</cite> for “per time step metrics”</p></li>
</ul>
</li>
<li><p><em>list[float]</em> – Same as for type <cite>float</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>float</cite> metric for each input <cite>series</cite>.</p></li>
<li><p><em>list[np.ndarray]</em> – Same as for type <cite>np.ndarray</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>np.ndarray</cite> metrics for each input <cite>series</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.considers_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">considers_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.considers_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers static covariates, if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.extreme_lags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extreme_lags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.extreme_lags" title="Permalink to this definition">¶</a></dt>
<dd><p>A 8-tuple containing in order:
(min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate
lag, max future covariate lag, output shift, max target lag train (only for RNNModel)). If 0 is the index of the
first prediction, then all lags are relative to this index.</p>
<p>See examples below.</p>
<dl class="simple">
<dt>If the model wasn’t fitted with:</dt><dd><ul class="simple">
<li><p>target (concerning SKLearnModels only): then the first element should be <cite>None</cite>.</p></li>
<li><p>past covariates: then the third and fourth elements should be <cite>None</cite>.</p></li>
<li><p>future covariates: then the fifth and sixth elements should be <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Should be overridden by models that use past or future covariates, and/or for model that have minimum target
lag and maximum target lags potentially different from -1 and 0.</p>
<p class="rubric">Notes</p>
<p>maximum target lag (second value) cannot be <cite>None</cite> and is always larger than or equal to 0.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_chunk_shift</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 2, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">lags_past_covariates</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">past_covariates</span><span class="o">=</span><span class="n">past_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, -4, -1,  None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">lags_future_covariates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, None, None, 4, 6, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, 4, 6, 0, None)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p>
<p>Optionally, one or multiple past and/or future covariates series can be provided as well, depending on the
forecasting model used. The number of covariates series must match the number of target series.</p>
<p class="rubric">Notes</p>
<p>Conformal Models do not require calling <cite>fit()</cite>, since they use pre-trained global forecasting models.
You can call <cite>predict()</cite> directly. Also, make sure that the input series used in <cite>predict()</cite> corresponds to
a calibration set, and not the same as used during training with <cite>fit()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – One or several target time series. The model will be trained to forecast these time series.
The series may or may not be multivariate, but if multiple series are provided
they must have the same number of components.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several past-observed covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>past_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several future-known covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>future_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>fit()</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fitted model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.generate_fit_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_fit_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of
past, and future covariates series with the original and encoded covariates stacked together. The encodings are
generated by the encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>,
<cite>past_covariates</cite>, and  <cite>future_covariates</cite> that you used to train/fit the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with the target values used when fitting the model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the past-observed covariates used when fitting the model.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the future-known covariates used when fitting the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.generate_fit_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_fit_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for training and prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for training and prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for training and prediction. The
dimensions must match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.generate_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.generate_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.gridsearch">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridsearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_series=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fitted_values=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_random_samples=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best hyper-parameters among a given set using a grid search.</p>
<p>This function has 3 modes of operation: Expanding window mode, split mode and fitted value mode.
The three modes of operation evaluate every possible combination of hyper-parameter values
provided in the <cite>parameters</cite> dictionary by instantiating the <cite>model_class</cite> subclass
of ForecastingModel with each combination, and returning the best-performing model with regard
to the <cite>metric</cite> function. The <cite>metric</cite> function is expected to return an error value,
thus the model resulting in the smallest <cite>metric</cite> output will be chosen.</p>
<p>The relationship of the training data and test data depends on the mode of operation.</p>
<p>Expanding window mode (activated when <cite>forecast_horizon</cite> is passed):
For every hyperparameter combination, the model is repeatedly trained and evaluated on different
splits of <cite>series</cite>. This process is accomplished by using
the <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="darts.models.forecasting.conformal_models.ConformalModel.backtest"><code class="xref py py-func docutils literal notranslate"><span class="pre">backtest()</span></code></a> function as a subroutine to produce historic forecasts starting from <cite>start</cite>
that are compared against the ground truth values of <cite>series</cite>.
Note that the model is retrained for every single prediction, thus this mode is slower.</p>
<p>Split window mode (activated when <cite>val_series</cite> is passed):
This mode will be used when the <cite>val_series</cite> argument is passed.
For every hyper-parameter combination, the model is trained on <cite>series</cite> and
evaluated on <cite>val_series</cite>.</p>
<p>Fitted value mode (activated when <cite>use_fitted_values</cite> is set to <cite>True</cite>):
For every hyper-parameter combination, the model is trained on <cite>series</cite>
and evaluated on the resulting fitted values.
Not all models have fitted values, and this method raises an error if the model doesn’t have a <cite>fitted_values</cite>
member. The fitted values are the result of the fit of the model on <cite>series</cite>. Comparing with the
fitted values can be a quick way to assess the model, but one cannot see if the model is overfitting the series.</p>
<p>Derived classes must ensure that a single instance of a model will not share parameters with the other
instances, e.g., saving models in the same path. Otherwise, an unexpected behavior can arise while running
several models in parallel (when <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">!=</span> <span class="pre">1</span></code>). If this cannot be avoided, then gridsearch
should be redefined, forcing <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Currently this method only supports deterministic predictions (i.e. when models’ predictions
have only 1 sample).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_class</strong> – The ForecastingModel subclass to be tuned for ‘series’.</p></li>
<li><p><strong>parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary containing as keys hyperparameter names, and as values lists of values for the
respective hyperparameter.</p></li>
<li><p><strong>series</strong> (<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – The target series used as input and target for training.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a past-observed covariate series. This applies only if the model supports past covariates.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a future-known covariate series. This applies only if the model supports future covariates.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The integer value of the forecasting horizon. Activates expanding window mode.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Only used in expanding window mode. The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Only used in expanding window mode. Optionally, the first point in time at which a prediction is computed.
This parameter supports: <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If a <code class="docutils literal notranslate"><span class="pre">float</span></code>, it is the proportion of the time series that should lie before the first prediction point.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a Callable and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<dl class="simple">
<dt>Note: If <cite>start</cite> is not within the trainable / forecastable points, uses the closest valid start point that</dt><dd><p>is a round multiple of <cite>stride</cite> ahead of <cite>start</cite>. Raises a <cite>ValueError</cite>, if no valid start point exists.</p>
</dd>
<dt>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also</dt><dd><p>shifted by <cite>output_chunk_shift</cite> points into the future.</p>
</dd>
<dt>Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter</dt><dd><p>(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</dd>
</dl>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Only used in expanding window mode. Defines the <cite>start</cite> format. Only effective when <cite>start</cite> is an integer
and <cite>series</cite> is indexed with a <cite>pd.RangeIndex</cite>.
If set to ‘position’, <cite>start</cite> corresponds to the index position of the first predicted point and can range
from <cite>(-len(series), len(series) - 1)</cite>.
If set to ‘value’, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code></p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to use the whole forecasts or only the last point of each
forecast to compute the error.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to show warnings related to the <cite>start</cite> parameter.</p></li>
<li><p><strong>val_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The TimeSeries instance used for validation in split mode. If provided, this series must start right after
the end of <cite>series</cite>; so that a proper comparison of the forecast can be made.</p></li>
<li><p><strong>use_fitted_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, uses the comparison with the fitted values.
Raises an error if <code class="docutils literal notranslate"><span class="pre">fitted_values</span></code> is not an attribute of <cite>model_class</cite>.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – <p>A metric function that returns the error between two <cite>TimeSeries</cite> as a float value . Must either be one of
Darts’ “aggregated over time” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that as input two
<cite>TimeSeries</cite> and returns the error</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A reduction function (mapping array to float) describing how to aggregate the errors obtained
on the different validation series when backtesting. By default it’ll compute the mean of errors.</p></li>
<li><p><strong>verbose</strong> – Whether to print the progress.</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of jobs to run in parallel. Parallel jobs are created only when there are two or more parameters
combinations to evaluate. Each job will instantiate, train, and evaluate a different instance of the model.
Defaults to <cite>1</cite> (sequential). Setting the parameter to <cite>-1</cite> means using all the available cores.</p></li>
<li><p><strong>n_random_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number/ratio of hyperparameter combinations to select from the full parameter grid. This will perform
a random search instead of using the full grid.
If an integer, <cite>n_random_samples</cite> is the number of parameter combinations selected from the full grid and
must be between <cite>0</cite> and the total number of parameter combinations.
If a float, <cite>n_random_samples</cite> is the ratio of parameter combinations selected from the full grid and must
be between <cite>0</cite> and <cite>1</cite>. Defaults to <cite>None</cite>, for which random selection will be ignored.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step.</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>fit()</cite> method.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some sample weights to apply to the target <cite>series</cite> labels for training. Only effective when
<cite>retrain</cite> is not <code class="docutils literal notranslate"><span class="pre">False</span></code>. They are applied per observation, per label (each step in
<cite>output_chunk_length</cite>), and per component.
If a series, then those weights are used. If the weight series only have a single component / column, then
the weights are applied globally to all components in <cite>series</cite>. Otherwise, for component-specific weights,
the number of components must match those of <cite>series</cite>.
If a string, then the weights are generated using built-in weighting functions. The available options are
<cite>“linear”</cite> or <cite>“exponential”</cite> decay - the further in the past, the lower the weight.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing an untrained <cite>model_class</cite> instance created from the best-performing hyper-parameters,
along with a dictionary containing these best hyper-parameters,
and metric score for the best hyper-parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel" title="darts.models.forecasting.forecasting_model.ForecastingModel">ForecastingModel</a>, Dict, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts">
<span class="sig-name descname"><span class="pre">historical_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.historical_forecasts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the
history of the provided (potentially multiple) <cite>series</cite>. This process involves retrospectively applying the
model to different time steps, as if the forecasts were made in real-time at those specific moments. This
allows for an evaluation of the model’s performance over the entire duration of the series, providing insights
into its predictive accuracy and robustness across different historical periods.</p>
<p>Currently, conformal models only support the pre-trained historical forecasts mode (<cite>retrain=False</cite>).
Parameters <cite>retrain</cite> and <cite>train_length</cite> are ignored.</p>
<p><strong>Pre-trained Mode:</strong> First, all historical forecasts are generated using the underlying pre-trained global
forecasting model (see <a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts" title="darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastingModel.historical_forecasts()</span></code></a> for more info). Then it
repeatedly builds a calibration set by either expanding from the beginning of the historical forecasts or by
using a fixed-length moving window with length <cite>cal_length</cite> (the start point can also be configured with
<cite>start</cite> and <cite>start_format</cite>).
The next forecast of length <cite>forecast_horizon</cite> is then calibrated on this calibration set. Subsequently, the
end of the calibration set is moved forward by <cite>stride</cite> time steps, and the process is repeated.</p>
<p>By default, with <cite>last_points_only=True</cite>, this method returns a single time series (or a sequence of time
series when <cite>series</cite> is also a sequence of series) composed of the last point from each calibrated historical
forecast. This time series will thus have a frequency of <cite>series.freq * stride</cite>.
If <cite>last_points_only=False</cite>, it will instead return a list (or a sequence of lists) with all calibrated
historical forecasts of length <cite>forecast_horizon</cite> and frequency <cite>series.freq</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions. Must be a round-multiple of <cite>cal_stride</cite>
(set at model creation) and <cite>&gt;=cal_stride</cite>.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – A single historical forecast for a single <cite>series</cite> and <cite>last_points_only=True</cite>: it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of historical forecasts for:</p>
<ul>
<li><p>a sequence (list) of <cite>series</cite> and <cite>last_points_only=True</cite>: for each series, it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p>a single <cite>series</cite> and <cite>last_points_only=False</cite>: for each historical forecast, it contains the entire
horizon <cite>forecast_horizon</cite>.</p></li>
</ul>
</li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of historical forecasts for a sequence of <cite>series</cite> and <cite>last_points_only=False</cite>. For each
series, and historical forecast, it contains the entire horizon <cite>forecast_horizon</cite>. The outer list
is over the series provided in the input sequence, and the inner lists contain the historical forecasts for
each series.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.likelihood">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><span class="pre">Likelihood</span></a></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">Likelihood</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_trainer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model from a given path or file handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>]) – Path or file handle from which to load the model.</p></li>
<li><p><strong>pl_trainer_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Optionally, a set of kwargs to create a new Lightning Trainer used to configure the model for downstream
tasks (e.g. prediction).
Some examples include specifying the batch size or moving the model to CPU/GPU(s). Check the
<a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/trainer.html">Lightning Trainer documentation</a>
for more information about the supported kwargs.</p></li>
<li><p><strong>**kwargs</strong> – Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Additional kwargs for PyTorch Lightning’s <code class="xref py py-func docutils literal notranslate"><span class="pre">LightningModule.load_from_checkpoint()</span></code> method,
For more information, read the <a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/lightning_module.html#load-from-checkpoint">official documentation</a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel" title="darts.models.forecasting.conformal_models.ConformalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.min_train_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_train_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.min_train_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum number of samples for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.model_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.model_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.output_chunk_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.output_chunk_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps predicted at once by the model, not defined for statistical models.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.output_chunk_shift">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_shift</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.output_chunk_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps that the output/prediction starts after the end of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the
end of the <cite>series</cite>.</p>
<p>It is important that the input series for prediction correspond to a calibration set - a set different to the
series that the underlying forecasting <cite>model</cite> was trained on.</p>
<p>Since it is a probabilistic model, you can generate forecasts in two ways:</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Under the hood, the simplified workflow to produce one calibrated forecast/prediction for every step in the
horizon <cite>n</cite> is as follows (note: <cite>cal_length</cite> and <cite>cal_stride</cite> can be set at model creation):</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation
with parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since
the calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts on the calibration set (using the forecasting model) with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (specific to each conformal model) on these historical forecasts</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, add calibrated intervals to (or adjust the
existing intervals of) the forecasting model’s predictions.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Forecast horizon - the number of time steps after the end of the series for which to produce predictions.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A series or sequence of series, representing the history of the target series whose future is to be
predicted. Will use the past of this series for calibration. The series should not have any overlap with
the series used to train the forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related auto-regression and past covariates usage.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>predict()</cite> and
<cite>historical_forecasts()</cite> methods.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>series</cite> is not specified, this function returns a single time series containing the <cite>n</cite>
next points after then end of the training series.
If <cite>series</cite> is given and is a simple <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>, this function returns the <cite>n</cite> next points
after the end of <cite>series</cite>.
If <cite>series</cite> is given and is a sequence of several time series, this function returns
a sequence where each element contains the corresponding <cite>n</cite> points forecasts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">err&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.residuals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>This function computes the difference (or one of Darts’ “per time step” metrics) between the actual
observations from <cite>series</cite> and the fitted values obtained by training the model on <cite>series</cite> (or using a
pre-trained model with <cite>retrain=False</cite>). Not all models support fitted values, so we use historical forecasts
as an approximation for them.</p>
<p>In sequence this method performs:</p>
<ul class="simple">
<li><p>use pre-computed <cite>historical_forecasts</cite> or compute historical forecasts for each series (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a> for more details).
How the historical forecasts are generated can be configured with parameters <cite>num_samples</cite>, <cite>train_length</cite>,
<cite>start</cite>, <cite>start_format</cite>, <cite>forecast_horizon</cite>, <cite>stride</cite>, <cite>retrain</cite>, <cite>last_points_only</cite>, <cite>fit_kwargs</cite>, and
<cite>predict_kwargs</cite>.</p></li>
<li><p>compute a backtest using a “per time step” <cite>metric</cite> between the historical forecasts and <cite>series</cite> per
component/column and time step (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="darts.models.forecasting.conformal_models.ConformalModel.backtest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backtest()</span></code></a> for more details). By default,
uses the residuals <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.err" title="darts.metrics.metrics.err"><code class="xref py py-func docutils literal notranslate"><span class="pre">err()</span></code></a> (error) as a <cite>metric</cite>.</p></li>
<li><p>create and return <cite>TimeSeries</cite> (or simply a np.ndarray with <cite>values_only=True</cite>) with the time index from
historical forecasts, and values from the metrics per component and time step.</p></li>
</ul>
<p>This method works for single or multiple univariate or multivariate series.
It uses the median prediction (when dealing with stochastic forecasts).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
“per time step” quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>). You can specify which intervals to
evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check all intervals used by your conformal
model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]) – <p>Either one of Darts’ “per time step” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ “per time step” metrics, uses decorators
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>,
and returns one value per time step.</p>
</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘m’</cite> for scaled
metrics, etc. Will pass arguments only if they are present in the corresponding metric signature. Ignores
reduction arguments <cite>“series_reduction”, “component_reduction”, “time_reduction”</cite>, and parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …), as they are handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>values_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return the residuals as <cite>np.ndarray</cite>. If <cite>False</cite>, returns residuals as <cite>TimeSeries</cite>.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – Residual <cite>TimeSeries</cite> for a single <cite>series</cite> and <cite>historical_forecasts</cite> generated with
<cite>last_points_only=True</cite>.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of residual <cite>TimeSeries</cite> for a sequence (list) of <cite>series</cite> with <cite>last_points_only=True</cite>.
The residual list has length <cite>len(series)</cite>.</p></li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of residual <cite>TimeSeries</cite> for a sequence of <cite>series</cite> with <cite>last_points_only=False</cite>.
The outer residual list has length <cite>len(series)</cite>. The inner lists consist of the residuals from
all possible series-specific historical forecasts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pkl_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalModel.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the conformal model under a given path or file handle.</p>
<p>Additionally, two files are stored if <cite>self.model</cite> is a <cite>TorchForecastingModel</cite>.</p>
<p>Example for saving and loading a <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel" title="darts.models.forecasting.conformal_models.ConformalNaiveModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalNaiveModel</span></code></a>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConformalNaiveModel</span><span class="p">,</span> <span class="n">LinearRegressionModel</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">forecasting_model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">forecasting_model</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
<span class="n">model_loaded</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Path or file handle under which to save the ensemble model at its current state. If no path is specified,
the ensemble model is automatically saved under <code class="docutils literal notranslate"><span class="pre">&quot;{ConformalNaiveModel}_{YYYY-mm-dd_HH_MM_SS}.pkl&quot;</span></code>.
If the forecasting model is a <cite>TorchForecastingModel</cite>, two files (model object and checkpoint) are saved
under <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.pt&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.ckpt&quot;</span></code>.</p></li>
<li><p><strong>clean</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>Whether to store a cleaned version of the model. If <cite>True</cite>, the training series and covariates are removed.
If the underlying forecasting <cite>model</cite> is a <cite>TorchForecastingModel</cite>, will additionally remove all Lightning
Trainer-related parameters.</p>
<p>Note: After loading a model stored with <cite>clean=True</cite>, a <cite>series</cite> must be passed ‘predict()’,
<cite>historical_forecasts()</cite> and other forecasting methods.</p>
</p></li>
<li><p><strong>pkl_kwargs</strong> – Keyword arguments passed to <cite>pickle.dump()</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports future covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_likelihood_parameter_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_likelihood_parameter_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_likelihood_parameter_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model instance supports direct prediction of likelihood parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_multivariate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_multivariate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_multivariate" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers more than one variate in the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_optimized_historical_forecasts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_optimized_historical_forecasts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_optimized_historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports optimized historical forecasts</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports past covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_probabilistic_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_probabilistic_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_probabilistic_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p>
<p>By default, returns False. Needs to be overwritten by models that do support
probabilistic predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_sample_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_sample_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_sample_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports sample weight for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports static covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.supports_transferable_series_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_transferable_series_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.supports_transferable_series_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports prediction for any input <cite>series</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.untrained_model">
<span class="sig-name descname"><span class="pre">untrained_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.untrained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new (untrained) model instance created with the same parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.uses_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses future covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.uses_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses past covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalModel.uses_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalModel.uses_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses static covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">darts.models.forecasting.conformal_models.</span></span><span class="sig-name descname"><span class="pre">ConformalNaiveModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalNaiveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel" title="darts.models.forecasting.conformal_models.ConformalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalModel</span></code></a></p>
<p>Naive Conformal Prediction Model.</p>
<p>A probabilistic model that adds calibrated intervals around the median forecast from a pre-trained
global forecasting model. It does not have to be trained and can generated calibrated forecasts
directly using the underlying trained forecasting model. It supports two symmetry modes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>symmetric=True</cite>:</dt><dd><ul>
<li><p>The lower and upper interval bounds are calibrated with the same magnitude.</p></li>
<li><p>Non-conformity scores: uses metric <cite>ae()</cite> (see absolute error <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.ae" title="darts.metrics.metrics.ae"><code class="xref py py-func docutils literal notranslate"><span class="pre">ae()</span></code></a>) to
compute the non-conformity scores on the calibration set.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>symmetric=False</cite></dt><dd><ul>
<li><p>The lower and upper interval bounds are calibrated separately.</p></li>
<li><p>Non-conformity scores: uses metric <cite>err()</cite> (see error <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.err" title="darts.metrics.metrics.err"><code class="xref py py-func docutils literal notranslate"><span class="pre">err()</span></code></a>) to compute the
non-conformity scores on the calibration set for the upper bounds, an <cite>-err()</cite> for the lower bounds.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Since it is a probabilistic model, you can generate forecasts in two ways (when calling <cite>predict()</cite>,
<cite>historical_forecasts()</cite>, …):</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Conformal models can be applied to any of Darts’ global forecasting model, as long as the model has been
fitted before. In general the workflow of the models to produce one calibrated forecast/prediction is as
follows:</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation
with parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since
the calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts on the calibration set (using the forecasting model) with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (as defined above) on these historical forecasts</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, add calibrated intervals to the forecasting
model’s predictions.</p></li>
</ul>
<p>Some notes:</p>
<ul class="simple">
<li><p>When computing <cite>historical_forecasts()</cite>, <cite>backtest()</cite>, <cite>residuals()</cite>, … the above is applied for each
forecast (the forecasting model’s historical forecasts are only generated once for efficiency).</p></li>
<li><p>For multi-horizon forecasts, the above is applied for each step in the horizon separately.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalForecastingModel</span></code>) – <p>A pre-trained global forecasting model. See the list of models
<a class="reference external" href="https://unit8co.github.io/darts/#forecasting-models">here</a>.</p>
</p></li>
<li><p><strong>quantiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A list of quantiles centered around the median <cite>q=0.5</cite> to use. For example quantiles
[0.1, 0.2, 0.5, 0.8 0.9] correspond to two intervals with (0.9 - 0.1) = 80%, and (0.8 - 0.2) 60% coverage
around the median (model forecast).</p></li>
<li><p><strong>symmetric</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use symmetric non-conformity scores. If <cite>True</cite>, uses metric <cite>ae()</cite> (see
<a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.ae" title="darts.metrics.metrics.ae"><code class="xref py py-func docutils literal notranslate"><span class="pre">ae()</span></code></a>) to compute the non-conformity scores. If <cite>False</cite>, uses metric <cite>-err()</cite>
(see <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.err" title="darts.metrics.metrics.err"><code class="xref py py-func docutils literal notranslate"><span class="pre">err()</span></code></a>) for the lower, and <cite>err()</cite> for the upper quantile interval bound.</p></li>
<li><p><strong>cal_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number of past forecast errors / non-conformity scores to use as calibration for each conformal
forecast (and each step in the horizon). If <cite>None</cite>, considers all scores.</p></li>
<li><p><strong>cal_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The stride to apply when computing the historical forecasts and non-conformity scores on the calibration
set. The actual conformal forecasts can have a different stride given with parameter <cite>stride</cite> in downstream
tasks (e.g. historical forecasts, backtest, …)</p></li>
<li><p><strong>cal_num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of samples to generate for each calibration forecast (if <cite>model</cite> is a probabilistic forecasting
model). The non-conformity scores are computed on the quantile values of these forecasts (using quantiles
<cite>quantiles</cite>). Uses <cite>1</cite> for deterministic models. The actual conformal forecasts can have a different number
of samples given with parameter <cite>num_samples</cite> in downstream tasks (e.g. predict, historical forecasts, …).</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Control the randomness of probabilistic conformal forecasts (sample generation) across different runs.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.considers_static_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.considers_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">considers_static_covariates</span></code></a></p></td>
<td><p>Whether the model considers static covariates, if there are any.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.extreme_lags" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.extreme_lags"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extreme_lags</span></code></a></p></td>
<td><p>A 8-tuple containing in order: (min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate lag, max future covariate lag, output shift, max target lag train (only for RNNModel)).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.likelihood" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">likelihood</span></code></a></p></td>
<td><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.min_train_samples" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.min_train_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">min_train_samples</span></code></a></p></td>
<td><p>The minimum number of samples for training the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_length" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_length</span></code></a></p></td>
<td><p>Number of time steps predicted at once by the model, not defined for statistical models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_shift" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_shift</span></code></a></p></td>
<td><p>Number of time steps that the output/prediction starts after the end of the input.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_future_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_future_covariates</span></code></a></p></td>
<td><p>Whether model supports future covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_likelihood_parameter_prediction" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_likelihood_parameter_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_likelihood_parameter_prediction</span></code></a></p></td>
<td><p>Whether model instance supports direct prediction of likelihood parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_multivariate" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_multivariate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_multivariate</span></code></a></p></td>
<td><p>Whether the model considers more than one variate in the time series.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_optimized_historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_optimized_historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_optimized_historical_forecasts</span></code></a></p></td>
<td><p>Whether the model supports optimized historical forecasts</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_past_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_past_covariates</span></code></a></p></td>
<td><p>Whether model supports past covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_probabilistic_prediction" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_probabilistic_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_probabilistic_prediction</span></code></a></p></td>
<td><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_sample_weight" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_sample_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_sample_weight</span></code></a></p></td>
<td><p>Whether model supports sample weight for training.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_static_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_static_covariates</span></code></a></p></td>
<td><p>Whether model supports static covariates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_transferable_series_prediction" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_transferable_series_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_transferable_series_prediction</span></code></a></p></td>
<td><p>Whether the model supports prediction for any input <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_future_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_future_covariates</span></code></a></p></td>
<td><p>Whether the model uses future covariates, once fitted.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_past_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_past_covariates</span></code></a></p></td>
<td><p>Whether the model uses past covariates, once fitted.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_static_covariates" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_static_covariates</span></code></a></p></td>
<td><p>Whether the model uses static covariates, once fitted.</p></td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>model_params</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backtest</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.fit" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(series[, past_covariates, future_covariates])</p></td>
<td><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_encodings" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_encodings</span></code></a>(series[, ...])</p></td>
<td><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.gridsearch" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(parameters, series[, ...])</p></td>
<td><p>Find the best hyper-parameters among a given set using a grid search.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">historical_forecasts</span></code></a>(series[, ...])</p></td>
<td><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the history of the provided (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.load" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path[, pl_trainer_kwargs])</p></td>
<td><p>Loads a model from a given path or file handle.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.predict" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(n[, series, past_covariates, ...])</p></td>
<td><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the end of the <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.residuals" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.residuals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residuals</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.save" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>([path, clean])</p></td>
<td><p>Saves the conformal model under a given path or file handle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.untrained_model" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.untrained_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">untrained_model</span></code></a>()</p></td>
<td><p>Returns a new (untrained) model instance created with the same parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest">
<span class="sig-name descname"><span class="pre">backtest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>If <cite>historical_forecasts</cite> are provided, the metric(s) (given by the <cite>metric</cite> function) is evaluated directly on
all forecasts and actual values. The same <cite>series</cite> and <cite>last_points_only</cite> value must be passed that were used
to generate the historical forecasts. Finally, the method returns an optional <cite>reduction</cite> (the mean by default)
of all these metric scores.</p>
<p>If <cite>historical_forecasts</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, it first generates the historical forecasts with the parameters given
below (see <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConformalModel.historical_forecasts()</span></code></a> for more info) and then
evaluates as described above.</p>
<p>The metric(s) can be further customized <cite>metric_kwargs</cite> (e.g. control the aggregation over components, time
steps, multiple series, other required arguments such as <cite>q</cite> for quantile metrics, …).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>).
You can specify which intervals to evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check
all intervals used by your conformal model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]]]) – <p>A metric function or a list of metric functions. Each metric must either be a Darts metric (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ metrics, uses decorators <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>, and returns the metric score.</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A function used to combine the individual error scores obtained when <cite>last_points_only</cite> is set to <cite>False</cite>.
When providing several metric functions, the function will receive the argument <cite>axis = 1</cite> to obtain single
value for each metric function.
If explicitly set to <cite>None</cite>, the method will return a list of the individual error scores instead.
Set to <code class="docutils literal notranslate"><span class="pre">np.mean</span></code> by default.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘component_reduction’</cite>
for reducing the component wise metrics, seasonality <cite>‘m’</cite> for scaled metrics, etc. Will pass arguments to
each metric separately and only if they are present in the corresponding metric signature. Parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …) is ignored, as it is handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>float</em> – A single backtest score for single uni/multivariate series, a single <cite>metric</cite> function and:</p>
<ul>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=True</cite></p></li>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite> and using a backtest <cite>reduction</cite></p></li>
</ul>
</li>
<li><p><em>np.ndarray</em> – An numpy array of backtest scores. For single series and one of:</p>
<ul>
<li><p>a single <cite>metric</cite> function, <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>
and backtest <cite>reduction=None</cite>. The output has shape (n forecasts, <a href="#id15"><span class="problematic" id="id16">*</span></a>).</p></li>
<li><p>multiple <cite>metric</cite> functions and <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>.
The output has shape (<a href="#id17"><span class="problematic" id="id18">*</span></a>, n metrics) when using a backtest <cite>reduction</cite>, and (n forecasts, <a href="#id19"><span class="problematic" id="id20">*</span></a>, n metrics)
when <cite>reduction=None</cite></p></li>
<li><p>multiple uni/multivariate series including <cite>series_reduction</cite> and at least one of
<cite>component_reduction=None</cite> or <cite>time_reduction=None</cite> for “per time step metrics”</p></li>
</ul>
</li>
<li><p><em>list[float]</em> – Same as for type <cite>float</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>float</cite> metric for each input <cite>series</cite>.</p></li>
<li><p><em>list[np.ndarray]</em> – Same as for type <cite>np.ndarray</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>np.ndarray</cite> metrics for each input <cite>series</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.considers_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">considers_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.considers_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers static covariates, if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.extreme_lags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extreme_lags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.extreme_lags" title="Permalink to this definition">¶</a></dt>
<dd><p>A 8-tuple containing in order:
(min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate
lag, max future covariate lag, output shift, max target lag train (only for RNNModel)). If 0 is the index of the
first prediction, then all lags are relative to this index.</p>
<p>See examples below.</p>
<dl class="simple">
<dt>If the model wasn’t fitted with:</dt><dd><ul class="simple">
<li><p>target (concerning SKLearnModels only): then the first element should be <cite>None</cite>.</p></li>
<li><p>past covariates: then the third and fourth elements should be <cite>None</cite>.</p></li>
<li><p>future covariates: then the fifth and sixth elements should be <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Should be overridden by models that use past or future covariates, and/or for model that have minimum target
lag and maximum target lags potentially different from -1 and 0.</p>
<p class="rubric">Notes</p>
<p>maximum target lag (second value) cannot be <cite>None</cite> and is always larger than or equal to 0.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_chunk_shift</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 2, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">lags_past_covariates</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">past_covariates</span><span class="o">=</span><span class="n">past_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, -4, -1,  None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">lags_future_covariates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, None, None, 4, 6, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, 4, 6, 0, None)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p>
<p>Optionally, one or multiple past and/or future covariates series can be provided as well, depending on the
forecasting model used. The number of covariates series must match the number of target series.</p>
<p class="rubric">Notes</p>
<p>Conformal Models do not require calling <cite>fit()</cite>, since they use pre-trained global forecasting models.
You can call <cite>predict()</cite> directly. Also, make sure that the input series used in <cite>predict()</cite> corresponds to
a calibration set, and not the same as used during training with <cite>fit()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – One or several target time series. The model will be trained to forecast these time series.
The series may or may not be multivariate, but if multiple series are provided
they must have the same number of components.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several past-observed covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>past_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several future-known covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>future_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>fit()</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fitted model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of
past, and future covariates series with the original and encoded covariates stacked together. The encodings are
generated by the encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>,
<cite>past_covariates</cite>, and  <cite>future_covariates</cite> that you used to train/fit the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with the target values used when fitting the model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the past-observed covariates used when fitting the model.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the future-known covariates used when fitting the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_fit_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for training and prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for training and prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for training and prediction. The
dimensions must match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.generate_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.gridsearch">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridsearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_series=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fitted_values=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_random_samples=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best hyper-parameters among a given set using a grid search.</p>
<p>This function has 3 modes of operation: Expanding window mode, split mode and fitted value mode.
The three modes of operation evaluate every possible combination of hyper-parameter values
provided in the <cite>parameters</cite> dictionary by instantiating the <cite>model_class</cite> subclass
of ForecastingModel with each combination, and returning the best-performing model with regard
to the <cite>metric</cite> function. The <cite>metric</cite> function is expected to return an error value,
thus the model resulting in the smallest <cite>metric</cite> output will be chosen.</p>
<p>The relationship of the training data and test data depends on the mode of operation.</p>
<p>Expanding window mode (activated when <cite>forecast_horizon</cite> is passed):
For every hyperparameter combination, the model is repeatedly trained and evaluated on different
splits of <cite>series</cite>. This process is accomplished by using
the <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest" title="darts.models.forecasting.conformal_models.ConformalNaiveModel.backtest"><code class="xref py py-func docutils literal notranslate"><span class="pre">backtest()</span></code></a> function as a subroutine to produce historic forecasts starting from <cite>start</cite>
that are compared against the ground truth values of <cite>series</cite>.
Note that the model is retrained for every single prediction, thus this mode is slower.</p>
<p>Split window mode (activated when <cite>val_series</cite> is passed):
This mode will be used when the <cite>val_series</cite> argument is passed.
For every hyper-parameter combination, the model is trained on <cite>series</cite> and
evaluated on <cite>val_series</cite>.</p>
<p>Fitted value mode (activated when <cite>use_fitted_values</cite> is set to <cite>True</cite>):
For every hyper-parameter combination, the model is trained on <cite>series</cite>
and evaluated on the resulting fitted values.
Not all models have fitted values, and this method raises an error if the model doesn’t have a <cite>fitted_values</cite>
member. The fitted values are the result of the fit of the model on <cite>series</cite>. Comparing with the
fitted values can be a quick way to assess the model, but one cannot see if the model is overfitting the series.</p>
<p>Derived classes must ensure that a single instance of a model will not share parameters with the other
instances, e.g., saving models in the same path. Otherwise, an unexpected behavior can arise while running
several models in parallel (when <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">!=</span> <span class="pre">1</span></code>). If this cannot be avoided, then gridsearch
should be redefined, forcing <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Currently this method only supports deterministic predictions (i.e. when models’ predictions
have only 1 sample).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_class</strong> – The ForecastingModel subclass to be tuned for ‘series’.</p></li>
<li><p><strong>parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary containing as keys hyperparameter names, and as values lists of values for the
respective hyperparameter.</p></li>
<li><p><strong>series</strong> (<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – The target series used as input and target for training.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a past-observed covariate series. This applies only if the model supports past covariates.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a future-known covariate series. This applies only if the model supports future covariates.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The integer value of the forecasting horizon. Activates expanding window mode.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Only used in expanding window mode. The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Only used in expanding window mode. Optionally, the first point in time at which a prediction is computed.
This parameter supports: <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If a <code class="docutils literal notranslate"><span class="pre">float</span></code>, it is the proportion of the time series that should lie before the first prediction point.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a Callable and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<dl class="simple">
<dt>Note: If <cite>start</cite> is not within the trainable / forecastable points, uses the closest valid start point that</dt><dd><p>is a round multiple of <cite>stride</cite> ahead of <cite>start</cite>. Raises a <cite>ValueError</cite>, if no valid start point exists.</p>
</dd>
<dt>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also</dt><dd><p>shifted by <cite>output_chunk_shift</cite> points into the future.</p>
</dd>
<dt>Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter</dt><dd><p>(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</dd>
</dl>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Only used in expanding window mode. Defines the <cite>start</cite> format. Only effective when <cite>start</cite> is an integer
and <cite>series</cite> is indexed with a <cite>pd.RangeIndex</cite>.
If set to ‘position’, <cite>start</cite> corresponds to the index position of the first predicted point and can range
from <cite>(-len(series), len(series) - 1)</cite>.
If set to ‘value’, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code></p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to use the whole forecasts or only the last point of each
forecast to compute the error.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to show warnings related to the <cite>start</cite> parameter.</p></li>
<li><p><strong>val_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The TimeSeries instance used for validation in split mode. If provided, this series must start right after
the end of <cite>series</cite>; so that a proper comparison of the forecast can be made.</p></li>
<li><p><strong>use_fitted_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, uses the comparison with the fitted values.
Raises an error if <code class="docutils literal notranslate"><span class="pre">fitted_values</span></code> is not an attribute of <cite>model_class</cite>.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – <p>A metric function that returns the error between two <cite>TimeSeries</cite> as a float value . Must either be one of
Darts’ “aggregated over time” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that as input two
<cite>TimeSeries</cite> and returns the error</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A reduction function (mapping array to float) describing how to aggregate the errors obtained
on the different validation series when backtesting. By default it’ll compute the mean of errors.</p></li>
<li><p><strong>verbose</strong> – Whether to print the progress.</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of jobs to run in parallel. Parallel jobs are created only when there are two or more parameters
combinations to evaluate. Each job will instantiate, train, and evaluate a different instance of the model.
Defaults to <cite>1</cite> (sequential). Setting the parameter to <cite>-1</cite> means using all the available cores.</p></li>
<li><p><strong>n_random_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number/ratio of hyperparameter combinations to select from the full parameter grid. This will perform
a random search instead of using the full grid.
If an integer, <cite>n_random_samples</cite> is the number of parameter combinations selected from the full grid and
must be between <cite>0</cite> and the total number of parameter combinations.
If a float, <cite>n_random_samples</cite> is the ratio of parameter combinations selected from the full grid and must
be between <cite>0</cite> and <cite>1</cite>. Defaults to <cite>None</cite>, for which random selection will be ignored.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step.</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>fit()</cite> method.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some sample weights to apply to the target <cite>series</cite> labels for training. Only effective when
<cite>retrain</cite> is not <code class="docutils literal notranslate"><span class="pre">False</span></code>. They are applied per observation, per label (each step in
<cite>output_chunk_length</cite>), and per component.
If a series, then those weights are used. If the weight series only have a single component / column, then
the weights are applied globally to all components in <cite>series</cite>. Otherwise, for component-specific weights,
the number of components must match those of <cite>series</cite>.
If a string, then the weights are generated using built-in weighting functions. The available options are
<cite>“linear”</cite> or <cite>“exponential”</cite> decay - the further in the past, the lower the weight.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing an untrained <cite>model_class</cite> instance created from the best-performing hyper-parameters,
along with a dictionary containing these best hyper-parameters,
and metric score for the best hyper-parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel" title="darts.models.forecasting.forecasting_model.ForecastingModel">ForecastingModel</a>, Dict, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.historical_forecasts">
<span class="sig-name descname"><span class="pre">historical_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the
history of the provided (potentially multiple) <cite>series</cite>. This process involves retrospectively applying the
model to different time steps, as if the forecasts were made in real-time at those specific moments. This
allows for an evaluation of the model’s performance over the entire duration of the series, providing insights
into its predictive accuracy and robustness across different historical periods.</p>
<p>Currently, conformal models only support the pre-trained historical forecasts mode (<cite>retrain=False</cite>).
Parameters <cite>retrain</cite> and <cite>train_length</cite> are ignored.</p>
<p><strong>Pre-trained Mode:</strong> First, all historical forecasts are generated using the underlying pre-trained global
forecasting model (see <a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts" title="darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastingModel.historical_forecasts()</span></code></a> for more info). Then it
repeatedly builds a calibration set by either expanding from the beginning of the historical forecasts or by
using a fixed-length moving window with length <cite>cal_length</cite> (the start point can also be configured with
<cite>start</cite> and <cite>start_format</cite>).
The next forecast of length <cite>forecast_horizon</cite> is then calibrated on this calibration set. Subsequently, the
end of the calibration set is moved forward by <cite>stride</cite> time steps, and the process is repeated.</p>
<p>By default, with <cite>last_points_only=True</cite>, this method returns a single time series (or a sequence of time
series when <cite>series</cite> is also a sequence of series) composed of the last point from each calibrated historical
forecast. This time series will thus have a frequency of <cite>series.freq * stride</cite>.
If <cite>last_points_only=False</cite>, it will instead return a list (or a sequence of lists) with all calibrated
historical forecasts of length <cite>forecast_horizon</cite> and frequency <cite>series.freq</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions. Must be a round-multiple of <cite>cal_stride</cite>
(set at model creation) and <cite>&gt;=cal_stride</cite>.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – A single historical forecast for a single <cite>series</cite> and <cite>last_points_only=True</cite>: it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of historical forecasts for:</p>
<ul>
<li><p>a sequence (list) of <cite>series</cite> and <cite>last_points_only=True</cite>: for each series, it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p>a single <cite>series</cite> and <cite>last_points_only=False</cite>: for each historical forecast, it contains the entire
horizon <cite>forecast_horizon</cite>.</p></li>
</ul>
</li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of historical forecasts for a sequence of <cite>series</cite> and <cite>last_points_only=False</cite>. For each
series, and historical forecast, it contains the entire horizon <cite>forecast_horizon</cite>. The outer list
is over the series provided in the input sequence, and the inner lists contain the historical forecasts for
each series.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.likelihood">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><span class="pre">Likelihood</span></a></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">Likelihood</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_trainer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model from a given path or file handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>]) – Path or file handle from which to load the model.</p></li>
<li><p><strong>pl_trainer_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Optionally, a set of kwargs to create a new Lightning Trainer used to configure the model for downstream
tasks (e.g. prediction).
Some examples include specifying the batch size or moving the model to CPU/GPU(s). Check the
<a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/trainer.html">Lightning Trainer documentation</a>
for more information about the supported kwargs.</p>
</p></li>
<li><p><strong>**kwargs</strong> – <p>Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Additional kwargs for PyTorch Lightning’s <code class="xref py py-func docutils literal notranslate"><span class="pre">LightningModule.load_from_checkpoint()</span></code> method,
For more information, read the <a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/lightning_module.html#load-from-checkpoint">official documentation</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel" title="darts.models.forecasting.conformal_models.ConformalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.min_train_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_train_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.min_train_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum number of samples for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.model_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.model_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps predicted at once by the model, not defined for statistical models.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_shift">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_shift</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.output_chunk_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps that the output/prediction starts after the end of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the
end of the <cite>series</cite>.</p>
<p>It is important that the input series for prediction correspond to a calibration set - a set different to the
series that the underlying forecasting <cite>model</cite> was trained on.</p>
<p>Since it is a probabilistic model, you can generate forecasts in two ways:</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Under the hood, the simplified workflow to produce one calibrated forecast/prediction for every step in the
horizon <cite>n</cite> is as follows (note: <cite>cal_length</cite> and <cite>cal_stride</cite> can be set at model creation):</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation
with parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since
the calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts on the calibration set (using the forecasting model) with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (specific to each conformal model) on these historical forecasts</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, add calibrated intervals to (or adjust the
existing intervals of) the forecasting model’s predictions.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Forecast horizon - the number of time steps after the end of the series for which to produce predictions.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A series or sequence of series, representing the history of the target series whose future is to be
predicted. Will use the past of this series for calibration. The series should not have any overlap with
the series used to train the forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related auto-regression and past covariates usage.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>predict()</cite> and
<cite>historical_forecasts()</cite> methods.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>series</cite> is not specified, this function returns a single time series containing the <cite>n</cite>
next points after then end of the training series.
If <cite>series</cite> is given and is a simple <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>, this function returns the <cite>n</cite> next points
after the end of <cite>series</cite>.
If <cite>series</cite> is given and is a sequence of several time series, this function returns
a sequence where each element contains the corresponding <cite>n</cite> points forecasts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">err&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>This function computes the difference (or one of Darts’ “per time step” metrics) between the actual
observations from <cite>series</cite> and the fitted values obtained by training the model on <cite>series</cite> (or using a
pre-trained model with <cite>retrain=False</cite>). Not all models support fitted values, so we use historical forecasts
as an approximation for them.</p>
<p>In sequence this method performs:</p>
<ul class="simple">
<li><p>use pre-computed <cite>historical_forecasts</cite> or compute historical forecasts for each series (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a> for more details).
How the historical forecasts are generated can be configured with parameters <cite>num_samples</cite>, <cite>train_length</cite>,
<cite>start</cite>, <cite>start_format</cite>, <cite>forecast_horizon</cite>, <cite>stride</cite>, <cite>retrain</cite>, <cite>last_points_only</cite>, <cite>fit_kwargs</cite>, and
<cite>predict_kwargs</cite>.</p></li>
<li><p>compute a backtest using a “per time step” <cite>metric</cite> between the historical forecasts and <cite>series</cite> per
component/column and time step (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="darts.models.forecasting.conformal_models.ConformalModel.backtest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backtest()</span></code></a> for more details). By default,
uses the residuals <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.err" title="darts.metrics.metrics.err"><code class="xref py py-func docutils literal notranslate"><span class="pre">err()</span></code></a> (error) as a <cite>metric</cite>.</p></li>
<li><p>create and return <cite>TimeSeries</cite> (or simply a np.ndarray with <cite>values_only=True</cite>) with the time index from
historical forecasts, and values from the metrics per component and time step.</p></li>
</ul>
<p>This method works for single or multiple univariate or multivariate series.
It uses the median prediction (when dealing with stochastic forecasts).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
“per time step” quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>). You can specify which intervals to
evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check all intervals used by your conformal
model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]) – <p>Either one of Darts’ “per time step” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ “per time step” metrics, uses decorators
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>,
and returns one value per time step.</p>
</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘m’</cite> for scaled
metrics, etc. Will pass arguments only if they are present in the corresponding metric signature. Ignores
reduction arguments <cite>“series_reduction”, “component_reduction”, “time_reduction”</cite>, and parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …), as they are handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>values_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return the residuals as <cite>np.ndarray</cite>. If <cite>False</cite>, returns residuals as <cite>TimeSeries</cite>.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – Residual <cite>TimeSeries</cite> for a single <cite>series</cite> and <cite>historical_forecasts</cite> generated with
<cite>last_points_only=True</cite>.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of residual <cite>TimeSeries</cite> for a sequence (list) of <cite>series</cite> with <cite>last_points_only=True</cite>.
The residual list has length <cite>len(series)</cite>.</p></li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of residual <cite>TimeSeries</cite> for a sequence of <cite>series</cite> with <cite>last_points_only=False</cite>.
The outer residual list has length <cite>len(series)</cite>. The inner lists consist of the residuals from
all possible series-specific historical forecasts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pkl_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the conformal model under a given path or file handle.</p>
<p>Additionally, two files are stored if <cite>self.model</cite> is a <cite>TorchForecastingModel</cite>.</p>
<p>Example for saving and loading a <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel" title="darts.models.forecasting.conformal_models.ConformalNaiveModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalNaiveModel</span></code></a>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConformalNaiveModel</span><span class="p">,</span> <span class="n">LinearRegressionModel</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">forecasting_model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">forecasting_model</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
<span class="n">model_loaded</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Path or file handle under which to save the ensemble model at its current state. If no path is specified,
the ensemble model is automatically saved under <code class="docutils literal notranslate"><span class="pre">&quot;{ConformalNaiveModel}_{YYYY-mm-dd_HH_MM_SS}.pkl&quot;</span></code>.
If the forecasting model is a <cite>TorchForecastingModel</cite>, two files (model object and checkpoint) are saved
under <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.pt&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.ckpt&quot;</span></code>.</p></li>
<li><p><strong>clean</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>Whether to store a cleaned version of the model. If <cite>True</cite>, the training series and covariates are removed.
If the underlying forecasting <cite>model</cite> is a <cite>TorchForecastingModel</cite>, will additionally remove all Lightning
Trainer-related parameters.</p>
<p>Note: After loading a model stored with <cite>clean=True</cite>, a <cite>series</cite> must be passed ‘predict()’,
<cite>historical_forecasts()</cite> and other forecasting methods.</p>
</p></li>
<li><p><strong>pkl_kwargs</strong> – Keyword arguments passed to <cite>pickle.dump()</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports future covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_likelihood_parameter_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_likelihood_parameter_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_likelihood_parameter_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model instance supports direct prediction of likelihood parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_multivariate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_multivariate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_multivariate" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers more than one variate in the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_optimized_historical_forecasts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_optimized_historical_forecasts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_optimized_historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports optimized historical forecasts</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports past covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_probabilistic_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_probabilistic_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_probabilistic_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p>
<p>By default, returns False. Needs to be overwritten by models that do support
probabilistic predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_sample_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_sample_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_sample_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports sample weight for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports static covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_transferable_series_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_transferable_series_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.supports_transferable_series_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports prediction for any input <cite>series</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.untrained_model">
<span class="sig-name descname"><span class="pre">untrained_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.untrained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new (untrained) model instance created with the same parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses future covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses past covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel.uses_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses static covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">darts.models.forecasting.conformal_models.</span></span><span class="sig-name descname"><span class="pre">ConformalQRModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/forecasting/conformal_models.html#ConformalQRModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel" title="darts.models.forecasting.conformal_models.ConformalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalModel</span></code></a></p>
<p>Conformalized Quantile Regression Model.</p>
<p>A probabilistic model that calibrates the quantile predictions from a pre-trained probabilistic global
forecasting model. It does not have to be trained and can generated calibrated forecasts
directly using the underlying trained forecasting model. It supports two symmetry modes:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>symmetric=True</cite>:</dt><dd><ul>
<li><p>The lower and upper quantile predictions are calibrated with the same magnitude.</p></li>
<li><p>Non-conformity scores: uses metric <cite>incs_qr(symmetric=True)</cite> (see Non-Conformity Score for Quantile
Regression <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.incs_qr" title="darts.metrics.metrics.incs_qr"><code class="xref py py-func docutils literal notranslate"><span class="pre">incs_qr()</span></code></a>) to compute the non-conformity scores on the calibration
set.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>symmetric=False</cite></dt><dd><ul>
<li><p>The lower and upper quantile predictions are calibrated separately.</p></li>
<li><p>Non-conformity scores: uses metric <cite>incs_qr(symmetric=False)</cite> (see Non-Conformity Score for Quantile
Regression <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.incs_qr" title="darts.metrics.metrics.incs_qr"><code class="xref py py-func docutils literal notranslate"><span class="pre">incs_qr()</span></code></a>) to compute the non-conformity scores for the upper and
lower bound separately.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Since it is a probabilistic model, you can generate forecasts in two ways (when calling <cite>predict()</cite>,
<cite>historical_forecasts()</cite>, …):</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Conformal models can be applied to any of Darts’ global forecasting model, as long as the model has been
fitted before. In general the workflow of the models to produce one calibrated forecast/prediction is as
follows:</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation with
parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since the
calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts (quantile predictions) on the calibration set (using the forecasting model)
with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (as defined above) on these historical quantile predictions</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, calibrate the predicted quantiles from the
forecasting model’s predictions.</p></li>
</ul>
<p>Some notes:</p>
<ul class="simple">
<li><p>When computing <cite>historical_forecasts()</cite>, <cite>backtest()</cite>, <cite>residuals()</cite>, … the above is applied for each
forecast (the forecasting model’s historical forecasts are only generated once for efficiency).</p></li>
<li><p>For multi-horizon forecasts, the above is applied for each step in the horizon separately.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalForecastingModel</span></code>) – <p>A pre-trained global forecasting model. See the list of models
<a class="reference external" href="https://unit8co.github.io/darts/#forecasting-models">here</a>.</p>
</p></li>
<li><p><strong>quantiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A list of quantiles centered around the median <cite>q=0.5</cite> to use. For example quantiles
[0.1, 0.2, 0.5, 0.8 0.9] correspond to two intervals with (0.9 - 0.1) = 80%, and (0.8 - 0.2) 60% coverage
around the median (model forecast).</p></li>
<li><p><strong>symmetric</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use symmetric non-conformity scores. If <cite>True</cite>, uses symmetric metric
<cite>incs_qr(…, symmetric=True)</cite> (see <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.incs_qr" title="darts.metrics.metrics.incs_qr"><code class="xref py py-func docutils literal notranslate"><span class="pre">incs_qr()</span></code></a>) to compute the non-conformity
scores. If <cite>False</cite>, uses asymmetric metric <cite>incs_qr(…, symmetric=False)</cite> with individual scores for the
lower- and upper quantile interval bounds.</p></li>
<li><p><strong>cal_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number of past forecast errors / non-conformity scores to use as calibration for each conformal
forecast (and each step in the horizon). If <cite>None</cite>, considers all scores.</p></li>
<li><p><strong>cal_stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The stride to apply when computing the historical forecasts and non-conformity scores on the calibration
set. The actual conformal forecasts can have a different stride given with parameter <cite>stride</cite> in downstream
tasks (e.g. historical forecasts, backtest, …)</p></li>
<li><p><strong>cal_num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of samples to generate for each calibration forecast (if <cite>model</cite> is a probabilistic forecasting
model). The non-conformity scores are computed on the quantile values of these forecasts (using quantiles
<cite>quantiles</cite>). Uses <cite>1</cite> for deterministic models. The actual conformal forecasts can have a different number
of samples given with parameter <cite>num_samples</cite> in downstream tasks (e.g. predict, historical forecasts, …).</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Control the randomness of probabilistic conformal forecasts (sample generation) across different runs.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Attributes</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.considers_static_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.considers_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">considers_static_covariates</span></code></a></p></td>
<td><p>Whether the model considers static covariates, if there are any.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.extreme_lags" title="darts.models.forecasting.conformal_models.ConformalQRModel.extreme_lags"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extreme_lags</span></code></a></p></td>
<td><p>A 8-tuple containing in order: (min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate lag, max future covariate lag, output shift, max target lag train (only for RNNModel)).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.likelihood" title="darts.models.forecasting.conformal_models.ConformalQRModel.likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">likelihood</span></code></a></p></td>
<td><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.min_train_samples" title="darts.models.forecasting.conformal_models.ConformalQRModel.min_train_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">min_train_samples</span></code></a></p></td>
<td><p>The minimum number of samples for training the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_length" title="darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_length</span></code></a></p></td>
<td><p>Number of time steps predicted at once by the model, not defined for statistical models.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_shift" title="darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_chunk_shift</span></code></a></p></td>
<td><p>Number of time steps that the output/prediction starts after the end of the input.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_future_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_future_covariates</span></code></a></p></td>
<td><p>Whether model supports future covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_likelihood_parameter_prediction" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_likelihood_parameter_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_likelihood_parameter_prediction</span></code></a></p></td>
<td><p>Whether model instance supports direct prediction of likelihood parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_multivariate" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_multivariate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_multivariate</span></code></a></p></td>
<td><p>Whether the model considers more than one variate in the time series.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_optimized_historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_optimized_historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_optimized_historical_forecasts</span></code></a></p></td>
<td><p>Whether the model supports optimized historical forecasts</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_past_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_past_covariates</span></code></a></p></td>
<td><p>Whether model supports past covariates</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_probabilistic_prediction" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_probabilistic_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_probabilistic_prediction</span></code></a></p></td>
<td><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_sample_weight" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_sample_weight"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_sample_weight</span></code></a></p></td>
<td><p>Whether model supports sample weight for training.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_static_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_static_covariates</span></code></a></p></td>
<td><p>Whether model supports static covariates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_transferable_series_prediction" title="darts.models.forecasting.conformal_models.ConformalQRModel.supports_transferable_series_prediction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">supports_transferable_series_prediction</span></code></a></p></td>
<td><p>Whether the model supports prediction for any input <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_future_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.uses_future_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_future_covariates</span></code></a></p></td>
<td><p>Whether the model uses future covariates, once fitted.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_past_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.uses_past_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_past_covariates</span></code></a></p></td>
<td><p>Whether the model uses past covariates, once fitted.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_static_covariates" title="darts.models.forecasting.conformal_models.ConformalQRModel.uses_static_covariates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uses_static_covariates</span></code></a></p></td>
<td><p>Whether the model uses static covariates, once fitted.</p></td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>model_params</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.backtest" title="darts.models.forecasting.conformal_models.ConformalQRModel.backtest"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backtest</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.fit" title="darts.models.forecasting.conformal_models.ConformalQRModel.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(series[, past_covariates, future_covariates])</p></td>
<td><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_encodings" title="darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_encodings</span></code></a>(series[, ...])</p></td>
<td><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_fit_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_predict_encodings" title="darts.models.forecasting.conformal_models.ConformalQRModel.generate_predict_encodings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_predict_encodings</span></code></a>(n, series[, ...])</p></td>
<td><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future covariates series with the original and encoded covariates stacked together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.gridsearch" title="darts.models.forecasting.conformal_models.ConformalQRModel.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(parameters, series[, ...])</p></td>
<td><p>Find the best hyper-parameters among a given set using a grid search.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalQRModel.historical_forecasts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">historical_forecasts</span></code></a>(series[, ...])</p></td>
<td><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the history of the provided (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.load" title="darts.models.forecasting.conformal_models.ConformalQRModel.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path[, pl_trainer_kwargs])</p></td>
<td><p>Loads a model from a given path or file handle.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.predict" title="darts.models.forecasting.conformal_models.ConformalQRModel.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(n[, series, past_covariates, ...])</p></td>
<td><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the end of the <cite>series</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.residuals" title="darts.models.forecasting.conformal_models.ConformalQRModel.residuals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">residuals</span></code></a>(series[, past_covariates, ...])</p></td>
<td><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.save" title="darts.models.forecasting.conformal_models.ConformalQRModel.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>([path, clean])</p></td>
<td><p>Saves the conformal model under a given path or file handle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.untrained_model" title="darts.models.forecasting.conformal_models.ConformalQRModel.untrained_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">untrained_model</span></code></a>()</p></td>
<td><p>Returns a new (untrained) model instance created with the same parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.backtest">
<span class="sig-name descname"><span class="pre">backtest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute error values that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>If <cite>historical_forecasts</cite> are provided, the metric(s) (given by the <cite>metric</cite> function) is evaluated directly on
all forecasts and actual values. The same <cite>series</cite> and <cite>last_points_only</cite> value must be passed that were used
to generate the historical forecasts. Finally, the method returns an optional <cite>reduction</cite> (the mean by default)
of all these metric scores.</p>
<p>If <cite>historical_forecasts</cite> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, it first generates the historical forecasts with the parameters given
below (see <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConformalModel.historical_forecasts()</span></code></a> for more info) and then
evaluates as described above.</p>
<p>The metric(s) can be further customized <cite>metric_kwargs</cite> (e.g. control the aggregation over components, time
steps, multiple series, other required arguments such as <cite>q</cite> for quantile metrics, …).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>).
You can specify which intervals to evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check
all intervals used by your conformal model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]]]) – <p>A metric function or a list of metric functions. Each metric must either be a Darts metric (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ metrics, uses decorators <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>, and returns the metric score.</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A function used to combine the individual error scores obtained when <cite>last_points_only</cite> is set to <cite>False</cite>.
When providing several metric functions, the function will receive the argument <cite>axis = 1</cite> to obtain single
value for each metric function.
If explicitly set to <cite>None</cite>, the method will return a list of the individual error scores instead.
Set to <code class="docutils literal notranslate"><span class="pre">np.mean</span></code> by default.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘component_reduction’</cite>
for reducing the component wise metrics, seasonality <cite>‘m’</cite> for scaled metrics, etc. Will pass arguments to
each metric separately and only if they are present in the corresponding metric signature. Parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …) is ignored, as it is handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>float</em> – A single backtest score for single uni/multivariate series, a single <cite>metric</cite> function and:</p>
<ul>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=True</cite></p></li>
<li><p><cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite> and using a backtest <cite>reduction</cite></p></li>
</ul>
</li>
<li><p><em>np.ndarray</em> – An numpy array of backtest scores. For single series and one of:</p>
<ul>
<li><p>a single <cite>metric</cite> function, <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>
and backtest <cite>reduction=None</cite>. The output has shape (n forecasts, <a href="#id29"><span class="problematic" id="id30">*</span></a>).</p></li>
<li><p>multiple <cite>metric</cite> functions and <cite>historical_forecasts</cite> generated with <cite>last_points_only=False</cite>.
The output has shape (<a href="#id31"><span class="problematic" id="id32">*</span></a>, n metrics) when using a backtest <cite>reduction</cite>, and (n forecasts, <a href="#id33"><span class="problematic" id="id34">*</span></a>, n metrics)
when <cite>reduction=None</cite></p></li>
<li><p>multiple uni/multivariate series including <cite>series_reduction</cite> and at least one of
<cite>component_reduction=None</cite> or <cite>time_reduction=None</cite> for “per time step metrics”</p></li>
</ul>
</li>
<li><p><em>list[float]</em> – Same as for type <cite>float</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>float</cite> metric for each input <cite>series</cite>.</p></li>
<li><p><em>list[np.ndarray]</em> – Same as for type <cite>np.ndarray</cite> but for a sequence of series. The returned metric list has length
<cite>len(series)</cite> with the <cite>np.ndarray</cite> metrics for each input <cite>series</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.considers_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">considers_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.considers_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers static covariates, if there are any.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.extreme_lags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extreme_lags</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.extreme_lags" title="Permalink to this definition">¶</a></dt>
<dd><p>A 8-tuple containing in order:
(min target lag, max target lag, min past covariate lag, max past covariate lag, min future covariate
lag, max future covariate lag, output shift, max target lag train (only for RNNModel)). If 0 is the index of the
first prediction, then all lags are relative to this index.</p>
<p>See examples below.</p>
<dl class="simple">
<dt>If the model wasn’t fitted with:</dt><dd><ul class="simple">
<li><p>target (concerning SKLearnModels only): then the first element should be <cite>None</cite>.</p></li>
<li><p>past covariates: then the third and fourth elements should be <cite>None</cite>.</p></li>
<li><p>future covariates: then the fifth and sixth elements should be <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Should be overridden by models that use past or future covariates, and/or for model that have minimum target
lag and maximum target lags potentially different from -1 and 0.</p>
<p class="rubric">Notes</p>
<p>maximum target lag (second value) cannot be <cite>None</cite> and is always larger than or equal to 0.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_chunk_shift</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-3, 1, None, None, None, None, 2, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="n">lags_past_covariates</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">past_covariates</span><span class="o">=</span><span class="n">past_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, -4, -1,  None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">lags_future_covariates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="o">=</span><span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-5, 6, None, None, 4, 6, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, None, None, 0, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">NBEATSModel</span><span class="p">(</span><span class="n">input_chunk_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">output_chunk_length</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">lags_future_covariates</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_series</span><span class="p">,</span> <span class="n">future_covariates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">extreme_lags</span>
<span class="go">(-10, 6, None, None, 4, 6, 0, None)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit/train the underlying forecasting model on (potentially multiple) series.</p>
<p>Optionally, one or multiple past and/or future covariates series can be provided as well, depending on the
forecasting model used. The number of covariates series must match the number of target series.</p>
<p class="rubric">Notes</p>
<p>Conformal Models do not require calling <cite>fit()</cite>, since they use pre-trained global forecasting models.
You can call <cite>predict()</cite> directly. Also, make sure that the input series used in <cite>predict()</cite> corresponds to
a calibration set, and not the same as used during training with <cite>fit()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – One or several target time series. The model will be trained to forecast these time series.
The series may or may not be multivariate, but if multiple series are provided
they must have the same number of components.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several past-observed covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>past_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several future-known covariate time series. These time series will not be forecast, but can
be used by some models as an input. The covariate(s) may or may not be multivariate, but if multiple
covariates are provided they must have the same number of components. If <cite>future_covariates</cite> is provided,
it must contain the same number of series as <cite>series</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>fit()</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fitted model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the covariate encodings that were used/generated for fitting the model and returns a tuple of
past, and future covariates series with the original and encoded covariates stacked together. The encodings are
generated by the encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>,
<cite>past_covariates</cite>, and  <cite>future_covariates</cite> that you used to train/fit the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with the target values used when fitting the model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the past-observed covariates used when fitting the model.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the series or sequence of series with the future-known covariates used when fitting the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_fit_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_fit_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for training and inference/prediction and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for training and prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for training and prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for training and prediction. The
dimensions must match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.generate_predict_encodings">
<span class="sig-name descname"><span class="pre">generate_predict_encodings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.generate_predict_encodings" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates covariate encodings for the inference/prediction set and returns a tuple of past, and future
covariates series with the original and encoded covariates stacked together. The encodings are generated by the
encoders defined at model creation with parameter <cite>add_encoders</cite>. Pass the same <cite>series</cite>, <cite>past_covariates</cite>,
and <cite>future_covariates</cite> that you intend to use for prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of prediction time steps after the end of <cite>series</cite> intended to be used for prediction.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – The series or sequence of series with target values intended to be used for prediction.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the past-observed covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the future-known covariates series intended to be used for prediction. The dimensions must
match those of the covariates used for training.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of (past covariates, future covariates). Each covariate contains the original as well as the
encoded covariates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]], Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.gridsearch">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gridsearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_series=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fitted_values=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">mape&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction=&lt;function</span> <span class="pre">mean&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_random_samples=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the best hyper-parameters among a given set using a grid search.</p>
<p>This function has 3 modes of operation: Expanding window mode, split mode and fitted value mode.
The three modes of operation evaluate every possible combination of hyper-parameter values
provided in the <cite>parameters</cite> dictionary by instantiating the <cite>model_class</cite> subclass
of ForecastingModel with each combination, and returning the best-performing model with regard
to the <cite>metric</cite> function. The <cite>metric</cite> function is expected to return an error value,
thus the model resulting in the smallest <cite>metric</cite> output will be chosen.</p>
<p>The relationship of the training data and test data depends on the mode of operation.</p>
<p>Expanding window mode (activated when <cite>forecast_horizon</cite> is passed):
For every hyperparameter combination, the model is repeatedly trained and evaluated on different
splits of <cite>series</cite>. This process is accomplished by using
the <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalQRModel.backtest" title="darts.models.forecasting.conformal_models.ConformalQRModel.backtest"><code class="xref py py-func docutils literal notranslate"><span class="pre">backtest()</span></code></a> function as a subroutine to produce historic forecasts starting from <cite>start</cite>
that are compared against the ground truth values of <cite>series</cite>.
Note that the model is retrained for every single prediction, thus this mode is slower.</p>
<p>Split window mode (activated when <cite>val_series</cite> is passed):
This mode will be used when the <cite>val_series</cite> argument is passed.
For every hyper-parameter combination, the model is trained on <cite>series</cite> and
evaluated on <cite>val_series</cite>.</p>
<p>Fitted value mode (activated when <cite>use_fitted_values</cite> is set to <cite>True</cite>):
For every hyper-parameter combination, the model is trained on <cite>series</cite>
and evaluated on the resulting fitted values.
Not all models have fitted values, and this method raises an error if the model doesn’t have a <cite>fitted_values</cite>
member. The fitted values are the result of the fit of the model on <cite>series</cite>. Comparing with the
fitted values can be a quick way to assess the model, but one cannot see if the model is overfitting the series.</p>
<p>Derived classes must ensure that a single instance of a model will not share parameters with the other
instances, e.g., saving models in the same path. Otherwise, an unexpected behavior can arise while running
several models in parallel (when <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">!=</span> <span class="pre">1</span></code>). If this cannot be avoided, then gridsearch
should be redefined, forcing <code class="docutils literal notranslate"><span class="pre">n_jobs</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Currently this method only supports deterministic predictions (i.e. when models’ predictions
have only 1 sample).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_class</strong> – The ForecastingModel subclass to be tuned for ‘series’.</p></li>
<li><p><strong>parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A dictionary containing as keys hyperparameter names, and as values lists of values for the
respective hyperparameter.</p></li>
<li><p><strong>series</strong> (<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>) – The target series used as input and target for training.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a past-observed covariate series. This applies only if the model supports past covariates.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a future-known covariate series. This applies only if the model supports future covariates.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The integer value of the forecasting horizon. Activates expanding window mode.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Only used in expanding window mode. The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Only used in expanding window mode. Optionally, the first point in time at which a prediction is computed.
This parameter supports: <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If a <code class="docutils literal notranslate"><span class="pre">float</span></code>, it is the proportion of the time series that should lie before the first prediction point.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a Callable and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<dl class="simple">
<dt>Note: If <cite>start</cite> is not within the trainable / forecastable points, uses the closest valid start point that</dt><dd><p>is a round multiple of <cite>stride</cite> ahead of <cite>start</cite>. Raises a <cite>ValueError</cite>, if no valid start point exists.</p>
</dd>
<dt>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also</dt><dd><p>shifted by <cite>output_chunk_shift</cite> points into the future.</p>
</dd>
<dt>Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter</dt><dd><p>(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</dd>
</dl>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Only used in expanding window mode. Defines the <cite>start</cite> format. Only effective when <cite>start</cite> is an integer
and <cite>series</cite> is indexed with a <cite>pd.RangeIndex</cite>.
If set to ‘position’, <cite>start</cite> corresponds to the index position of the first predicted point and can range
from <cite>(-len(series), len(series) - 1)</cite>.
If set to ‘value’, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code></p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to use the whole forecasts or only the last point of each
forecast to compute the error.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Only used in expanding window mode. Whether to show warnings related to the <cite>start</cite> parameter.</p></li>
<li><p><strong>val_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The TimeSeries instance used for validation in split mode. If provided, this series must start right after
the end of <cite>series</cite>; so that a proper comparison of the forecast can be made.</p></li>
<li><p><strong>use_fitted_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If <cite>True</cite>, uses the comparison with the fitted values.
Raises an error if <code class="docutils literal notranslate"><span class="pre">fitted_values</span></code> is not an attribute of <cite>model_class</cite>.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – <p>A metric function that returns the error between two <cite>TimeSeries</cite> as a float value . Must either be one of
Darts’ “aggregated over time” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that as input two
<cite>TimeSeries</cite> and returns the error</p>
</p></li>
<li><p><strong>reduction</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – A reduction function (mapping array to float) describing how to aggregate the errors obtained
on the different validation series when backtesting. By default it’ll compute the mean of errors.</p></li>
<li><p><strong>verbose</strong> – Whether to print the progress.</p></li>
<li><p><strong>n_jobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of jobs to run in parallel. Parallel jobs are created only when there are two or more parameters
combinations to evaluate. Each job will instantiate, train, and evaluate a different instance of the model.
Defaults to <cite>1</cite> (sequential). Setting the parameter to <cite>-1</cite> means using all the available cores.</p></li>
<li><p><strong>n_random_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – The number/ratio of hyperparameter combinations to select from the full parameter grid. This will perform
a random search instead of using the full grid.
If an integer, <cite>n_random_samples</cite> is the number of parameter combinations selected from the full grid and
must be between <cite>0</cite> and the total number of parameter combinations.
If a float, <cite>n_random_samples</cite> is the ratio of parameter combinations selected from the full grid and must
be between <cite>0</cite> and <cite>1</cite>. Defaults to <cite>None</cite>, for which random selection will be ignored.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step.</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>fit()</cite> method.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some sample weights to apply to the target <cite>series</cite> labels for training. Only effective when
<cite>retrain</cite> is not <code class="docutils literal notranslate"><span class="pre">False</span></code>. They are applied per observation, per label (each step in
<cite>output_chunk_length</cite>), and per component.
If a series, then those weights are used. If the weight series only have a single component / column, then
the weights are applied globally to all components in <cite>series</cite>. Otherwise, for component-specific weights,
the number of components must match those of <cite>series</cite>.
If a string, then the weights are generated using built-in weighting functions. The available options are
<cite>“linear”</cite> or <cite>“exponential”</cite> decay - the further in the past, the lower the weight.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing an untrained <cite>model_class</cite> instance created from the best-performing hyper-parameters,
along with a dictionary containing these best hyper-parameters,
and metric score for the best hyper-parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel" title="darts.models.forecasting.forecasting_model.ForecastingModel">ForecastingModel</a>, Dict, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.historical_forecasts">
<span class="sig-name descname"><span class="pre">historical_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates calibrated historical forecasts by simulating predictions at various points in time throughout the
history of the provided (potentially multiple) <cite>series</cite>. This process involves retrospectively applying the
model to different time steps, as if the forecasts were made in real-time at those specific moments. This
allows for an evaluation of the model’s performance over the entire duration of the series, providing insights
into its predictive accuracy and robustness across different historical periods.</p>
<p>Currently, conformal models only support the pre-trained historical forecasts mode (<cite>retrain=False</cite>).
Parameters <cite>retrain</cite> and <cite>train_length</cite> are ignored.</p>
<p><strong>Pre-trained Mode:</strong> First, all historical forecasts are generated using the underlying pre-trained global
forecasting model (see <a class="reference internal" href="darts.models.forecasting.forecasting_model.html#darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts" title="darts.models.forecasting.forecasting_model.ForecastingModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ForecastingModel.historical_forecasts()</span></code></a> for more info). Then it
repeatedly builds a calibration set by either expanding from the beginning of the historical forecasts or by
using a fixed-length moving window with length <cite>cal_length</cite> (the start point can also be configured with
<cite>start</cite> and <cite>start_format</cite>).
The next forecast of length <cite>forecast_horizon</cite> is then calibrated on this calibration set. Subsequently, the
end of the calibration set is moved forward by <cite>stride</cite> time steps, and the process is repeated.</p>
<p>By default, with <cite>last_points_only=True</cite>, this method returns a single time series (or a sequence of time
series when <cite>series</cite> is also a sequence of series) composed of the last point from each calibrated historical
forecast. This time series will thus have a frequency of <cite>series.freq * stride</cite>.
If <cite>last_points_only=False</cite>, it will instead return a list (or a sequence of lists) with all calibrated
historical forecasts of length <cite>forecast_horizon</cite> and frequency <cite>series.freq</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions. Must be a round-multiple of <cite>cal_stride</cite>
(set at model creation) and <cite>&gt;=cal_stride</cite>.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.</p>
</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – A single historical forecast for a single <cite>series</cite> and <cite>last_points_only=True</cite>: it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of historical forecasts for:</p>
<ul>
<li><p>a sequence (list) of <cite>series</cite> and <cite>last_points_only=True</cite>: for each series, it contains only the
predictions at step <cite>forecast_horizon</cite> from all historical forecasts.</p></li>
<li><p>a single <cite>series</cite> and <cite>last_points_only=False</cite>: for each historical forecast, it contains the entire
horizon <cite>forecast_horizon</cite>.</p></li>
</ul>
</li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of historical forecasts for a sequence of <cite>series</cite> and <cite>last_points_only=False</cite>. For each
series, and historical forecast, it contains the entire horizon <cite>forecast_horizon</cite>. The outer list
is over the series provided in the input sequence, and the inner lists contain the historical forecasts for
each series.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.likelihood">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">likelihood</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><span class="pre">Likelihood</span></a></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the likelihood (if any) that the model uses for probabilistic forecasts.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.utils.likelihood_models.base.html#darts.utils.likelihood_models.base.Likelihood" title="darts.utils.likelihood_models.base.Likelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">Likelihood</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_trainer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model from a given path or file handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>]) – Path or file handle from which to load the model.</p></li>
<li><p><strong>pl_trainer_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Optionally, a set of kwargs to create a new Lightning Trainer used to configure the model for downstream
tasks (e.g. prediction).
Some examples include specifying the batch size or moving the model to CPU/GPU(s). Check the
<a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/trainer.html">Lightning Trainer documentation</a>
for more information about the supported kwargs.</p>
</p></li>
<li><p><strong>**kwargs</strong> – <p>Only effective if the underlying forecasting model is a <cite>TorchForecastingModel</cite>.
Additional kwargs for PyTorch Lightning’s <code class="xref py py-func docutils literal notranslate"><span class="pre">LightningModule.load_from_checkpoint()</span></code> method,
For more information, read the <a class="reference external" href="https://pytorch-lightning.readthedocs.io/en/stable/common/lightning_module.html#load-from-checkpoint">official documentation</a>.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel" title="darts.models.forecasting.conformal_models.ConformalModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.min_train_samples">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">min_train_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.min_train_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum number of samples for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.model_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.model_params" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_length">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps predicted at once by the model, not defined for statistical models.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_shift">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_chunk_shift</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.output_chunk_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of time steps that the output/prediction starts after the end of the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Forecasts calibrated quantile intervals (or samples from calibrated intervals) for <cite>n</cite> time steps after the
end of the <cite>series</cite>.</p>
<p>It is important that the input series for prediction correspond to a calibration set - a set different to the
series that the underlying forecasting <cite>model</cite> was trained on.</p>
<p>Since it is a probabilistic model, you can generate forecasts in two ways:</p>
<ul class="simple">
<li><p>Predict the calibrated quantile intervals directly: Pass parameters <cite>predict_likelihood_parameters=True</cite>, and
<cite>num_samples=1</cite> to the forecast method.</p></li>
<li><p>Predict stochastic samples from the calibrated quantile intervals: Pass parameters
<cite>predict_likelihood_parameters=False</cite>, and <cite>num_samples&gt;&gt;1</cite> to the forecast method.</p></li>
</ul>
<p>Under the hood, the simplified workflow to produce one calibrated forecast/prediction for every step in the
horizon <cite>n</cite> is as follows (note: <cite>cal_length</cite> and <cite>cal_stride</cite> can be set at model creation):</p>
<ul class="simple">
<li><p>Extract a calibration set: The calibration set for each conformal forecast is automatically extracted from
the most recent past of your input series relative to the forecast start point. The number of calibration
examples (forecast errors / non-conformity scores) to consider can be defined at model creation
with parameter <cite>cal_length</cite>. Note that when using <cite>cal_stride&gt;1</cite>, a longer history is required since
the calibration examples are generated with stridden historical forecasts.</p></li>
<li><p>Generate historical forecasts on the calibration set (using the forecasting model) with a stride <cite>cal_stride</cite>.</p></li>
<li><p>Compute the errors/non-conformity scores (specific to each conformal model) on these historical forecasts</p></li>
<li><p>Compute the quantile values from the errors / non-conformity scores (using our desired quantiles set at model
creation with parameter <cite>quantiles</cite>).</p></li>
<li><p>Compute the conformal prediction: Using these quantile values, add calibrated intervals to (or adjust the
existing intervals of) the forecasting model’s predictions.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Forecast horizon - the number of time steps after the end of the series for which to produce predictions.</p></li>
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A series or sequence of series, representing the history of the target series whose future is to be
predicted. Will use the past of this series for calibration. The series should not have any overlap with
the series used to train the forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related auto-regression and past covariates usage.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
<li><p><strong>**kwargs</strong> – Optional keyword arguments that will passed to the underlying forecasting model’s <cite>predict()</cite> and
<cite>historical_forecasts()</cite> methods.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>series</cite> is not specified, this function returns a single time series containing the <cite>n</cite>
next points after then end of the training series.
If <cite>series</cite> is given and is a simple <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code>, this function returns the <cite>n</cite> next points
after the end of <cite>series</cite>.
If <cite>series</cite> is given and is a sequence of several time series, this function returns
a sequence where each element contains the corresponding <cite>n</cite> points forecasts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>, Sequence[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.residuals">
<span class="sig-name descname"><span class="pre">residuals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_covariates=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_forecasts=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_horizon=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_length=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_format='value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrain=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_end=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_points_only=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric=&lt;function</span> <span class="pre">err&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_warnings=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_likelihood_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_optimization=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_transformers=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predict_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_only=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.residuals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residuals that the model produced for historical forecasts on (potentially multiple) <cite>series</cite>.</p>
<p>This function computes the difference (or one of Darts’ “per time step” metrics) between the actual
observations from <cite>series</cite> and the fitted values obtained by training the model on <cite>series</cite> (or using a
pre-trained model with <cite>retrain=False</cite>). Not all models support fitted values, so we use historical forecasts
as an approximation for them.</p>
<p>In sequence this method performs:</p>
<ul class="simple">
<li><p>use pre-computed <cite>historical_forecasts</cite> or compute historical forecasts for each series (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a> for more details).
How the historical forecasts are generated can be configured with parameters <cite>num_samples</cite>, <cite>train_length</cite>,
<cite>start</cite>, <cite>start_format</cite>, <cite>forecast_horizon</cite>, <cite>stride</cite>, <cite>retrain</cite>, <cite>last_points_only</cite>, <cite>fit_kwargs</cite>, and
<cite>predict_kwargs</cite>.</p></li>
<li><p>compute a backtest using a “per time step” <cite>metric</cite> between the historical forecasts and <cite>series</cite> per
component/column and time step (see
<a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.backtest" title="darts.models.forecasting.conformal_models.ConformalModel.backtest"><code class="xref py py-meth docutils literal notranslate"><span class="pre">backtest()</span></code></a> for more details). By default,
uses the residuals <a class="reference internal" href="darts.metrics.metrics.html#darts.metrics.metrics.err" title="darts.metrics.metrics.err"><code class="xref py py-func docutils literal notranslate"><span class="pre">err()</span></code></a> (error) as a <cite>metric</cite>.</p></li>
<li><p>create and return <cite>TimeSeries</cite> (or simply a np.ndarray with <cite>values_only=True</cite>) with the time index from
historical forecasts, and values from the metrics per component and time step.</p></li>
</ul>
<p>This method works for single or multiple univariate or multivariate series.
It uses the median prediction (when dealing with stochastic forecasts).</p>
<p class="rubric">Notes</p>
<p>Darts has several metrics to evaluate probabilistic forecasts. For conformal models, we recommend using
“per time step” quantile interval metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>). You can specify which intervals to
evaluate by setting <cite>metric_kwargs={‘q_interval’: my_intervals}</cite>. To check all intervals used by your conformal
model <cite>my_model</cite>, you can set <code class="docutils literal notranslate"><span class="pre">{'q_interval':</span> <span class="pre">my_model.q_interval}</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]) – A (sequence of) target time series used to successively compute the historical forecasts. Will use the past
of this series for calibration. The series should not have any overlap with the series used to train the
forecasting model.</p></li>
<li><p><strong>past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) past-observed covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a (sequence of) future-known covariate time series for every input time series in <cite>series</cite>.
Their dimension must match that of the past covariates used for training. Will use this series for
calibration.</p></li>
<li><p><strong>historical_forecasts</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the (or a sequence of / a sequence of sequences of) historical forecasts time series to be
evaluated. Corresponds to the output of <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts" title="darts.models.forecasting.conformal_models.ConformalModel.historical_forecasts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">historical_forecasts()</span></code></a>. The same <cite>series</cite> and
<cite>last_points_only</cite> values must be passed that were used to generate the historical forecasts. If provided,
will skip historical forecasting and ignore all parameters except <cite>series</cite>, <cite>last_points_only</cite>, <cite>metric</cite>,
and <cite>reduction</cite>.</p></li>
<li><p><strong>forecast_horizon</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The forecast horizon for the predictions.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of times a prediction is sampled from the calibrated quantile predictions using linear
interpolation in-between the quantiles. For larger values, the sample distribution approximates the
calibrated quantile predictions.</p></li>
<li><p><strong>train_length</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>start</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Timestamp</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, the first point in time at which a prediction is computed. This parameter supports:
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, and <code class="docutils literal notranslate"><span class="pre">None</span></code>.
If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, it is either the index position of the first prediction point for <cite>series</cite> with a
<cite>pd.DatetimeIndex</cite>, or the index value for <cite>series</cite> with a <cite>pd.RangeIndex</cite>. The latter can be changed to
the index position with <cite>start_format=”position”</cite>.
If a <code class="docutils literal notranslate"><span class="pre">pandas.Timestamp</span></code>, it is the time stamp of the first prediction point.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the first prediction point will automatically be set to:</p>
<ul>
<li><p>the first predictable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, or <cite>retrain</cite> is a Callable and the first
predictable point is earlier than the first trainable point.</p></li>
<li><p>the first trainable point if <cite>retrain</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> (given <cite>train_length</cite>),
or <cite>retrain</cite> is a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> and the first trainable point is earlier than the first predictable point.</p></li>
<li><p>the first trainable point (given <cite>train_length</cite>) otherwise</p></li>
</ul>
<p>Note: If the model uses a shifted output (<cite>output_chunk_shift &gt; 0</cite>), then the first predicted point is also
shifted by <cite>output_chunk_shift</cite> points into the future.
Note: Raises a ValueError if <cite>start</cite> yields a time outside the time index of <cite>series</cite>.
Note: If <cite>start</cite> is outside the possible historical forecasting times, will ignore the parameter
(default behavior with <code class="docutils literal notranslate"><span class="pre">None</span></code>) and start at the first trainable/predictable point.</p>
</p></li>
<li><p><strong>start_format</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[‘position’, ‘value’]) – Defines the <cite>start</cite> format.
If set to <code class="docutils literal notranslate"><span class="pre">'position'</span></code>, <cite>start</cite> corresponds to the index position of the first predicted point and can
range from <cite>(-len(series), len(series) - 1)</cite>.
If set to <code class="docutils literal notranslate"><span class="pre">'value'</span></code>, <cite>start</cite> corresponds to the index value/label of the first predicted point. Will raise
an error if the value is not in <cite>series</cite>’ index. Default: <code class="docutils literal notranslate"><span class="pre">'value'</span></code>.</p></li>
<li><p><strong>stride</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The number of time steps between two consecutive predictions.</p></li>
<li><p><strong>retrain</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]]) – Currently ignored by conformal models.</p></li>
<li><p><strong>overlap_end</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether the returned forecasts can go beyond the series’ end or not.</p></li>
<li><p><strong>last_points_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return only the last point of each historical forecast. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the method returns a
single <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> (for each time series in <cite>series</cite>) containing the successive point forecasts.
Otherwise, returns a list of historical <code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> forecasts.</p></li>
<li><p><strong>metric</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[…, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]]]) – <p>Either one of Darts’ “per time step” metrics (see <a class="reference external" href="https://unit8co.github.io/darts/generated_api/darts.metrics.html">here</a>), or a custom metric that has an
identical signature as Darts’ “per time step” metrics, uses decorators
<code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">multi_ts_support()</span></code>,
and returns one value per time step.</p>
</p></li>
<li><p><strong>verbose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to print the progress.</p></li>
<li><p><strong>show_warnings</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to show warnings related to historical forecasts optimization, or parameters <cite>start</cite> and
<cite>train_length</cite>.</p></li>
<li><p><strong>predict_likelihood_parameters</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If set to <cite>True</cite>, generates the quantile predictions directly. Only supported with <cite>num_samples = 1</cite>.</p></li>
<li><p><strong>enable_optimization</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to use the optimized version of <cite>historical_forecasts</cite> when supported and available.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>data_transformers</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html#darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer" title="darts.dataprocessing.transformers.base_data_transformer.BaseDataTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDataTransformer</span></code></a>, <a class="reference internal" href="darts.dataprocessing.pipeline.html#darts.dataprocessing.pipeline.Pipeline" title="darts.dataprocessing.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>]], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – <p>Optionally, a dictionary of <cite>BaseDataTransformer</cite> or <cite>Pipeline</cite> to apply to the corresponding series
(possibles keys; “series”, “past_covariates”, “future_covariates”). If provided, all input series must be
in the un-transformed space. For fittable transformer / pipeline:</p>
<ul>
<li><p>if <cite>retrain=True</cite>, the data transformer re-fit on the training data at each historical forecast step
(currently ignored by conformal models).</p></li>
<li><p>if <cite>retrain=False</cite>, the data transformer transforms the series once before all the forecasts.</p></li>
</ul>
<p>The fitted transformer is used to transform the input during both training and prediction.
If the transformation is invertible, the forecasts will be inverse-transformed.
Only effective when <cite>historical_forecasts=None</cite>.</p>
</p></li>
<li><p><strong>metric_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Additional arguments passed to <cite>metric()</cite>, such as <cite>‘n_jobs’</cite> for parallelization, <cite>‘m’</cite> for scaled
metrics, etc. Will pass arguments only if they are present in the corresponding metric signature. Ignores
reduction arguments <cite>“series_reduction”, “component_reduction”, “time_reduction”</cite>, and parameter
<cite>‘insample’</cite> for scaled metrics (e.g. mase`, <cite>rmsse</cite>, …), as they are handled internally.</p></li>
<li><p><strong>fit_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>predict_kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, some additional arguments passed to the model <cite>predict()</cite> method.</p></li>
<li><p><strong>sample_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Currently ignored by conformal models.</p></li>
<li><p><strong>values_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Whether to return the residuals as <cite>np.ndarray</cite>. If <cite>False</cite>, returns residuals as <cite>TimeSeries</cite>.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Controls the randomness of probabilistic predictions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>TimeSeries</em> – Residual <cite>TimeSeries</cite> for a single <cite>series</cite> and <cite>historical_forecasts</cite> generated with
<cite>last_points_only=True</cite>.</p></li>
<li><p><em>list[TimeSeries]</em> – A list of residual <cite>TimeSeries</cite> for a sequence (list) of <cite>series</cite> with <cite>last_points_only=True</cite>.
The residual list has length <cite>len(series)</cite>.</p></li>
<li><p><em>list[list[TimeSeries]]</em> – A list of lists of residual <cite>TimeSeries</cite> for a sequence of <cite>series</cite> with <cite>last_points_only=False</cite>.
The outer residual list has length <cite>len(series)</cite>. The inner lists consist of the residuals from
all possible series-specific historical forecasts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pkl_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the conformal model under a given path or file handle.</p>
<p>Additionally, two files are stored if <cite>self.model</cite> is a <cite>TorchForecastingModel</cite>.</p>
<p>Example for saving and loading a <a class="reference internal" href="#darts.models.forecasting.conformal_models.ConformalNaiveModel" title="darts.models.forecasting.conformal_models.ConformalNaiveModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConformalNaiveModel</span></code></a>:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConformalNaiveModel</span><span class="p">,</span> <span class="n">LinearRegressionModel</span>

<span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">forecasting_model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">forecasting_model</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
<span class="n">model_loaded</span> <span class="o">=</span> <span class="n">ConformalNaiveModel</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;my_model.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PathLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BinaryIO</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Path or file handle under which to save the ensemble model at its current state. If no path is specified,
the ensemble model is automatically saved under <code class="docutils literal notranslate"><span class="pre">&quot;{ConformalNaiveModel}_{YYYY-mm-dd_HH_MM_SS}.pkl&quot;</span></code>.
If the forecasting model is a <cite>TorchForecastingModel</cite>, two files (model object and checkpoint) are saved
under <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.pt&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;{path}.{ModelClass}.ckpt&quot;</span></code>.</p></li>
<li><p><strong>clean</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <p>Whether to store a cleaned version of the model. If <cite>True</cite>, the training series and covariates are removed.
If the underlying forecasting <cite>model</cite> is a <cite>TorchForecastingModel</cite>, will additionally remove all Lightning
Trainer-related parameters.</p>
<p>Note: After loading a model stored with <cite>clean=True</cite>, a <cite>series</cite> must be passed ‘predict()’,
<cite>historical_forecasts()</cite> and other forecasting methods.</p>
</p></li>
<li><p><strong>pkl_kwargs</strong> – Keyword arguments passed to <cite>pickle.dump()</cite></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports future covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_likelihood_parameter_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_likelihood_parameter_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_likelihood_parameter_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model instance supports direct prediction of likelihood parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_multivariate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_multivariate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_multivariate" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model considers more than one variate in the time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_optimized_historical_forecasts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_optimized_historical_forecasts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_optimized_historical_forecasts" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports optimized historical forecasts</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports past covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_probabilistic_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_probabilistic_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_probabilistic_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the forecasting model with this configuration supports probabilistic predictions.</p>
<p>By default, returns False. Needs to be overwritten by models that do support
probabilistic predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_sample_weight">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_sample_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_sample_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports sample weight for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether model supports static covariates</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.supports_transferable_series_prediction">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">supports_transferable_series_prediction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.supports_transferable_series_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model supports prediction for any input <cite>series</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.untrained_model">
<span class="sig-name descname"><span class="pre">untrained_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.untrained_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new (untrained) model instance created with the same parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.uses_future_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_future_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_future_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses future covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.uses_past_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_past_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_past_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses past covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="darts.models.forecasting.conformal_models.ConformalQRModel.uses_static_covariates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uses_static_covariates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#darts.models.forecasting.conformal_models.ConformalQRModel.uses_static_covariates" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the model uses static covariates, once fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="darts.models.forecasting.catboost_model.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">CatBoost Models</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="darts.models.forecasting.dlinear.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">D-Linear</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2025, Unit8 SA (Apache 2.0 License).<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>