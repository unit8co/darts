
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Shap Explainer for SKLearnModels &#8212; darts  documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="shortcut icon" href="../_static/docs-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TFT Explainer for Temporal Fusion Transformer (TFTModel)" href="darts.explainability.tft_explainer.html" />
    <link rel="prev" title="Explainability Result" href="darts.explainability.explainability_result.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/darts-logo-trim.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../README.html">
  Home
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../quickstart/00-quickstart.html">
  Quickstart
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../userguide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="darts.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../release_notes/RELEASE_NOTES.html">
  Release Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/unit8co/darts" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/unit8co" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.ad.html">
   Anomaly Detection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.aggregators.html">
     Anomaly Aggregators
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.and_aggregator.html">
       AND Aggregator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.ensemble_sklearn_aggregator.html">
       Ensemble scikit-learn aggregator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.aggregators.or_aggregator.html">
       OR Aggregator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.anomaly_model.html">
     Anomaly Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.anomaly_model.filtering_am.html">
       Filtering Anomaly Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.anomaly_model.forecasting_am.html">
       Forecasting Anomaly Model
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.detectors.html">
     Anomaly Detectors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.iqr_detector.html">
       Interquartile Range (IQR) Detector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.quantile_detector.html">
       Quantile Detector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.detectors.threshold_detector.html">
       Threshold Detector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.ad.scorers.html">
     Anomaly Scorers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.difference_scorer.html">
       Difference Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.kmeans_scorer.html">
       k-means Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_cauchy_scorer.html">
       NLL Cauchy Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_exponential_scorer.html">
       NLL Exponential Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_gamma_scorer.html">
       NLL Gamma Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_gaussian_scorer.html">
       NLL Gaussian Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_laplace_scorer.html">
       NLL Laplace Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.nll_poisson_scorer.html">
       NLL Poisson Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.norm_scorer.html">
       Norm Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.pyod_scorer.html">
       PyOD Scorer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.ad.scorers.wasserstein_scorer.html">
       Wasserstein Scorer
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.ad.utils.html">
     Utils for Anomaly Detection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.dataprocessing.html">
   Data Processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.dtw.html">
     Dynamic Time Warping (DTW)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.dtw.dtw.html">
       Dynamic Time Warping (DTW)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.dtw.window.html">
       DTW Windows
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.encoders.html">
     Time Axis Encoders
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.encoders.encoder_base.html">
       Encoder Base Classes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.encoders.encoders.html">
       Time Axes Encoders
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.dataprocessing.transformers.html">
     Data Transformers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.base_data_transformer.html">
       Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.boxcox.html">
       Box-Cox Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.diff.html">
       Differencing Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.fittable_data_transformer.html">
       Fittable Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.invertible_data_transformer.html">
       Invertible Data Transformer Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.mappers.html">
       Mapper and InvertibleMapper
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.midas.html">
       Mixed-data sampling (MIDAS) Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.missing_values_filler.html">
       Missing Values Filler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.reconciliation.html">
       Hierarchical Reconciliation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.scaler.html">
       Scaler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.static_covariates_transformer.html">
       Static Covariates Transformer
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.dataprocessing.transformers.window_transformer.html">
       Window Transformer
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.dataprocessing.pipeline.html">
     Pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.datasets.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="darts.explainability.html">
   Explainability
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="darts.explainability.explainability_result.html">
     Explainability Result
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Shap Explainer for SKLearnModels
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.explainability.tft_explainer.html">
     TFT Explainer for Temporal Fusion Transformer (TFTModel)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.metrics.html">
   Metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.metrics.metrics.html">
     Metrics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.models.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.models.filtering.html">
     Filtering Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.gaussian_process_filter.html">
       Gaussian Processes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.kalman_filter.html">
       Kalman Filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.filtering.moving_average_filter.html">
       Moving Average
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.models.forecasting.html">
     Forecasting Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.arima.html">
       ARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.baselines.html">
       Baseline Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.block_rnn_model.html">
       Block Recurrent Neural Networks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.catboost_model.html">
       CatBoost Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.conformal_models.html">
       Conformal Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.dlinear.html">
       D-Linear
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.exponential_smoothing.html">
       Exponential Smoothing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.fft.html">
       Fast Fourier Transform
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.global_baseline_models.html">
       Global Baseline Models (Naive)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.kalman_forecaster.html">
       Kalman Filter Forecaster
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.lgbm.html">
       LightGBM Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.linear_regression_model.html">
       Linear Regression Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nbeats.html">
       N-BEATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nhits.html">
       N-HiTS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.nlinear.html">
       N-Linear
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.prophet_model.html">
       Facebook Prophet
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.random_forest.html">
       Random Forest
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.regression_ensemble_model.html">
       Regression Ensemble Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.rnn_model.html">
       Recurrent Neural Networks
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_arima.html">
       AutoARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_ces.html">
       AutoCES
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_ets.html">
       AutoETS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_mfles.html">
       AutoMFLES
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_tbats.html">
       AutoTBATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_auto_theta.html">
       AutoTheta
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_croston.html">
       Croston Method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_model.html">
       StatsForecastModel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sf_tbats.html">
       TBATS
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.sklearn_model.html">
       SKLearn-Like Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tcn_model.html">
       Temporal Convolutional Network
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tft_model.html">
       Temporal Fusion Transformer (TFT)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.theta.html">
       Theta Method
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tide_model.html">
       Time-series Dense Encoder (TiDE)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.transformer_model.html">
       Transformer Model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.tsmixer_model.html">
       Time-Series Mixer (TSMixer)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.varima.html">
       VARIMA
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.models.forecasting.xgboost.html">
       XGBoost Models
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="darts.utils.html">
   Utils
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.utils.data.html">
     TimeSeries Datasets
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.dataset.html">
       Dataset Base Class
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.inference_dataset.html">
       Inference Datasets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.data.torch_datasets.training_dataset.html">
       Training Datasets
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="darts.utils.likelihood_models.html">
     Likelihood Models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.sklearn.html">
       Likelihoods for
       <cite>
        SKLearnModel
       </cite>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.statsforecast.html">
       Likelihoods for
       <cite>
        StatsForecast
       </cite>
       Models
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="darts.utils.likelihood_models.torch.html">
       Likelihoods for
       <cite>
        TorchForecastingModel
       </cite>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.losses.html">
     PyTorch Loss Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.missing_values.html">
     Utils for filling missing values
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.model_selection.html">
     Model selection utilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.statistics.html">
     Time Series Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.timeseries_generation.html">
     Utils for time series generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.torch.html">
     Utils for Pytorch and its usage
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.ts_utils.html">
     Additional util functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="darts.utils.utils.html">
     Additional util functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="darts.timeseries.html">
   Timeseries
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <span class="target" id="module-darts.explainability.shap_explainer"></span><section id="shap-explainer-for-sklearnmodels">
<h1>Shap Explainer for SKLearnModels<a class="headerlink" href="#shap-explainer-for-sklearnmodels" title="Permalink to this heading">¶</a></h1>
<p>A <a class="reference external" href="https://github.com/slundberg/shap">shap explainer</a> specifically for time series
forecasting models.</p>
<p>This class is (currently) limited to Darts’ <cite>SKLearnModel</cite> instances of forecasting models. It uses shap values to
provide “explanations” of each input features. The input features are the different past lags (of the target and/or
past covariates), as well as potential future lags of future covariates used as inputs by the forecasting model to
produce its forecasts. Furthermore, in the case of multivariate series, the features contain each dimension of
each of the (lagged) series.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This explainer is subject to the usual features independence assumption used to compute shap values.
This means that it does not capture potential indirect influence that some lags
may have on the target by influencing other lags.</p>
</div>
<ul>
<li><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.explain" title="darts.explainability.shap_explainer.ShapExplainer.explain"><code class="xref py py-func docutils literal notranslate"><span class="pre">explain()</span></code></a> generates the explanations for a given foreground series (or
background series, if foreground is not provided).</p></li>
<li><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.summary_plot" title="darts.explainability.shap_explainer.ShapExplainer.summary_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">summary_plot()</span></code></a> displays a shap plot summary for each horizon and each
component dimension of the target series.</p></li>
<li><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts" title="darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts"><code class="xref py py-func docutils literal notranslate"><span class="pre">force_plot_from_ts()</span></code></a> displays a shap force_plot for one target
and one horizon, for a given target series. It displays shap values of each lag/covariate with an additive force</p>
<blockquote>
<div><p>layout.</p>
</div></blockquote>
</li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="darts.explainability.shap_explainer.ShapExplainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">darts.explainability.shap_explainer.</span></span><span class="sig-name descname"><span class="pre">ShapExplainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shap_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/explainability/shap_explainer.html#ShapExplainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.explainability.shap_explainer.ShapExplainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_ForecastingModelExplainer</span></code></p>
<p><strong>Definitions</strong></p>
<ul class="simple">
<li><p>A background series is a <cite>TimeSeries</cite> used to train the shap explainer.</p></li>
<li><p>A foreground series is a <cite>TimeSeries</cite> that can be explained by a shap explainer after it has been fitted.</p></li>
</ul>
<p>Currently, <cite>ShapExplainer</cite> only works with <cite>SKLearnModel</cite> forecasting models.
The number of explained horizons (t+1, t+2, …) can be at most equal to <cite>output_chunk_length</cite> of <cite>model</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="darts.models.forecasting.sklearn_model.html#darts.models.forecasting.sklearn_model.SKLearnModel" title="darts.models.forecasting.sklearn_model.SKLearnModel"><em>darts.models.forecasting.sklearn_model.SKLearnModel</em></a>) – A <cite>SKLearnModel</cite> to be explained. It must be fitted first.</p></li>
<li><p><strong>background_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – One or several series to <em>train</em> the <cite>ShapExplainer</cite> along with any foreground series.
Consider using a reduced well-chosen background to reduce computation time.
Optional if <cite>model</cite> was fit on a single target series. By default, it is the <cite>series</cite> used at fitting time.
Mandatory if <cite>model</cite> was fit on multiple (list of) target series.</p></li>
<li><p><strong>background_past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A past covariates series or list of series that the model needs once fitted.</p></li>
<li><p><strong>background_future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – A future covariates series or list of series that the model needs once fitted.</p></li>
<li><p><strong>background_num_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, whether to sample a subset of the original background. Randomly picks
<cite>background_num_samples</cite> training samples of the constructed training dataset
(using <code class="docutils literal notranslate"><span class="pre">shap.utils.sample()</span></code>).
Generally used for faster computation, especially when <cite>shap_method</cite> is
<code class="docutils literal notranslate"><span class="pre">&quot;kernel&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;permutation&quot;</span></code>.</p></li>
<li><p><strong>shap_method</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the shap method to apply. By default, an attempt is made
to select the most appropriate method based on a pre-defined set of known models.
internal mapping. Supported values : <code class="docutils literal notranslate"><span class="pre">&quot;permutation&quot;,</span> <span class="pre">&quot;partition&quot;,</span> <span class="pre">&quot;tree&quot;,</span> <span class="pre">&quot;kernel&quot;,</span> <span class="pre">&quot;sampling&quot;,</span> <span class="pre">&quot;linear&quot;,</span>
<span class="pre">&quot;deep&quot;,</span> <span class="pre">&quot;gradient&quot;,</span> <span class="pre">&quot;additive&quot;</span></code>.</p></li>
<li><p><strong>**kwargs</strong> – Optionally, additional keyword arguments passed to <cite>shap_method</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AirPassengersDataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.explainability.shap_explainer</span><span class="w"> </span><span class="kn">import</span> <span class="n">ShapExplainer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">darts.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegressionModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">series</span> <span class="o">=</span> <span class="n">AirPassengersDataset</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegressionModel</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">series</span><span class="p">[:</span><span class="o">-</span><span class="mi">36</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap_explain</span> <span class="o">=</span> <span class="n">ShapExplainer</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">shap_explain</span><span class="o">.</span><span class="n">explain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap_explain</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap_explain</span><span class="o">.</span><span class="n">force_plot_from_ts</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.explain" title="darts.explainability.shap_explainer.ShapExplainer.explain"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explain</span></code></a>([foreground_series, ...])</p></td>
<td><p>Explains a foreground time series and returns a <a class="reference internal" href="darts.explainability.explainability_result.html#darts.explainability.explainability_result.ShapExplainabilityResult" title="darts.explainability.explainability_result.ShapExplainabilityResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapExplainabilityResult</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts" title="darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">force_plot_from_ts</span></code></a>([foreground_series, ...])</p></td>
<td><p>Display a shap force_plot for one target and one horizon, for a given foreground_series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#darts.explainability.shap_explainer.ShapExplainer.summary_plot" title="darts.explainability.shap_explainer.ShapExplainer.summary_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary_plot</span></code></a>([horizons, target_components, ...])</p></td>
<td><p>Display a shap plot summary for each horizon and each component dimension of the target.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="darts.explainability.shap_explainer.ShapExplainer.explain">
<span class="sig-name descname"><span class="pre">explain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foreground_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/explainability/shap_explainer.html#ShapExplainer.explain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.explainability.shap_explainer.ShapExplainer.explain" title="Permalink to this definition">¶</a></dt>
<dd><p>Explains a foreground time series and returns a <a class="reference internal" href="darts.explainability.explainability_result.html#darts.explainability.explainability_result.ShapExplainabilityResult" title="darts.explainability.explainability_result.ShapExplainabilityResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShapExplainabilityResult</span></code></a>.
The results can be retrieved with method <a class="reference internal" href="darts.explainability.explainability_result.html#darts.explainability.explainability_result.ShapExplainabilityResult.get_explanation" title="darts.explainability.explainability_result.ShapExplainabilityResult.get_explanation"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_explanation()</span></code></a>.
The result is a multivariate <cite>TimeSeries</cite> instance containing the ‘explanation’
for the (horizon, target_component) forecast at any timestamp forecastable corresponding to
the foreground <cite>TimeSeries</cite> input.</p>
<p>The component name convention of this multivariate <cite>TimeSeries</cite> is:
<code class="docutils literal notranslate"><span class="pre">&quot;{name}_{type_of_cov}_lag_{idx}&quot;</span></code>, where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{name}</span></code> is the component name from the original foreground series (target, past, or future).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{type_of_cov}</span></code> is the covariates type. It can take 3 different values:
<code class="docutils literal notranslate"><span class="pre">&quot;target&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;past_cov&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;future_cov&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{idx}</span></code> is the lag index.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>foreground_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, one or a sequence of target <cite>TimeSeries</cite> to be explained. Can be multivariate.
If not provided, the background <cite>TimeSeries</cite> will be explained instead.</p></li>
<li><p><strong>foreground_past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, one or a sequence of past covariates <cite>TimeSeries</cite> if required by the forecasting model.</p></li>
<li><p><strong>foreground_future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, one or a sequence of future covariates <cite>TimeSeries</cite> if required by the forecasting model.</p></li>
<li><p><strong>horizons</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, an integer or sequence of integers representing the future time steps to be explained.
<cite>1</cite> corresponds to the first timestamp being forecasted.
All values must be <cite>&lt;=output_chunk_length</cite> of the explained forecasting model.</p></li>
<li><p><strong>target_components</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a string or sequence of strings with the target components to explain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The forecast explanations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.explainability.explainability_result.html#darts.explainability.explainability_result.ShapExplainabilityResult" title="darts.explainability.explainability_result.ShapExplainabilityResult">ShapExplainabilityResult</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Say we have a model with 2 target components named <code class="docutils literal notranslate"><span class="pre">&quot;T_0&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;T_1&quot;</span></code>,
3 past covariates with default component names <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;1&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;2&quot;</span></code>,
and one future covariate with default component name <code class="docutils literal notranslate"><span class="pre">&quot;0&quot;</span></code>.
Also, <code class="docutils literal notranslate"><span class="pre">horizons</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2]</span></code>.
The model is a <cite>SKLearnModel</cite>, with <code class="docutils literal notranslate"><span class="pre">lags</span> <span class="pre">=</span> <span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">lags_past_covariates=[-1,</span> <span class="pre">-3]</span></code>,
<code class="docutils literal notranslate"><span class="pre">lags_future_covariates</span> <span class="pre">=</span> <span class="pre">[0]</span></code>.</p>
<p>We provide <cite>foreground_series</cite>, <cite>foreground_past_covariates</cite>, <cite>foreground_future_covariates</cite> each of length 5.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">explain_results</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">foreground_series</span><span class="o">=</span><span class="n">foreground_series</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">foreground_past_covariates</span><span class="o">=</span><span class="n">foreground_past_covariates</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">foreground_future_covariates</span><span class="o">=</span><span class="n">foreground_future_covariates</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">horizons</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;T_0&quot;</span><span class="p">,</span> <span class="s2">&quot;T_1&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">explain_results</span><span class="o">.</span><span class="n">get_explanation</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="s2">&quot;T_1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feature_values</span> <span class="o">=</span> <span class="n">explain_results</span><span class="o">.</span><span class="n">get_feature_values</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="s2">&quot;T_1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap_objects</span> <span class="o">=</span> <span class="n">explain_results</span><span class="o">.</span><span class="n">get_shap_explanation_objects</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">component</span><span class="o">=</span><span class="s2">&quot;T_1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then the method returns a multivariate TimeSeries containing the <em>explanations</em> of
the <cite>ShapExplainer</cite>, with the following component names:</p>
<blockquote>
<div><ul class="simple">
<li><p>T_0_target_lag-1</p></li>
<li><p>T_0_target_lag-2</p></li>
<li><p>T_0_target_lag-3</p></li>
<li><p>T_1_target_lag-1</p></li>
<li><p>T_1_target_lag-2</p></li>
<li><p>T_1_target_lag-3</p></li>
<li><p>0_past_cov_lag-1</p></li>
<li><p>0_past_cov_lag-3</p></li>
<li><p>1_past_cov_lag-1</p></li>
<li><p>1_past_cov_lag-3</p></li>
<li><p>2_past_cov_lag-1</p></li>
<li><p>2_past_cov_lag-3</p></li>
<li><p>0_fut_cov_lag_0</p></li>
</ul>
</div></blockquote>
<p>This series has length 3, as the model can explain 5-3+1 forecasts
(timestamp indexes 4, 5, and 6)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts">
<span class="sig-name descname"><span class="pre">force_plot_from_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">foreground_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_past_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">foreground_future_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/explainability/shap_explainer.html#ShapExplainer.force_plot_from_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.explainability.shap_explainer.ShapExplainer.force_plot_from_ts" title="Permalink to this definition">¶</a></dt>
<dd><p>Display a shap force_plot for one target and one horizon, for a given foreground_series.
It displays shap values of each lag/covariate with an additive force layout.</p>
<p>Once the plot is displayed, select “original sample ordering”
to observe the time series chronologically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>foreground_series</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the target series to explain. Can be multivariate. If <cite>None</cite>, will use the <cite>background_series</cite>.</p></li>
<li><p><strong>foreground_past_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a past covariate series if required by the forecasting model. If <cite>None</cite>, will use the
<cite>background_past_covariates</cite>.</p></li>
<li><p><strong>foreground_future_covariates</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a future covariate series if required by the forecasting model. If <cite>None</cite>, will use the
<cite>background_future_covariates</cite>.</p></li>
<li><p><strong>horizon</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, an integer for the point/step in the future to explain, starting from the first prediction
step at 1. <cite>horizons</cite> must not be larger than <cite>output_chunk_length</cite>.</p></li>
<li><p><strong>target_component</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, the target component to plot. If the target series is multivariate, the target component
must be specified.</p></li>
<li><p><strong>**kwargs</strong> – Optionally, additional keyword arguments passed to <cite>shap.force_plot()</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="darts.explainability.shap_explainer.ShapExplainer.model">
<span class="sig-name descname"><span class="pre">model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="darts.models.forecasting.sklearn_model.html#darts.models.forecasting.sklearn_model.SKLearnModel" title="darts.models.forecasting.sklearn_model.SKLearnModel"><span class="pre">SKLearnModel</span></a></em><a class="headerlink" href="#darts.explainability.shap_explainer.ShapExplainer.model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="darts.explainability.shap_explainer.ShapExplainer.summary_plot">
<span class="sig-name descname"><span class="pre">summary_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dot'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/explainability/shap_explainer.html#ShapExplainer.summary_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#darts.explainability.shap_explainer.ShapExplainer.summary_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Display a shap plot summary for each horizon and each component dimension of the target.
This method reuses the initial background data as foreground (potentially sampled) to give a general importance
plot for each feature.
If no target names and/or no horizons are provided, all summary plots are produced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>horizons</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, an integer or sequence of integers representing which points/steps in the future to explain,
starting from the first prediction step at 1. <cite>horizons</cite> must <cite>&lt;=output_chunk_length</cite> of the forecasting
model.</p></li>
<li><p><strong>target_components</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, a string or sequence of strings with the target components to explain.</p></li>
<li><p><strong>num_samples</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, an integer for sampling the foreground series (based on the background),
for the sake of performance.</p></li>
<li><p><strong>plot_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]) – Optionally, specify which of the shap library plot type to use. Can be one of <code class="docutils literal notranslate"><span class="pre">'dot',</span> <span class="pre">'bar',</span> <span class="pre">'violin'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A nested dictionary {horizon : {component : shap.Explanation}} containing the raw Explanations for all
the horizons and components.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a href="#id1"><span class="problematic" id="id2">shaps_</span></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="darts.explainability.explainability_result.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Explainability Result</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="darts.explainability.tft_explainer.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">TFT Explainer for Temporal Fusion Transformer (TFTModel)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020 - 2025, Unit8 SA (Apache 2.0 License).<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>