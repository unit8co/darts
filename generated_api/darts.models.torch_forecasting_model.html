
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Torch Forecasting Model &#8212; darts  documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transformer" href="darts.models.transformer_model.html" />
    <link rel="prev" title="Theta Method" href="darts.models.theta.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/darts-logo-trim.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../README.html">Home</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="darts.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../examples.html">Examples</a>
        </li>
        
        
      </ul>


      <form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/unit8co/darts" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/unit8co" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
          
            
                <li class="">
                    <a href="darts.dataprocessing.html">Data Processing</a>
                </li>
            
          
            
                <li class="">
                    <a href="darts.metrics.html">Metrics</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="darts.models.html">Models</a>
                    <ul>
                    
                        <li class="">
                            <a href="darts.models.arima.html">ARIMA</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.auto_arima.html">Auto-ARIMA</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.baselines.html">Baseline Models</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.ensemble_model.html">Ensemble model</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.exponential_smoothing.html">Exponential Smoothing</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.fft.html">Fast Fourier Transform</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.forecasting_model.html">Forecasting Model Base Class</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.nbeats.html">N-BEATS</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.prophet.html">Facebook Prophet</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.regression_ensemble_model.html">Regression ensemble model</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.regression_model.html">Regression Model Base Class</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.rnn_model.html">Recurrent Neural Networks</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.standard_regression_model.html">Standard Regression model</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.tcn_model.html">Temporal Convolutional Network</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.theta.html">Theta Method</a>
                        </li>
                    
                        <li class="active">
                            <a href="">Torch Forecasting Model</a>
                        </li>
                    
                        <li class="">
                            <a href="darts.models.transformer_model.html">Transformer</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="darts.utils.html">Utils</a>
                </li>
            
          
            
                <li class="">
                    <a href="darts.timeseries.html">Timeseries</a>
                </li>
            
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <span class="target" id="module-darts.models.torch_forecasting_model"></span><div class="section" id="torch-forecasting-model">
<h1>Torch Forecasting Model<a class="headerlink" href="#torch-forecasting-model" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel">
<em class="property">class </em><code class="sig-prename descclassname">darts.models.torch_forecasting_model.</code><code class="sig-name descname">TorchForecastingModel</code><span class="sig-paren">(</span><em class="sig-param">batch_size: int = 32</em>, <em class="sig-param">output_length: int = 1</em>, <em class="sig-param">input_length: int = 10</em>, <em class="sig-param">input_size: int = 1</em>, <em class="sig-param">output_size: int = 1</em>, <em class="sig-param">n_epochs: int = 800</em>, <em class="sig-param">optimizer_cls: torch.optim.optimizer.Optimizer = &lt;class 'torch.optim.adam.Adam'&gt;</em>, <em class="sig-param">optimizer_kwargs: Dict = None</em>, <em class="sig-param">lr_scheduler_cls: torch.optim.lr_scheduler._LRScheduler = None</em>, <em class="sig-param">lr_scheduler_kwargs: Optional[Dict] = None</em>, <em class="sig-param">loss_fn: torch.nn.modules.loss._Loss = MSELoss()</em>, <em class="sig-param">model_name: str = 'torch_model_run'</em>, <em class="sig-param">work_dir: str = '/home/runner/work/darts/darts/docs'</em>, <em class="sig-param">log_tensorboard: bool = False</em>, <em class="sig-param">nr_epochs_val_period: int = 10</em>, <em class="sig-param">torch_device_str: Optional[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/torch_forecasting_model.html#TorchForecastingModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="darts.models.forecasting_model.html#darts.models.forecasting_model.MultivariateForecastingModel" title="darts.models.forecasting_model.MultivariateForecastingModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">darts.models.forecasting_model.MultivariateForecastingModel</span></code></a></p>
<p>Pytorch-based Forecasting Model.</p>
<p>This class is meant to be inherited to create a new pytorch-based forecasting module.
When subclassing this class, please make sure to set the self.model attribute
in the __init__ function and then call super().__init__ while passing the kwargs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_length</strong> – Number of time steps to be output by the forecasting module.</p></li>
<li><p><strong>input_length</strong> – Number of past time steps that are fed to the forecasting module.</p></li>
<li><p><strong>input_size</strong> – The dimensionality of the TimeSeries instances that will be fed to the fit function.</p></li>
<li><p><strong>output_size</strong> – The dimensionality of the output time series.</p></li>
<li><p><strong>batch_size</strong> – Number of time series (input and output sequences) used in each training pass.</p></li>
<li><p><strong>n_epochs</strong> – Number of epochs over which to train the model.</p></li>
<li><p><strong>optimizer_cls</strong> – The PyTorch optimizer class to be used (default: <cite>torch.optim.Adam</cite>).</p></li>
<li><p><strong>optimizer_kwargs</strong> – Optionally, some keyword arguments for the PyTorch optimizer (e.g., <cite>{‘lr’: 1e-3}</cite>)
for specifying a learning rate. Otherwise the default values of the selected <cite>optimizer_cls</cite>
will be used.</p></li>
<li><p><strong>lr_scheduler_cls</strong> – Optionally, the PyTorch learning rate scheduler class to be used. Specifying <cite>None</cite> corresponds
to using a constant learning rate.</p></li>
<li><p><strong>lr_scheduler_kwargs</strong> – Optionally, some keyword arguments for the PyTorch optimizer.</p></li>
<li><p><strong>loss_fn</strong> – PyTorch loss function used for training (default: <cite>torch.nn.MSELoss()</cite>).</p></li>
<li><p><strong>model_name</strong> – Name of the model. Used for creating the checkpoints and saving tensorboard data.</p></li>
<li><p><strong>work_dir</strong> – Path of the working directory, where to save checkpoints and Tensorboard summaries.
(default: current working directory).</p></li>
<li><p><strong>log_tensorboard</strong> – If set, use Tensorboard to log the different parameters. The logs will be located in:
<cite>[work_dir]/.darts/runs/</cite>.</p></li>
<li><p><strong>nr_epochs_val_period</strong> – Number of epochs to wait before evaluating the validation loss (if a validation
<cite>TimeSeries</cite> is passed to the <cite>fit()</cite> method).</p></li>
<li><p><strong>torch_device_str</strong> – Optionally, a string indicating the torch device to use. (default: “cuda:0” if a GPU
is available, otherwise “cpu”)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel.first_prediction_index">
<em class="property">property </em><code class="sig-name descname">first_prediction_index</code><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel.first_prediction_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of the first predicted within the output of self.model.</p>
</dd></dl>

<dl class="py method">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">training_series</span><span class="p">:</span> <span class="n"><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a></span></em>, <em class="sig-param"><span class="n">target_series</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">val_training_series</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">val_target_series</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/darts/models/torch_forecasting_model.html#TorchForecastingModel.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit method for torch modules</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>training_series</strong> – A series of training values used to predict the target series (can also include the target).</p></li>
<li><p><strong>target_series</strong> – A series of target (dependent) value(s) predicted using the training_series if None specified, use the
training series as target.</p></li>
<li><p><strong>val_training_series</strong> – Optionally, a validation training time series, which will be used to compute the validation
loss throughout training and keep track of the best performing models.</p></li>
<li><p><strong>val_target_series</strong> – Optionally, a validation target time series, which will be used to compute the validation
loss throughout training and keep track of the best performing models.</p></li>
<li><p><strong>verbose</strong> – Optionally, whether to print progress.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel.load_from_checkpoint">
<em class="property">static </em><code class="sig-name descname">load_from_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">work_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'/home/runner/work/darts/darts/docs'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">best</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#darts.models.torch_forecasting_model.TorchForecastingModel" title="darts.models.torch_forecasting_model.TorchForecastingModel">darts.models.torch_forecasting_model.TorchForecastingModel</a><a class="reference internal" href="../_modules/darts/models/torch_forecasting_model.html#TorchForecastingModel.load_from_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel.load_from_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the model from the given checkpoint.
if file is not given, will try to restore the most recent checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> – The name of the model (used to retrieve the checkpoints folder’s name).</p></li>
<li><p><strong>work_dir</strong> – Working directory (containing the checkpoints folder). Defaults to current working directory.</p></li>
<li><p><strong>filename</strong> – The name of the checkpoint file. If not specified, use the most recent one.</p></li>
<li><p><strong>best</strong> – If set, will retrieve the best model (according to validation loss) instead of the most recent one.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding trained <cite>TorchForecastingModel</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#darts.models.torch_forecasting_model.TorchForecastingModel" title="darts.models.torch_forecasting_model.TorchForecastingModel">TorchForecastingModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">use_full_output_length</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">input_series</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">darts.timeseries.TimeSeries</a><a class="reference internal" href="../_modules/darts/models/torch_forecasting_model.html#TorchForecastingModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts values for a certain number of time steps after the end of the training series</p>
<p>In the case of univariate training series, <cite>n</cite> can assume any integer value greater than 0.
If <cite>use_full_output_length</cite> is set to <cite>False</cite>, the model will perform <cite>n</cite> predictions, where in each iteration
the first predicted value is kept as output while at the same time being fed into the input for
the next prediction (the first value of the previous input is discarded). This way, the input sequence
‘rolls over’ by 1 step for every prediction in ‘n’.
If <cite>use_full_output_length</cite> is set to <cite>True</cite>, the model will predict not one, but <cite>self.output_length</cite> values
in every iteration. This means that <cite>ceil(n / self.output_length)</cite> iterations will be required. After
every iteration the input sequence ‘rolls over’ by <cite>self.output_length</cite> steps, meaning that the last
<cite>self.output_length</cite> entries in the input sequence will correspond to the prediction of the previous
iteration.</p>
<p>In the case of multivariate training series, <cite>n</cite> cannot exceed <cite>self.output_length</cite> and <cite>use_full_output_length</cite>
has to be set to <cite>True</cite>. In this case, only one iteration of predictions will be performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – The number of time steps after the end of the training time series for which to produce predictions</p></li>
<li><p><strong>use_full_output_length</strong> – Boolean value indicating whether or not the full output sequence of the model prediction should be
used to produce the output of this function.</p></li>
<li><p><strong>input_series</strong> – Optionally, the input TimeSeries instance fed to the trained TorchForecastingModel to produce the
prediction. If it is not passed, the training TimeSeries instance will be used as input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A time series containing the <cite>n</cite> next points, starting after the end of the training time series</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="darts.timeseries.html#darts.timeseries.TimeSeries" title="darts.timeseries.TimeSeries">TimeSeries</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="darts.models.torch_forecasting_model.TorchForecastingModel.untrained_model">
<code class="sig-name descname">untrained_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/darts/models/torch_forecasting_model.html#TorchForecastingModel.untrained_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#darts.models.torch_forecasting_model.TorchForecastingModel.untrained_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="darts.models.theta.html" title="previous page">Theta Method</a>
    <a class='right-next' id="next-link" href="darts.models.transformer_model.html" title="next page">Transformer</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, Unit8 SA.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>